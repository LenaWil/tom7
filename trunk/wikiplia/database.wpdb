WPDB
121
b%3Acompile 2 51/(##CLOSURE## () "s" (parse (xcase s 'no '(h _ h))))

b%3Acompile.b 1 115/";; b \"compiler\" is trivial -- it's just the built-in XESP parser\n(lambda 's '(parse (xcase s 'no '(h _ h))))\n"

main 11 358/(let 'nil '() '(let 'car (lambda 'args '(xcase args 'noa '(arg u (xcase arg 'error_car_nil '(h u h))))) '(let 'cdr (lambda 'args '(xcase args 'nob '(arg u (xcase arg 'error_cdr_nil '(u t t))))) '(if (eq request.url "/emergency-revert") '(let '_ (insert "main-go" (read "main-go" (car (cdr (history "main-go"))))) '"OK, reverted") '(eval (head "main-go"))))))
!7=M102:30/action!"))))))))))))))))))))))M100:8/"unknowni99,58:9/stdheader1/ 8/'(string1/ 12/it</a>?"))))1/ 10/"\">create1/ 10/fulltarget1/ 14/href=\"/edit/"1/ 2/<a1/ 2/to1/ 4/like1/ 5/you'd1/ 8/"Perhaps1/ 1/"1/ 6/"</b>.1/ 10/fulltarget1/ 4/<b>"1/ 6/called1/ 6/symbol1/ 2/no1/ 2/is1/ 6/"There1/ 7/(string1/ 3/'(_1/ 7/msg))))1/ 1/"1/ 10/error</b>:1/ 11/"<b>Runtime1/ 7/(string1/ 5/'(msg1/ 5/prog)1/ M96:8/'(handleM94:11/fulltarget)M92:5/(headi91,254:5/'prog1/ 5/'(let1/ 7/(handle1/ 9/<hr/><p>"1/ 3/...1/ 1/"1/ 10/fulltarget1/ 1/"1/ 11/"<p>running1/ 11/fulltarget)1/ 5/(tabs1/ 7/stdpage1/ 9/stdheader1/ 8/'(string1/ 6/"run")1/ 6/action1/ 3/(eq1/ 4/'(if1/ 10/rev)))))))1/ 4/(int1/ 6/target1/ 6/'(read1/ 7/target)1/ 6/'(head1/ 4/"_")1/ 3/rev1/ 3/(eq1/ 3/(if1/ 9/stdheader1/ 8/'(string1/ 12/rev_target))1/ 4/(cdr1/ 4/(car1/ 7/'target1/ 5/'(let1/ 11/rev_target)1/ 4/(car1/ 4/'rev1/ 5/'(let1/ 2/0)1/ 10/fulltarget1/ 3/"/"1/ 5/token1/ 6/(token1/ 11/'rev_target1/ 5/'(let1/ 6/"raw")1/ 6/action1/ 3/(eq1/ 4/'(if1/ 15/it</a>?")))))))1/ 10/"\">create1/ 6/target1/ 14/href=\"/edit/"1/ 2/<a1/ 2/to1/ 4/like1/ 5/you'd1/ 8/"Perhaps1/ 1/"1/ 6/"</b>.1/ 6/target1/ 4/<b>"1/ 6/called1/ 6/symbol1/ 2/no1/ 2/is1/ 6/"There1/ 7/(string1/ 3/'(_1/ 11/"</pre>\n")1/ 7/rev))))1/ 4/(int1/ 6/target1/ 6/'(read1/ 7/target)1/ 6/'(head1/ 4/"_")1/ 3/rev1/ 3/(eq1/ 3/(if1/ 11/(htmlescape1/ 9/"<pre>\n"1/ 8/'(string1/ 7/(handle1/ 9/<hr/><p>"1/ 3/...1/ 1/"1/ 5/rev))1/ 1/"1/ 1/@1/ 1/"1/ 8/'(string1/ 3/'""1/ 4/"_")1/ 3/rev1/ 3/(eq1/ 3/(if1/ 6/target1/ 1/"1/ 11/"<p>viewing1/ 7/target)1/ 5/(tabs1/ 7/stdpage1/ 9/stdheader1/ 8/'(string1/ 12/rev_target))1/ 4/(cdr1/ 4/(car1/ 7/'target1/ 5/'(let1/ 11/rev_target)1/ 4/(car1/ 4/'rev1/ 5/'(let1/ 2/0)1/ 10/fulltarget1/ 3/"/"1/ 5/token1/ 6/(token1/ 11/'rev_target1/ 5/'(let1/ 7/"view")1/ 6/action1/ 3/(eq1/ 4/'(if1/ 14/fulltarget))))1/ M88:3/"))i87,4:5/"</a>1/ 5/args)1/ M84:5/"\">"M82:10/fulltargetM80:3/"/"i79,70:5/args)1/ 4/(car1/ 14/href=\"/view/"1/ 3/"<a1/ 8/'(string1/ 5/'args1/ 7/(lambda1/ 3/map1/ 4/(map1/ 7/(string1/ 12/...<hr/><p>"1/ 1/"1/ 10/fulltarget1/ 1/"1/ 3/for1/ 11/"<p>history1/ 11/fulltarget)1/ 5/(tabs1/ 7/stdpage1/ 9/stdheader1/ 8/'(string1/ 10/"history")1/ 6/action1/ 3/(eq1/ 4/'(if1/ 20/fulltarget))))))))))1/ 10/"/view/_/"1/ 7/(string1/ 10/'(redirect1/ 14/fulltarget))))1/ 10/"/view/_/"1/ 7/(string1/ 10/'(redirect1/ 4/exe)1/ 4/base1/ M72:7/msg))))i71,422:1/"1/ 7/because1/ 6/failed1/ 1/"1/ 10/fulltarget1/ 1/"1/ 2/of1/ 12/"compilation1/ 7/(string1/ 6/'abort1/ 5/(list1/ 5/'(msg1/ 4/dat)1/ 9/'(compile1/ 7/(handle1/ 4/'exe1/ 5/'(let1/ 7/compile1/ 4/'(if1/ 4/dat)1/ 10/fulltarget1/ 7/(insert1/ 2/'_1/ 5/'(let1/ 5/nil))1/ 3/'(_1/ 13/":compile")))1/ 3/ext1/ 7/(string1/ 5/(head1/ 6/'(eval1/ 7/(handle1/ 8/'compile1/ 5/'(let1/ 13/fulltarget)))1/ 10/"/view/_/"1/ 7/(string1/ 10/'(redirect1/ 4/dat)1/ 10/fulltarget1/ 7/(insert1/ 2/'_1/ 5/'(let1/ 3/"")1/ 4/base1/ 3/(eq1/ 4/'(if1/ 13/form.contents1/ 4/'dat1/ 5/'(let1/ 10/base_ext))1/ 4/(cdr1/ 4/(car1/ 4/'ext1/ 5/'(let1/ 9/base_ext)1/ 4/(car1/ 5/'base1/ 5/'(let1/ 3/1))1/ 11/fulltarget)1/ 5/(size1/ 2/(-1/ 10/fulltarget1/ 3/"."1/ 6/rtoken1/ 7/(rtoken1/ 9/'base_ext1/ 5/'(let1/ 7/"save")1/ 6/action1/ 3/(eq1/ 4/'(if1/ 25/value=\"save\"></form>"))1/ 11/type=submit1/ 7/"<input1/ 15/"</textarea>\n"1/ 7/data)")1/ 11/'"(internal1/ 9/symbol)")1/ 5/"(was1/ 3/'(_1/ 4/")")1/ 11/oldcontents1/ 1/"1/ 3/int1/ 5/"(was1/ 8/'(string1/ 12/oldcontents)1/ 12/'(htmlescape1/ 7/data)")1/ 6/quoted1/ 5/"(was1/ 3/'(_1/ 7/data)")1/ 4/list1/ 5/"(was1/ 1/_1/ 3/'(_1/ 3/'""1/ 11/oldcontents1/ 6/(xcase1/ 19/name=\"contents\">"1/ 8/cols=1201/ 7/rows=351/ 13/"\"><textarea1/ 10/fulltarget1/ 16/action=\"/save/"1/ 15/method=\"post\"1/ 6/"<form1/ 13/deleted.</b>"1/ 2/be1/ 4/will1/ 2/It1/ 11/permission.1/ 7/without1/ 8/websites1/ 5/other1/ 4/from1/ 4/text1/ 4/copy1/ 3/not1/ 11/"<br/><b>Do1/ 3/"))1/ 3/...1/ 1/"1/ 10/fulltarget1/ 1/"1/ 4/page1/ 3/new1/ 9/"creating1/ 8/'(string1/ 2/")1/ 3/...1/ 1/"1/ 10/fulltarget1/ 1/"1/ 8/"editing1/ 8/'(string1/ 11/oldcontents1/ 3/(if1/ 5/"<p>"1/ 11/fulltarget)1/ 5/(tabs1/ 7/stdpage1/ 9/stdheader1/ 8/'(string1/ 5/nil))1/ 3/'(_1/ 11/fulltarget)1/ 6/'(head1/ 7/(handle1/ 12/'oldcontents1/ 5/'(let1/ 7/"edit")1/ 6/action1/ 3/(eq1/ 4/'(if1/ 11/"</div>")))1/ 1/"1/ 18/"\">run</a></span>1/ 4/page1/ 13/href=\"/run/"1/ 16/class=\"tab\"><a1/ 6/"<span1/ 1/"1/ 22/"\">history</a></span>1/ 4/page1/ 17/href=\"/history/"1/ 16/class=\"tab\"><a1/ 6/"<span1/ 1/"1/ 19/"\">edit</a></span>1/ 4/page1/ 14/href=\"/edit/"1/ 16/class=\"tab\"><a1/ 6/"<span1/ 1/"1/ 19/"\">view</a></span>1/ 4/page1/ 16/href=\"/view/_/"1/ 16/class=\"tab\"><a1/ 6/"<span1/ 16/class=\"tabs\">"1/ 5/"<div1/ 8/'(string1/ 5/args)1/ 4/(car1/ 5/'page1/ 5/'(let1/ 5/'args1/ 7/(lambda1/ 5/'tabs1/ 5/'(let1/ 15/action_target))1/ 4/(cdr1/ 4/(car1/ 11/'fulltarget1/ 5/'(let1/ 14/action_target)1/ 4/(car1/ 7/'action1/ 5/'(let1/ 2/0)1/ 3/url1/ 3/"/"1/ 5/token1/ 6/(token1/ 14/'action_target1/ 5/'(let1/ 4/0)))1/ i69,44:3/"/"1/ 5/token1/ 6/(token1/ 4/(cdr1/ 4/(car1/ 4/'url1/ 5/'(let1/ 7/0))))))1/ 4/hrec1/ 5/(hrec1/ 6/string1/ 5/(cons1/ 6/'(eval1/ 9/1))))))))1/ 1/n1/ 2/(+1/ 4/self1/ 5/(self1/ 6/'ch)))1/ 8/'"&amp;"1/ 4/"&")1/ 2/ch1/ i65,458:7/'"&gt;"1/ 4/">")1/ 2/ch1/ 3/(eq1/ 4/'(if1/ 7/'"&lt;"1/ 4/"<")1/ 2/ch1/ 3/(eq1/ 3/(if1/ 6/'(cons1/ 2/n)1/ 1/s1/ 4/(sub1/ 3/'ch1/ 5/'(let1/ 4/'nil1/ 3/s))1/ 5/(size1/ 1/n1/ 3/(eq1/ 4/'(if1/ 6/args))1/ 4/(cdr1/ 4/(car1/ 2/'n1/ 5/'(let1/ 5/args)1/ 4/(car1/ 5/'self1/ 5/'(let1/ 5/'args1/ 7/(lambda1/ 5/'hrec1/ 5/'(let1/ 6/hargs)1/ 4/(car1/ 2/'s1/ 5/'(let1/ 6/'hargs1/ 7/(lambda1/ 11/'htmlescape1/ 5/'(let1/ 11/1))))))))))1/ 1/n1/ 2/(-1/ 1/s1/ 3/sep1/ 4/self1/ 6/'(self1/ 5/1))))1/ 1/n1/ 2/(+1/ 2/s)1/ 5/(size1/ 2/(-1/ 2/1)1/ 1/n1/ 2/(+1/ 1/s1/ 7/(substr1/ 2/n)1/ 1/01/ 1/s1/ 7/(substr1/ 6/'(list1/ 4/sep)1/ 2/ch1/ 3/(eq1/ 4/'(if1/ 2/n)1/ 1/s1/ 4/(sub1/ 3/'ch1/ 5/'(let1/ 2/s)1/ 2/""1/ 6/'(list1/ 3/1))1/ 1/01/ 2/(-1/ 1/n1/ 3/(eq1/ 4/'(if1/ 8/args))))1/ 4/(cdr1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'n1/ 5/'(let1/ 7/args)))1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'s1/ 5/'(let1/ 6/args))1/ 4/(cdr1/ 4/(car1/ 4/'sep1/ 5/'(let1/ 5/args)1/ 4/(car1/ 5/'self1/ 5/'(let1/ 5/'args1/ 7/(lambda1/ 7/'rtoken1/ 5/'(let1/ 11/1))))))))))1/ 1/n1/ 2/(+1/ 1/s1/ 3/sep1/ 4/self1/ 6/'(self1/ 5/1))))1/ 1/n1/ 2/(+1/ 2/s)1/ 5/(size1/ 2/(-1/ 2/1)1/ 1/n1/ 2/(+1/ 1/s1/ 7/(substr1/ 2/n)1/ 1/01/ 1/s1/ 7/(substr1/ 6/'(list1/ 4/sep)1/ 2/ch1/ 3/(eq1/ 4/'(if1/ 2/n)1/ 1/s1/ 4/(sub1/ 3/'ch1/ 5/'(let1/ 3/"")1/ 1/s1/ 6/'(list1/ 3/s))1/ 5/(size1/ 1/n1/ 3/(eq1/ 4/'(if1/ 8/args))))1/ 4/(cdr1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'n1/ 5/'(let1/ 7/args)))1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'s1/ 5/'(let1/ 6/args))1/ 4/(cdr1/ 4/(car1/ 4/'sep1/ 5/'(let1/ 5/args)1/ 4/(car1/ 5/'self1/ 5/'(let1/ 5/'args1/ 7/(lambda1/ 6/'token1/ 5/'(let1/ 9/'nil)))))1/ 4/l)))1/ 4/(cdr1/ 1/f1/ 4/self1/ 5/(self1/ 3/l))1/ 4/(car1/ 2/(f1/ 6/'(cons1/ 1/l1/ 4/'(if1/ 7/args)))1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'l1/ 5/'(let1/ 6/args))1/ 4/(cdr1/ 4/(car1/ 2/'f1/ 5/'(let1/ 5/args)1/ 4/(car1/ 5/'self1/ 5/'(let1/ 5/'args1/ 7/(lambda1/ 4/'map1/ 5/'(let1/ 12/"\r\n\r\n"))1/ 7/target)1/ 4/(car1/ 1/"1/ 10/"Location:1/ 8/'(string1/ 7/'target1/ 7/(lambda1/ 9/'redirect1/ 5/'(let1/ 36/title=\"polybook\"/></head><body>\n"1/ 28/href=\"/raw/_/polybook.css\"1/ 17/type=\"text/css\"1/ 14/rel=stylesheet1/ 18/"<html><head><link1/ 8/'stdpage1/ 5/'(let1/ 22/charset=utf-8\r\n\r\n"1/ 10/text/html;1/ 14/"Content-Type:1/ 10/'stdheader1/ 5/'(let1/ X
!4=X

main-go 120 5284/(let 'car (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(l fnarg_ (xcase l '(abort "car nil") '(h _ h))))) '(let 'cdr (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(l fnarg_ (xcase l '(abort "cdr nil") '(_ t t))))) '(let 'map (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(self fnarg_ (xcase fnarg_ 'noarg '(f fnarg_ (xcase fnarg_ 'noarg '(l fnarg_ (xcase l ''() '(h t (cons (f h) (self self f t))))))))))) '(let 'map (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(f fnarg_ (xcase fnarg_ 'noarg '(l fnarg_ (map map f l)))))) '(let 'stdheader "Content-Type: text/html; charset=utf-8\r\n\r\n" '(let 'stdpage "<html><head><link rel=stylesheet type=\"text/css\" href=\"/raw/_/polybook.css\" title=\"polybook\"/></head><body>\n" '(let 'redirect (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(target fnarg_ (string "Location: " target "\r\n\r\n")))) '(let 'token (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(self fnarg_ (xcase fnarg_ 'noarg '(sep fnarg_ (xcase fnarg_ 'noarg '(s fnarg_ (xcase fnarg_ 'noarg '(n fnarg_ (if (eq n (size s)) '(list s "") '(let 'ch (sub s n) '(if (eq ch sep) '(list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1)))) '(self self sep s (+ n 1)))))))))))))) '(let 'rtoken (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(self fnarg_ (xcase fnarg_ 'noarg '(sep fnarg_ (xcase fnarg_ 'noarg '(s fnarg_ (xcase fnarg_ 'noarg '(n fnarg_ (if (eq n (- 0 1)) '(list "" s) '(let 'ch (sub s n) '(if (eq ch sep) '(list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1)))) '(self self sep s (- n 1)))))))))))))) '(let 'htmlescape (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(s fnarg_ (let 'hrec (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(self fnarg_ (xcase fnarg_ 'noarg '(st fnarg_ (xcase fnarg_ 'noarg '(en fnarg_ (if (eq en (size s)) '(list (substr s st (- en st))) '(let 'ch (sub s en) '(if (eq ch "<") '(cons (substr s st (- en st)) (cons "&lt;" (self self (+ en 1) (+ en 1)))) '(if (eq ch ">") '(cons (substr s st (- en st)) (cons "&gt;" (self self (+ en 1) (+ en 1)))) '(if (eq ch "&") '(cons (substr s st (- en st)) (cons "&amp;" (self self (+ en 1) (+ en 1)))) '(self self st (+ en 1)))))))))))))) '(eval (cons string (hrec hrec 0 0))))))) '(let 'url (car (cdr (token token "/" request.url 0))) '(let 'action_target (token token "/" url 0) '(let 'action (car action_target) '(let 'fulltarget (car (cdr action_target)) '(let 'tabs (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(page fnarg_ (string "<div class=\"tabs\">" "<span class=\"tab\"><a href=\"/view/_/" page "\">view</a></span> " "<span class=\"tab\"><a href=\"/edit/" page "\">edit</a></span> " "<span class=\"tab\"><a href=\"/history/" page "\">history</a></span> " "<span class=\"tab\"><a href=\"/run/" page "\">run</a></span> " "</div>")))) '(if (eq action "edit") '(let 'oldcontents (handle '(head fulltarget) '(_ '())) '(string stdheader stdpage (tabs fulltarget) "<p>" (if oldcontents '(string "editing " fulltarget " ... ") '(string "creating new page " fulltarget " ... ")) "<br/><b>Do not copy text from other websites without permission. It will be deleted.</b>" "<form method=\"post\" action=\"/save/" fulltarget "\"><textarea rows=35 cols=120 name=\"contents\">" (xcase oldcontents '"" '(_ _ "(was list data)") '(_ "(was quoted data)") '(htmlescape oldcontents) '(string "(was int " oldcontents ")") '(_ "(was symbol)") '"(internal data)") "</textarea>\n" "<input type=submit value=\"save\"></form>")) '(if (eq action "save") '(let 'base_ext (rtoken rtoken "." fulltarget (- (size fulltarget) 1)) '(let 'base (car base_ext) '(let 'ext (car (cdr base_ext)) '(let 'dat form.contents '(if (eq base "") '(let '_ (insert fulltarget dat) '(redirect (string "/view/_/" fulltarget))) '(let 'compile (handle '(eval (head (string ext ":compile"))) '(_ '())) '(let '_ (insert fulltarget dat) '(if compile '(let 'exe (compile dat) '(let '_ (insert base exe) '(redirect (string "/view/_/" fulltarget)))) '(redirect (string "/view/_/" fulltarget)))))))))) '(if (eq action "history") '(string stdheader stdpage (tabs fulltarget) "<p>history for " fulltarget " ...<hr/><p>" (string (map (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(r fnarg_ (string "<a href=\"/view/" r "/" fulltarget "\">" r "</a> ")))) (history fulltarget)))) '(if (eq action "view") '(let 'rev_target (token token "/" fulltarget 0) '(let 'rev (car rev_target) '(let 'target (car (cdr rev_target)) '(string stdheader stdpage (tabs target) "<p>viewing " target (if (eq rev "_") '"" '(string " @ " rev)) " ... <hr/><p>" (handle '(string "<pre>\n" (htmlescape (string (if (eq rev "_") '(head target) '(read target (int rev))))) "</pre>\n") '(_ (string "There is no symbol called <b>" target "</b>. " "Perhaps you'd like to <a href=\"/edit/" target "\">create it</a>?"))))))) '(if (eq action "raw") '(let 'rev_target (token token "/" fulltarget 0) '(let 'rev (car rev_target) '(let 'target (car (cdr rev_target)) '(string stdheader (if (eq rev "_") '(head target) '(read target (int rev))))))) '(if (eq action "run") '(string stdheader stdpage (tabs fulltarget) "<p>running " fulltarget " ... <hr/><p>" (handle '(let 'prog (head fulltarget) '(handle '(eval prog) '(msg (string "<b>Runtime error</b>: " msg)))) '(_ (string "There is no symbol called <b>" fulltarget "</b>. " "Perhaps you'd like to <a href=\"/edit/" fulltarget "\">create it</a>?")))) '(string stdheader "unknown action!"))))))))))))))))))))))
!118=M716:6/0)))))M710:6/'(hrecd708,703:X
!111=M710:7/0))))))d708,707:M704:5/(hrecM702:6/stringM700:5/(consM698:6/'(evalM696:9/1))))))))M694:1/nd692,687:d684,679:M674:6/'ch)))M672:8/'"&amp;"d670,657:M648:7/'"&gt;"d646,615:M606:7/'"&lt;"d604,573:M566:3/(ifM564:6/'(consi563,2:2/n)1/ M554:4/''()d552,541:M536:1/nM532:4/'(ifM530:6/args))M528:4/(cdrM526:4/(carM524:2/'nM522:5/'(letM520:5/args)M518:4/(carM516:5/'selfM514:5/'(letM512:5/'argsd510,499:M494:5/'(letM492:6/hargs)M490:4/(carM488:2/'sM486:5/'(letM484:6/'hargsd482,481:X
!109=M1218:7/rev))))d1198,1197:X
!107=M1428:26/action!"))))))))))))))))))d166,1:X
!21=M1262:27/action!")))))))))))))))))))M936:3/"))M932:5/args)i931,2:4/(car1/ M924:5/args)i923,2:4/(car1/ M918:8/'(stringM916:5/'argsd914,905:i903,2:3/map1/ M820:5/nil))M574:5/nil))M552:11/"</div>")))M498:8/'(stringM496:5/args)M494:4/(carM492:5/'pageM490:5/'(letM488:5/'argsd486,485:M362:4/'nilM308:11/1))))))))))M228:4/'(ifM226:8/args))))M224:4/(cdrM222:4/(cdrM220:4/(cdrM218:4/(carM216:2/'nM214:5/'(letM212:7/args)))M210:4/(cdrM208:4/(cdrM206:4/(carM204:2/'sM202:5/'(letM200:6/args))M198:4/(cdrM196:4/(carM194:4/'sepM192:5/'(letM190:5/args)M188:4/(carM186:5/'selfi185,4:5/'(let1/ 5/'args1/ M178:11/1))))))))))M100:4/'(ifM98:8/args))))M96:4/(cdrM94:4/(cdrM92:4/(cdrM90:4/(carM88:2/'nM86:5/'(letM84:7/args)))M82:4/(cdrM80:4/(cdrM78:4/(carM76:2/'sM74:5/'(letM72:6/args))M70:4/(cdrM68:4/(carM66:4/'sepM64:5/'(letM62:5/args)M60:4/(carM58:5/'selfi57,4:5/'(let1/ 5/'args1/ M50:9/'nil)))))M48:4/l)))M46:4/(cdrM44:1/fM42:4/selfM40:5/(selfM38:3/l))M36:4/(carM34:2/(fM32:6/'(consM30:1/li29,34:4/'(if1/ 7/args)))1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'l1/ 5/'(let1/ 6/args))1/ 4/(cdr1/ 4/(car1/ 2/'f1/ 5/'(let1/ 5/args)1/ 4/(car1/ 5/'self1/ 5/'(let1/ 5/'args1/ i27,20:4/'map1/ 5/'(let1/ 12/"\r\n\r\n"))1/ 7/target)1/ 4/(car1/ 1/"1/ 10/"Location:1/ 8/'(string1/ 7/'target1/ 7/(lambda1/ X
!18=X
!16=X
!14=i903,26:7/msg))))1/ 1/"1/ 7/because1/ 6/failed1/ 1/"1/ 10/fulltarget1/ 1/"1/ 2/of1/ 12/"compilation1/ 7/(string1/ 6/'abort1/ 5/(list1/ 5/'(msg1/ M900:9/'(compilei899,2:7/(handle1/ X
!13=M1346:26/analysis\n\n))))))))))))")M1344:4/casei1343,10:6/action1/ 1/;1/ 4/))))7/       16/action!\")))\n\n1/ 9/\"unknown1/ M1339:10/          M1338:4/\n\ni1338,2:12/            15/it</a>?\"))))\nM1336:13/\"\\\">createM1332:17/href=\\\"/edit/\"M1322:9/\"PerhapsM1321:32/                                M1320:4/\"\nM1318:7/\"</b>.M1314:5/<b>\"M1304:7/\"ThereM1301:24/                        M1300:5/'(_\nM1299:22/                      M1298:9/msg))))\nM1296:2/\"M1292:12/\"<b>RuntimeM1281:26/                          M1280:13/fulltarget)\nM1271:14/              M1270:12/<hr/><p>\"\nM1266:2/\"M1262:2/\"M1260:12/\"<p>runningM1259:14/              M1258:13/fulltarget)\nM1255:14/              M1254:9/stdpage\nM1251:14/              M1250:10/'(string\nM1249:12/            M1248:10/\"run\")\ni1242,2:9/         7/loop)\nM1240:8/infinitei1239,20:2/(=1/ 8/main...?1/ 3/run1/ 7/against1/ 7/protect1/ 3/XXX1/ 2/;;10/          7/)))\n\n13/             3/)\n1/ 6/rev)))1/ M1228:6/\"_\")M1219:14/              M1218:9/(string\ni1218,4:13/             2/\n5/     1/'M1208:4/(leti1208,2:12/            3/'\nM1200:4/(leti1200,2:12/            3/'\nM1194:5/\"/\"M1185:11/           M1184:10/\"raw\")\ni1178,2:7/       11/instance)\nM1176:3/forM1174:4/CSS,i1173,24:9/including1/ 3/for1/ 5/(good1/ 14/stuff/escaping1/ 6/excess1/ 2/no1/ 3/but1/ 5/view,1/ 4/like1/ 2/;;7/       20/it</a>?\")))))))\n\n1/ 13/\"\\\">create1/ M1170:17/href=\\\"/edit/\"M1160:9/\"PerhapsM1159:32/                                M1158:4/\"\nM1156:7/\"</b>.M1152:5/<b>\"M1142:7/\"ThereM1139:24/                        M1138:5/'(_\nM1137:22/                      M1136:16/\"</pre>\\n\")\nM1122:6/\"_\")M1112:12/\"<pre>\\n\"M1107:14/              M1106:12/<hr/><p>\"\nM1102:2/\"M1098:2/\"M1094:2/\"M1090:5/'\"\"M1088:6/\"_\")M1078:2/\"M1076:12/\"<p>viewingM1075:14/              M1074:9/target)\nM1071:14/              M1070:9/stdpage\nM1067:14/              M1066:9/(string\ni1066,4:13/             2/\n5/     1/'M1056:4/(leti1056,2:12/            3/'\nM1048:4/(leti1048,2:12/            3/'\nM1042:5/\"/\"M1033:11/           M1032:11/\"view\")\nM1025:7/       M1024:18/fulltarget))))\n\nM1020:4/\"))M1018:6/\"</a>i1014,2:54/                                                      2/\nM1012:9/\"\\\">\"M1008:5/\"/\"M1002:17/href=\\\"/view/\"M1000:4/\"<aM987:14/              M986:15/...<hr/><p>\"\nM984:2/\"M980:2/\"M976:12/\"<p>historyM975:14/              M974:13/fulltarget)\nM971:14/              M970:9/stdpage\nM967:14/              M966:10/'(string\nM965:12/            M964:14/\"history\")\ni958,2:7/       8/save\n\nM956:6/actionM954:1/;i953,6:7/)))))))8/        15/fulltarget)))\n1/ 12/\"/view/_/\"1/ i950,2:14/              8/exists\nM948:8/compilerM946:1/;i945,6:2/))20/                    14/fulltarget))\n1/ 12/\"/view/_/\"1/ M942:9/(redirecti942,2:20/                    10/inserted\ni941,20:2/we1/ 8/revision1/ 3/the1/ 2/to1/ 8/directly1/ 4/jump1/ 6/should1/ 3/XXX1/ 2/;;20/                    3/'\n1/ M932:4/(leti932,2:15/               12/executable\ni931,6:4/save1/ 1/;15/               3/'\n1/ M928:2/\"M922:2/\"M921:52/                                                    M920:12/fulltarget\nM918:2/\"M914:13/\"compilationi914,8:52/                                                    9/(string\n51/                                                   8/'abort\n51/                                                   7/(list\n50/                                                  8/aborts\nM912:4/thatM910:7/programM908:1/aM906:6/returni905,16:1/;50/                                                  4/we\n1/ 4/then1/ 6/fails,1/ 11/compilation1/ 2/if1/ 1/;50/                                                  7/'(msg\n1/ M895:15/               M894:9/compile\nM892:3/(ifi892,2:13/             3/'\nM882:4/(leti882,2:12/            8/source\ni881,6:4/save1/ 1/;12/            3/'\n1/ M876:15/\":compile\")))i862,2:9/         5/any\nM860:2/ifM858:9/compiler,i857,58:3/the1/ 8/closure)1/ 1/a1/ 7/produce1/ 2/to1/ 3/run1/ 4/(and1/ 3/get1/ 1/;9/         11/prog.b.w)\n1/ 3/eg.2/  13/recursively??1/ 4/this1/ 2/do1/ 6/(might1/ 2/;;9/         9/version\n1/ 8/compiled1/ 3/and1/ 6/source1/ 3/the1/ 6/saving1/ 8/compile,1/ 6/should1/ 2/we1/ 9/otherwise1/ 2/;;9/         17/fulltarget)))\n\n1/ 12/\"/view/_/\"1/ M854:9/(redirecti854,2:17/                 10/revision\ni853,8:4/goto1/ 3/XXX1/ 2/;;17/                 3/'\n1/ i844,2:11/           7/save.\nM842:4/justi841,34:2/;;11/           6/case\n1/ 4/this1/ 2/in1/ 5/name.1/ 6/entire1/ 3/the1/ 5/holds1/ 3/ext1/ 4/then1/ 1/.1/ 2/no1/ 3/was1/ 5/there1/ 2/if1/ 2/;;11/           7/\"\")\n1/ M836:3/(ifi836,2:7/       5/'\n\nM830:4/(leti830,2:7/       3/'\nM820:4/(leti820,2:7/       3/'\nM812:4/(leti812,2:7/       3/'\nM800:5/\".\"i792,2:6/      12/extension.\nM790:3/thei789,28:2/on1/ 5/based1/ 8/language1/ 3/the1/ 3/out1/ 6/figure1/ 1/;7/       2/\n1/ 10/compile...1/ 2/to1/ 4/need1/ 5/might1/ 1/;7/       11/\"save\")\n1/ M783:4/    M782:34/value=\\\"save\\\"></form>\"))\n\nM778:8/\"<inputM777:15/               M776:20/\"</textarea>\\n\"\nM775:15/               M774:10/data)\")\nM772:12/'\"(internalM771:19/                   M770:12/symbol)\")\nM768:6/\"(wasM765:19/                   M764:8/\")\")\nM760:2/\"M756:6/\"(wasM753:19/                   M752:14/oldcontents)\nM749:19/                   M748:10/data)\")\nM744:6/\"(wasM741:19/                   M740:10/data)\")\nM736:6/\"(wasM731:19/                   M730:7/'\"\"\nM729:19/                   M728:13/oldcontents\nM725:15/               M724:26/name=\\\"contents\\\">\"\nM718:16/\"\\\"><textareaM714:19/action=\\\"/save/\"M712:19/method=\\\"post\\\"M710:7/\"<formM709:15/               M708:16/deleted.</b>\"\nM684:12/\"<br/><b>DoM683:15/               M682:6/\"))\nM678:2/\"M674:2/\"M668:10/\"creatingM665:19/                   M664:5/\")\nM660:2/\"M656:2/\"M654:9/\"editingM651:19/                   M650:13/oldcontents\nM647:15/               M646:9/\"<p>\"\nM641:16/                M640:9/stdpage\nM636:7/(stringi636,2:8/        3/'\ni622,2:6/      10/textarea\nM620:3/thei619,32:2/in1/ 2/it1/ 3/put1/ 3/and1/ 2/;;6/      6/page\n1/ 4/this1/ 3/for1/ 4/code1/ 6/source1/ 3/the1/ 5/fetch1/ 2/to1/ 4/need1/ 2/;;6/      11/\"edit\")\n1/ M614:3/(ifM613:2/  M612:5/'\n\nM610:13/\"</div>\")))i610,2:27/                           4/\"\nM608:21/\"\\\">run</a></span>M604:16/href=\\\"/run/\"M602:20/class=\\\"tab\\\"><aM600:7/\"<spanM599:27/                           M598:4/\"\nM596:25/\"\\\">history</a></span>M592:20/href=\\\"/history/\"M590:20/class=\\\"tab\\\"><aM588:7/\"<spanM587:27/                           M586:4/\"\nM584:22/\"\\\">edit</a></span>M580:17/href=\\\"/edit/\"M578:20/class=\\\"tab\\\"><aM576:7/\"<spanM575:27/                           M574:4/\"\nM572:22/\"\\\">view</a></span>M568:19/href=\\\"/view/_/\"M566:20/class=\\\"tab\\\"><aM564:7/\"<spani564,2:27/                           23/class=\\\"tabs\\\">\"\nM562:6/\"<divM560:7/(stringi560,2:19/                   6/tabs\nM558:4/makei557,6:3/XXX1/ 1/;19/                   3/'\n1/ M549:13/             M548:7/'args\nM542:6/\n(leti542,2:2/  3/'\nM532:7/'\n(letM524:7/'\n(letM518:5/\"/\"M510:7/'\n(letM504:5/\"/\"M492:11/char)\n(leti491,34:1//1/ 8/starting1/ 3/the1/ 3/off1/ 5/(toss1/ 1/;2/  5/URL\n1/ 3/the1/ 2/on1/ 5/based1/ 5/doing1/ 5/we're1/ 4/what1/ 3/out1/ 6/figure1/ 1/;2/  5/'\n\n1/ M479:15/               M478:11/1))))))))\nM469:46/                                              M468:8/'ch)))\nM467:54/                                                      M466:12/'\"&amp;\"\nM465:56/                                                        M464:8/\"&\")\nM457:51/                                                   M456:11/'\"&gt;\"\nM455:53/                                                     M454:8/\">\")\nM447:48/                                                M446:11/'\"&lt;\"\nM445:50/                                                  M444:8/\"<\")\nM437:46/                                              M436:8/'(cons\nM435:44/                                            M434:4/n)\nM425:38/                                      M424:6/'nil\nM423:40/                                        M422:5/s))\nM413:35/                                   M412:8/args))\nM403:29/                             M402:7/args)\nM395:23/                       M394:7/'args\nM387:9/         M386:8/hargs)\nM379:4/    M378:8/'hargs\ni376,2:2/  6/PERF\nM374:1/;i374,2:2/  13/'htmlescape\nM372:9/'\n\n(letM370:7/)))))))i370,2:37/                                     6/1)))\nM357:42/                                          M356:7/1))))\nM325:42/                                          M324:6/sep)\nM317:37/                                     M316:4/n)\nM307:31/                               M306:4/s)\nM304:4/\"\"M289:28/                            M288:10/args))))\nM275:22/                      M274:9/args)))\nM263:16/                M262:8/args))\nM253:10/          M252:7/args)\nM245:4/    M244:7/'args\ni242,2:2/  9/'rtoken\nM240:6/\n(leti240,2:21/                     8/instanceM238:4/lastM236:3/buti235,8:5/same,1/ 6/'\n\n;1/ 7/)))))))37/                                     6/1)))\n1/ M223:42/                                          M222:7/1))))\nM191:42/                                          M190:6/sep)\nM183:37/                                     M182:4/n)\nM173:31/                               M172:7/\"\")\nM157:28/                            M156:10/args))))\nM143:22/                      M142:9/args)))\nM131:16/                M130:8/args))\nM121:10/          M120:7/args)\nM113:4/    M112:7/'args\ni110,2:2/  8/'token\nM108:11/given\n(letM106:4/chari105,18:3/the1/ 2/of1/ 8/instance1/ 5/first1/ 3/the1/ 2/to1/ 2/up1/ 4/chop1/ 6/'\n\n;1/ M103:25/                         M102:6/l)))\nM85:27/                           M84:3/l\nM81:22/                      M80:9/args)))\nM69:16/                M68:8/args))\nM59:10/          M58:7/args)\nM51:4/    M50:7/'args\ni48,2:2/  2/\nM44:11/'\n\n\n(letM42:18/\"\\r\\n\\r\\n\"))M36:2/\"M34:11/\"Location:M24:7/'\n(letM22:42/title=\\\"polybook\\\"/></head><body>\\n\"M20:32/href=\\\"/raw/_/polybook.css\\\"M18:21/type=\\\"text/css\\\"M14:19/\"<html><head><linkM10:7/'\n(letM8:27/charset=utf-8\\r\\n\\r\\n\"M4:15/\"Content-Type:M0:13/failure\n(leti0,46:1/ 11/compilation1/ 4/test1/ 2/;;1/ 13/revert.\n))))1/ 2/to1/ 4/need1/ 3/and1/ 2/up1/ 4/mess1/ 5/might1/ 2/we1/ 8/anything1/ 4/does1/ 4/page1/ 7/main-go1/ 2/;;1/ 6/parse:1/ 7/because1/ 6/failed1/ 9/main-go.b1/ 2/of1/ 12/"compilation1/ 6/(abortX
!9=M1818:27/action!")))))))))))))))))))M1816:8/"unknownd1814,1805:M1801:1/ M1800:12/it</a>?"))))d1799,1798:M1796:10/"\">createM1792:14/href=\"/edit/"M1782:8/"PerhapsM1781:1/ M1780:1/"M1778:6/"</b>.M1774:4/<b>"M1764:6/"ThereM1761:1/ M1760:3/'(_M1759:1/ M1758:7/msg))))M1756:1/"M1752:11/"<b>RuntimeM1741:1/ M1740:11/fulltarget)M1731:1/ M1730:9/<hr/><p>"M1726:1/"M1722:1/"M1720:11/"<p>runningM1719:1/ M1718:11/fulltarget)M1715:1/ M1714:7/stdpageM1711:1/ M1710:8/'(stringM1709:1/ M1708:6/"run")d1701,1700:M1698:10/rev)))))))d1696,1677:M1666:4/"_")M1657:1/ M1656:8/'(stringd1655,1652:M1642:5/'(letd1641,1640:M1632:5/'(letd1631,1630:M1624:3/"/"M1615:1/ M1614:6/"raw")d1607,1606:M1604:15/it</a>?")))))))M1602:10/"\">created1600,1577:M1574:14/href=\"/edit/"M1564:8/"PerhapsM1563:1/ M1562:1/"M1560:6/"</b>.M1556:4/<b>"M1546:6/"ThereM1543:1/ M1542:3/'(_M1541:1/ M1540:11/"</pre>\n")M1526:4/"_")M1516:9/"<pre>\n"M1511:1/ M1510:9/<hr/><p>"M1506:1/"M1502:1/"M1498:1/"M1494:3/'""M1492:4/"_")M1482:1/"M1480:11/"<p>viewingM1479:1/ M1478:7/target)M1475:1/ M1474:7/stdpageM1471:1/ M1470:8/'(stringd1469,1466:M1456:5/'(letd1455,1454:M1446:5/'(letd1445,1444:M1438:3/"/"M1429:1/ M1428:7/"view")M1421:1/ M1420:14/fulltarget))))M1416:3/"))M1414:5/"</a>d1409,1408:M1406:5/"\">"M1402:3/"/"M1396:14/href=\"/view/"M1394:3/"<aM1381:1/ M1380:12/...<hr/><p>"M1378:1/"M1374:1/"M1370:11/"<p>historyM1369:1/ M1368:11/fulltarget)M1365:1/ M1364:7/stdpageM1361:1/ M1360:8/'(stringM1359:1/ M1358:10/"history")d1351,1350:M1348:20/fulltarget))))))))))M1346:10/"/view/_/"d1344,1339:d1335,1334:M1332:14/fulltarget))))M1330:10/"/view/_/"d1328,1323:M1320:10/'(redirectd1319,1318:d1316,1297:M1288:5/'(letd1287,1286:d1284,1279:M1276:1/"M1270:1/"M1269:1/ M1268:10/fulltargetM1266:1/"M1262:12/"compilationd1261,1254:M1252:7/(stringM1250:6/'abortM1248:5/(listM1246:5/'(msgd1244,1229:M1219:1/ M1218:7/compileM1216:4/'(ifd1215,1214:M1204:5/'(letd1203,1202:d1200,1195:M1190:13/":compile")))d1175,1174:M1172:13/fulltarget)))M1170:10/"/view/_/"d1168,1111:M1108:10/'(redirectd1107,1106:d1104,1097:d1087,1086:M1084:3/"")d1082,1049:M1044:4/'(ifd1043,1042:M1036:5/'(letd1035,1034:M1024:5/'(letd1023,1022:M1014:5/'(letd1013,1012:M1000:3/"."d991,990:M988:7/"save")d986,959:M953:1/ M952:25/value=\"save\"></form>"))M948:7/"<inputM947:1/ M946:15/"</textarea>\n"M945:1/ M944:7/data)")M942:11/'"(internalM941:1/ M940:9/symbol)")M938:5/"(wasM935:1/ M934:4/")")M930:1/"M926:5/"(wasM923:1/ M922:12/oldcontents)M919:1/ M918:7/data)")M914:5/"(wasM911:1/ M910:7/data)")M906:5/"(wasM901:1/ M900:3/'""M899:1/ M898:11/oldcontentsM895:1/ M894:19/name=\"contents\">"M888:13/"\"><textareaM884:16/action=\"/save/"M882:15/method=\"post\"M880:6/"<formM879:1/ M878:13/deleted.</b>"M854:11/"<br/><b>DoM853:1/ M852:3/"))M848:1/"M844:1/"M838:9/"creatingM835:1/ M834:2/")M830:1/"M826:1/"M824:8/"editingM821:1/ M820:11/oldcontentsM817:1/ M816:5/"<p>"M811:1/ M810:7/stdpageM806:8/'(stringd805,804:d789,788:M786:7/"edit")d784,753:M748:4/'(ifM747:1/ M746:11/"</div>")))M744:1/"d743,742:M740:18/"\">run</a></span>M736:13/href=\"/run/"M734:16/class=\"tab\"><aM732:6/"<spanM731:1/ M730:1/"M728:22/"\">history</a></span>M724:17/href=\"/history/"M722:16/class=\"tab\"><aM720:6/"<spanM719:1/ M718:1/"M716:19/"\">edit</a></span>M712:14/href=\"/edit/"M710:16/class=\"tab\"><aM708:6/"<spanM707:1/ M706:1/"M704:19/"\">view</a></span>M700:16/href=\"/view/_/"M698:16/class=\"tab\"><aM696:6/"<spand695,694:M692:16/class=\"tabs\">"M690:5/"<divd689,688:M686:8/'(stringd684,679:M671:1/ M670:5/'argsM664:5/'(letd663,662:M652:5/'(letM644:5/'(letM638:3/"/"M630:5/'(letM624:3/"/"M612:5/'(letd610,577:M565:1/ M564:9/1))))))))M555:1/ M554:6/'ch)))M553:1/ M552:8/'"&amp;"M551:1/ M550:4/"&")M543:1/ M542:7/'"&gt;"M541:1/ M540:4/">")M533:1/ M532:7/'"&lt;"M531:1/ M530:4/"<")M523:1/ M522:6/'(consM521:1/ M520:2/n)M511:1/ M510:4/'nilM509:1/ M508:3/s))M499:1/ M498:6/args))M489:1/ M488:5/args)M481:1/ M480:5/'argsM473:1/ M472:6/hargs)M465:1/ M464:6/'hargsd461,460:M458:11/'htmlescaped457,456:M454:5/'(letM452:11/1))))))))))d451,450:M437:1/ M436:5/1))))M405:1/ M404:4/sep)M397:1/ M396:2/n)M387:1/ M386:2/s)M384:2/""M369:1/ M368:8/args))))M355:1/ M354:7/args)))M343:1/ M342:6/args))M333:1/ M332:5/args)M325:1/ M324:5/'argsd321,320:M318:7/'rtokend317,316:M314:5/'(letM312:11/1))))))))))d310,303:M291:1/ M290:5/1))))M259:1/ M258:4/sep)M251:1/ M250:2/n)M241:1/ M240:3/"")M225:1/ M224:8/args))))M211:1/ M210:7/args)))M199:1/ M198:6/args))M189:1/ M188:5/args)M181:1/ M180:5/'argsd177,176:M174:6/'tokenM172:5/'(letd170,153:M151:1/ M150:4/l)))M133:1/ M132:1/lM129:1/ M128:7/args)))M117:1/ M116:6/args))M107:1/ M106:5/args)M99:1/ M98:5/'argsd95,94:M90:5/'(letM88:12/"\r\n\r\n"))M82:1/"M80:10/"Location:M70:5/'(letM68:36/title=\"polybook\"/></head><body>\n"M66:28/href=\"/raw/_/polybook.css\"M64:17/type=\"text/css\"M60:18/"<html><head><linkM56:5/'(letM54:22/charset=utf-8\r\n\r\n"M50:14/"Content-Type:M46:4/(letd45,0:X

main-go.b 121 44/"; this code has been replaced by main-go.w"
!20=M14:25/analysis\n\n))))))))))))"M12:4/caseM10:6/actionM8:1/;M6:4/))))i6,2:7/       16/action!\")))\n\nM4:9/\"unknowni3,658:9/stdheader1/ 8/'(string10/          4/\n\n12/            15/it</a>?\"))))\n1/ 13/\"\\\">create1/ 10/fulltarget1/ 17/href=\\\"/edit/\"1/ 2/<a1/ 2/to1/ 4/like1/ 5/you'd1/ 9/\"Perhaps32/                                4/\"\n1/ 7/\"</b>.1/ 10/fulltarget1/ 5/<b>\"1/ 6/called1/ 6/symbol1/ 2/no1/ 2/is1/ 7/\"There1/ 7/(string24/                        5/'(_\n22/                      9/msg))))\n1/ 2/\"1/ 10/error</b>:1/ 12/\"<b>Runtime1/ 7/(string1/ 5/'(msg1/ 5/prog)1/ 6/'(eval1/ 8/'(handle26/                          13/fulltarget)\n1/ 5/(head1/ 5/'prog1/ 5/'(let1/ 7/(handle14/              12/<hr/><p>\"\n1/ 3/...1/ 2/\"1/ 10/fulltarget1/ 2/\"1/ 12/\"<p>running14/              13/fulltarget)\n1/ 5/(tabs14/              9/stdpage\n1/ 9/stdheader14/              10/'(string\n12/            10/\"run\")\n1/ 6/action1/ 3/(eq1/ 4/'(if9/         10/main-go)\n1/ 3/run1/ 3/(or1/ 2/;;10/          7/loop)\n1/ 8/infinite1/ 2/(=1/ 8/main...?1/ 3/run1/ 7/against1/ 7/protect1/ 3/XXX1/ 2/;;10/          7/)))\n\n13/             3/)\n1/ 6/rev)))1/ 4/(int1/ 6/target1/ 6/'(read1/ 7/target)1/ 6/'(head1/ 6/\"_\")1/ 3/rev1/ 3/(eq1/ 3/(if1/ 9/stdheader14/              9/(string\n13/             2/\n5/     1/'1/ 12/rev_target))1/ 4/(cdr1/ 4/(car1/ 7/'target1/ 4/(let12/            3/'\n1/ 11/rev_target)1/ 4/(car1/ 4/'rev1/ 4/(let12/            3/'\n1/ 2/0)1/ 10/fulltarget1/ 5/\"/\"1/ 5/token1/ 6/(token1/ 11/'rev_target1/ 5/'(let11/           10/\"raw\")\n1/ 6/action1/ 3/(eq1/ 4/'(if7/       11/instance)\n1/ 3/for1/ 4/CSS,1/ 9/including1/ 3/for1/ 5/(good1/ 14/stuff/escaping1/ 6/excess1/ 2/no1/ 3/but1/ 5/view,1/ 4/like1/ 2/;;7/       20/it</a>?\")))))))\n\n1/ 13/\"\\\">create1/ 6/target1/ 17/href=\\\"/edit/\"1/ 2/<a1/ 2/to1/ 4/like1/ 5/you'd1/ 9/\"Perhaps32/                                4/\"\n1/ 7/\"</b>.1/ 6/target1/ 5/<b>\"1/ 6/called1/ 6/symbol1/ 2/no1/ 2/is1/ 7/\"There1/ 7/(string24/                        5/'(_\n22/                      16/\"</pre>\\n\")\n1/ 7/rev))))1/ 4/(int1/ 6/target1/ 6/'(read1/ 7/target)1/ 6/'(head1/ 6/\"_\")1/ 3/rev1/ 3/(eq1/ 3/(if1/ 11/(htmlescape1/ 12/\"<pre>\\n\"1/ 8/'(string1/ 7/(handle14/              12/<hr/><p>\"\n1/ 3/...1/ 2/\"1/ 5/rev))1/ 2/\"1/ 1/@1/ 2/\"1/ 8/'(string1/ 5/'\"\"1/ 6/\"_\")1/ 3/rev1/ 3/(eq1/ 3/(if1/ 6/target1/ 2/\"1/ 12/\"<p>viewing14/              9/target)\n1/ 5/(tabs14/              9/stdpage\n1/ 9/stdheader14/              9/(string\n13/             2/\n5/     1/'1/ 12/rev_target))1/ 4/(cdr1/ 4/(car1/ 7/'target1/ 4/(let12/            3/'\n1/ 11/rev_target)1/ 4/(car1/ 4/'rev1/ 4/(let12/            3/'\n1/ 2/0)1/ 10/fulltarget1/ 5/\"/\"1/ 5/token1/ 6/(token1/ 11/'rev_target1/ 5/'(let11/           11/\"view\")\n1/ 6/action1/ 3/(eq1/ 4/'(if7/       18/fulltarget))))\n\n1/ 8/(history1/ 4/\"))1/ 6/\"</a>1/ 5/args)1/ 4/(car54/                                                      2/\n1/ 9/\"\\\">\"1/ 10/fulltarget1/ 5/\"/\"1/ 5/args)1/ 4/(car1/ 17/href=\\\"/view/\"1/ 4/\"<a1/ 8/'(string1/ 5/'args1/ 7/(lambda1/ 3/map1/ 4/(map1/ 7/(string14/              15/...<hr/><p>\"\n1/ 2/\"1/ 10/fulltarget1/ 2/\"1/ 3/for1/ 12/\"<p>history14/              13/fulltarget)\n1/ 5/(tabs14/              9/stdpage\n1/ 9/stdheader14/              10/'(string\n12/            14/\"history\")\n1/ 6/action1/ 3/(eq1/ 4/'(if7/       8/save\n\n1/ 6/action1/ 1/;1/ 7/)))))))8/        15/fulltarget)))\n1/ 12/\"/view/_/\"1/ 7/(string1/ 10/'(redirect14/              8/exists\n1/ 8/compiler1/ 1/;1/ 2/))20/                    14/fulltarget))\n1/ 12/\"/view/_/\"1/ 7/(string1/ 9/(redirect20/                    10/inserted\n1/ 2/we1/ 8/revision1/ 3/the1/ 2/to1/ 8/directly1/ 4/jump1/ 6/should1/ 3/XXX1/ 2/;;20/                    3/'\n1/ 4/exe)1/ 4/base1/ 7/(insert1/ 2/'_1/ 4/(let16/                12/executable\n1/ 4/save1/ 1/;15/               3/'\n1/ 4/dat)1/ 8/(compile1/ 4/'exe1/ 5/'(let15/               9/source.\n1/ 3/the1/ 4/save1/ 7/already1/ 3/did1/ 2/we1/ 3/but1/ 2/;;15/               6/page\n1/ 8/compiled1/ 3/the1/ 9/overwrite1/ 5/don't1/ 3/and1/ 9/propagate1/ 3/exn1/ 3/let1/ 6/fails,1/ 11/compilation1/ 2/if1/ 2/;;15/               9/compile\n1/ 3/(if13/             3/'\n1/ 4/dat)1/ 10/fulltarget1/ 7/(insert1/ 2/'_1/ 4/(let12/            8/source\n1/ 4/save1/ 1/;12/            3/'\n1/ 5/nil))1/ 3/'(_1/ 15/\":compile\")))1/ 3/ext1/ 7/(string1/ 5/(head1/ 6/'(eval1/ 7/(handle1/ 8/'compile1/ 5/'(let9/         5/any\n1/ 2/if1/ 9/compiler,1/ 3/the1/ 8/closure)1/ 1/a1/ 7/produce1/ 2/to1/ 3/run1/ 4/(and1/ 3/get1/ 1/;9/         11/prog.b.w)\n1/ 3/eg.2/  13/recursively??1/ M0:2/doi0,1120:1/ 6/(might1/ 2/;;9/         9/version\n1/ 8/compiled1/ 3/and1/ 6/source1/ 3/the1/ 6/saving1/ 8/compile,1/ 6/should1/ 2/we1/ 9/otherwise1/ 2/;;9/         17/fulltarget)))\n\n1/ 12/\"/view/_/\"1/ 7/(string1/ 9/(redirect17/                 10/revision\n1/ 4/goto1/ 3/XXX1/ 2/;;17/                 3/'\n1/ 4/dat)1/ 10/fulltarget1/ 7/(insert1/ 2/'_1/ 5/'(let11/           7/save.\n1/ 4/just1/ 2/;;11/           6/case\n1/ 4/this1/ 2/in1/ 5/name.1/ 6/entire1/ 3/the1/ 5/holds1/ 3/ext1/ 4/then1/ 1/.1/ 2/no1/ 3/was1/ 5/there1/ 2/if1/ 2/;;11/           7/\"\")\n1/ 4/base1/ 3/(eq1/ 3/(if7/       5/'\n\n1/ 13/form.contents1/ 4/'dat1/ 4/(let7/       3/'\n1/ 10/base_ext))1/ 4/(cdr1/ 4/(car1/ 4/'ext1/ 4/(let7/       3/'\n1/ 9/base_ext)1/ 4/(car1/ 5/'base1/ 4/(let7/       3/'\n1/ 3/1))1/ 11/fulltarget)1/ 5/(size1/ 2/(-1/ 10/fulltarget1/ 5/\".\"1/ 6/rtoken1/ 7/(rtoken1/ 9/'base_ext1/ 5/'(let6/      12/extension.\n1/ 3/the1/ 2/on1/ 5/based1/ 8/language1/ 3/the1/ 3/out1/ 6/figure1/ 1/;7/       2/\n1/ 10/compile...1/ 2/to1/ 4/need1/ 5/might1/ 1/;7/       11/\"save\")\n1/ 6/action1/ 3/(eq1/ 4/'(if4/    34/value=\\\"save\\\"></form>\"))\n\n1/ 11/type=submit1/ 8/\"<input15/               20/\"</textarea>\\n\"\n15/               10/data)\")\n1/ 12/'\"(internal19/                   12/symbol)\")\n1/ 6/\"(was1/ 3/'(_19/                   8/\")\")\n1/ 11/oldcontents1/ 2/\"1/ 3/int1/ 6/\"(was1/ 8/'(string19/                   14/oldcontents)\n1/ 12/'(htmlescape19/                   10/data)\")\n1/ 6/quoted1/ 6/\"(was1/ 3/'(_19/                   10/data)\")\n1/ 4/list1/ 6/\"(was1/ 1/_1/ 3/'(_19/                   7/'\"\"\n19/                   13/oldcontents\n1/ 6/(xcase15/               26/name=\\\"contents\\\">\"\n1/ 8/cols=1201/ 7/rows=351/ 16/\"\\\"><textarea1/ 10/fulltarget1/ 19/action=\\\"/save/\"1/ 19/method=\\\"post\\\"1/ 7/\"<form15/               16/deleted.</b>\"\n1/ 2/be1/ 4/will1/ 2/It1/ 11/permission.1/ 7/without1/ 8/websites1/ 5/other1/ 4/from1/ 4/text1/ 4/copy1/ 3/not1/ 12/\"<br/><b>Do15/               6/\"))\n1/ 3/...1/ 2/\"1/ 10/fulltarget1/ 2/\"1/ 4/page1/ 3/new1/ 10/\"creating1/ 8/'(string19/                   5/\")\n1/ 3/...1/ 2/\"1/ 10/fulltarget1/ 2/\"1/ 9/\"editing1/ 8/'(string19/                   13/oldcontents\n1/ 3/(if15/               9/\"<p>\"\n1/ 11/fulltarget)1/ 5/(tabs16/                9/stdpage\n1/ 9/stdheader1/ 7/(string8/        3/'\n1/ 5/nil))1/ 3/'(_1/ 11/fulltarget)1/ 6/'(head1/ 7/(handle1/ 12/'oldcontents1/ 5/'(let6/      10/textarea\n1/ 3/the1/ 2/in1/ 2/it1/ 3/put1/ 3/and1/ 2/;;6/      6/page\n1/ 4/this1/ 3/for1/ 4/code1/ 6/source1/ 3/the1/ 5/fetch1/ 2/to1/ 4/need1/ 2/;;6/      11/\"edit\")\n1/ 6/action1/ 3/(eq1/ 3/(if2/  5/'\n\n1/ 13/\"</div>\")))27/                           4/\"\n1/ 21/\"\\\">run</a></span>1/ 4/page1/ 16/href=\\\"/run/\"1/ 20/class=\\\"tab\\\"><a1/ 7/\"<span27/                           4/\"\n1/ 25/\"\\\">history</a></span>1/ 4/page1/ 20/href=\\\"/history/\"1/ 20/class=\\\"tab\\\"><a1/ 7/\"<span27/                           4/\"\n1/ 22/\"\\\">edit</a></span>1/ 4/page1/ 17/href=\\\"/edit/\"1/ 20/class=\\\"tab\\\"><a1/ 7/\"<span27/                           4/\"\n1/ 22/\"\\\">view</a></span>1/ 4/page1/ 19/href=\\\"/view/_/\"1/ 20/class=\\\"tab\\\"><a1/ 7/\"<span27/                           23/class=\\\"tabs\\\">\"\n1/ 6/\"<div1/ 7/(string19/                   6/tabs\n1/ 4/make1/ 3/XXX1/ 1/;19/                   3/'\n1/ 5/args)1/ 4/(car1/ 5/'page1/ 5/'(let13/             7/'args\n1/ 7/(lambda1/ 5/'tabs1/ 6/\n(let2/  3/'\n1/ 15/action_target))1/ 4/(cdr1/ 4/(car1/ 11/'fulltarget1/ 7/'\n(let1/ 14/action_target)1/ 4/(car1/ 7/'action1/ 7/'\n(let1/ 2/0)1/ 3/url1/ 5/\"/\"1/ 5/token1/ 6/(token1/ 14/'action_target1/ 7/'\n(let1/ 4/0)))1/ 11/request.url1/ 5/\"/\"1/ 5/token1/ 6/(token1/ 4/(cdr1/ 4/(car1/ 4/'url1/ 11/char)\n(let1/ 1//1/ 8/starting1/ 3/the1/ 3/off1/ 5/(toss1/ 1/;2/  5/URL\n1/ 3/the1/ 2/on1/ 5/based1/ 5/doing1/ 5/we're1/ 4/what1/ 3/out1/ 6/figure1/ 1/;2/  5/'\n\n1/ 7/0))))))1/ 4/hrec1/ 5/(hrec1/ 6/string1/ 5/(cons1/ 6/'(eval15/               11/1))))))))\n1/ 1/n1/ 2/(+1/ 4/self1/ 5/(self46/                                              8/'ch)))\n54/                                                      12/'\"&amp;\"\n56/                                                        8/\"&\")\n1/ 2/ch1/ 3/(eq1/ 4/'(if51/                                                   11/'\"&gt;\"\n53/                                                     8/\">\")\n1/ 2/ch1/ 3/(eq1/ 4/'(if48/                                                11/'\"&lt;\"\n50/                                                  8/\"<\")\n1/ 2/ch1/ 3/(eq1/ 3/(if46/                                              8/'(cons\n44/                                            4/n)\n1/ 1/s1/ 4/(sub1/ 3/'ch1/ 5/'(let38/                                      6/'nil\n40/                                        5/s))\n1/ 5/(size1/ 1/n1/ 3/(eq1/ 4/'(if35/                                   8/args))\n1/ 4/(cdr1/ 4/(car1/ 2/'n1/ 5/'(let29/                             7/args)\n1/ 4/(car1/ 5/'self1/ 5/'(let23/                       7/'args\n1/ 7/(lambda1/ 5/'hrec1/ 5/'(let9/         8/hargs)\n1/ 4/(car1/ 2/'s1/ 5/'(let4/    8/'hargs\n1/ 7/(lambda2/  6/PERF\n1/ 1/;2/  13/'htmlescape\n1/ 9/'\n\n(let1/ 7/)))))))37/                                     6/1)))\n1/ 1/n1/ 2/(-1/ 1/s1/ 3/sep1/ 4/self1/ 6/'(self42/                                          7/1))))\n1/ 1/n1/ 2/(+1/ 2/s)1/ 5/(size1/ 2/(-1/ 2/1)1/ 1/n1/ 2/(+1/ 1/s1/ 7/(substr1/ 2/n)1/ 1/01/ 1/s1/ 7/(substr1/ 6/'(list42/                                          6/sep)\n1/ 2/ch1/ 3/(eq1/ 4/'(if37/                                     4/n)\n1/ 1/s1/ 4/(sub1/ 3/'ch1/ 5/'(let31/                               4/s)\n1/ 4/\"\"1/ 6/'(list1/ 3/1))1/ 1/01/ 2/(-1/ 1/n1/ 3/(eq1/ 4/'(if28/                            10/args))))\n1/ 4/(cdr1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'n1/ 5/'(let22/                      9/args)))\n1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'s1/ 5/'(let16/                8/args))\n1/ 4/(cdr1/ 4/(car1/ 4/'sep1/ 5/'(let10/          7/args)\n1/ 4/(car1/ 5/'self1/ 5/'(let4/    7/'args\n1/ 7/(lambda2/  9/'rtoken\n1/ 6/\n(let21/                     8/instance1/ 4/last1/ 3/but1/ 5/same,1/ 6/'\n\n;1/ 7/)))))))37/                                     6/1)))\n1/ 1/n1/ 2/(+1/ 1/s1/ 3/sep1/ 4/self1/ 6/'(self42/                                          7/1))))\n1/ 1/n1/ 2/(+1/ 2/s)1/ 5/(size1/ 2/(-1/ 2/1)1/ 1/n1/ 2/(+1/ 1/s1/ 7/(substr1/ 2/n)1/ 1/01/ 1/s1/ 7/(substr1/ 6/'(list42/                                          6/sep)\n1/ 2/ch1/ 3/(eq1/ 4/'(if37/                                     4/n)\n1/ 1/s1/ 4/(sub1/ 3/'ch1/ 5/'(let31/                               7/\"\")\n1/ 1/s1/ 6/'(list1/ 3/s))1/ 5/(size1/ 1/n1/ 3/(eq1/ 4/'(if28/                            10/args))))\n1/ 4/(cdr1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'n1/ 5/'(let22/                      9/args)))\n1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'s1/ 5/'(let16/                8/args))\n1/ 4/(cdr1/ 4/(car1/ 4/'sep1/ 5/'(let10/          7/args)\n1/ 4/(car1/ 5/'self1/ 5/'(let4/    7/'args\n1/ 7/(lambda2/  8/'token\n1/ 11/given\n(let1/ 4/char1/ 3/the1/ 2/of1/ 8/instance1/ 5/first1/ 3/the1/ 2/to1/ 2/up1/ 4/chop1/ 6/'\n\n;1/ 9/'nil)))))25/                         6/l)))\n1/ 4/(cdr1/ 1/f1/ 4/self1/ 5/(self1/ 3/l))1/ 4/(car1/ 2/(f1/ 6/'(cons27/                           3/l\n1/ 4/'(if22/                      9/args)))\n1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'l1/ 5/'(let16/                8/args))\n1/ 4/(cdr1/ 4/(car1/ 2/'f1/ 5/'(let10/          7/args)\n1/ 4/(car1/ 5/'self1/ 5/'(let4/    7/'args\n1/ 7/(lambda2/  2/\n1/ 4/'map1/ 11/'\n\n\n(let1/ 18/\"\\r\\n\\r\\n\"))1/ 7/target)1/ 4/(car1/ 2/\"1/ 11/\"Location:1/ 8/'(string1/ 7/'target1/ 7/(lambda1/ 9/'redirect1/ 7/'\n(let1/ 42/title=\\\"polybook\\\"/></head><body>\\n\"1/ 32/href=\\\"/raw/_/polybook.css\\\"1/ 21/type=\\\"text/css\\\"1/ 14/rel=stylesheet1/ 19/\"<html><head><link1/ 8/'stdpage1/ 7/'\n(let1/ 27/charset=utf-8\\r\\n\\r\\n\"1/ 10/text/html;1/ 15/\"Content-Type:1/ 10/'stdheader1/ 15/revert.\n\n(let1/ 2/to1/ 4/need1/ 3/and1/ 2/up1/ 4/mess1/ 5/might1/ 2/we1/ 8/anything1/ 4/does1/ 4/page1/ 7/main-go1/ 3/";;X
!19=M1238:12/preserved)\ni1237,8:4/data1/ 4/with1/ 4/page1/ 4/edit1/ M1234:2/toM1232:4/themM1230:4/sendi1229,4:5/maybe1/ 5/could1/ M1226:6/thoughM1225:2/  M1222:10/manually\nM1220:6/buttonM1218:4/backM1216:3/usei1215,10:3/can1/ 5/(user1/ 2/;;15/               10/anything\n1/ 4/save1/ M24:11/again\n(leti23,8:5/error1/ 4/test1/ 2/;;1/ 11/revert.\n))1/ X
!17=M32:15/revert.\n\n(letd30,23:X
!15=d1698,1691:X
!12=M1277:15/               M1268:7/msg))))M1266:2/\"M1264:7/becauseM1262:6/failedd1261,1260:M1258:2/\"M1257:52/                                                    M1256:12/fulltarget\nM1254:2/\"M1252:2/ofM1250:13/\"compilationM1249:52/                                                    M1248:9/(string\nM1247:51/                                                   M1246:8/'abort\nM1245:51/                                                   M1244:7/(list\nM1243:50/                                                  M1242:8/aborts\nM1240:4/thatM1238:7/programM1236:1/ad1235,1232:M1230:6/returnM1228:1/;M1227:50/                                                  M1226:4/we\nM1224:4/thenM1222:6/fails,M1220:11/compilationd1219,1218:M1216:2/ifM1214:1/;M1213:50/                                                  M1212:7/'(msg\nM1210:4/dat)M1208:9/'(compileM1206:7/(handleM1204:4/'exeM1202:5/'(letd1201,1198:M24:13/failure\n(leti23,8:11/compilation1/ 4/test1/ 2/;;1/ 13/revert.\n))))1/ X
!8=M32:15/revert.\n\n(letd30,23:M0:5/"\n;;X

main-go.w 119 7286/";; main-go page does anything we might mess up and need to revert.\n\n(include \"stdlib\"\n(let stdheader \"Content-Type: text/html; charset=utf-8\\r\\n\\r\\n\" \n(let stdpage \"<html><head><link rel=stylesheet type=\\\"text/css\\\" href=\\\"/raw/_/polybook.css\\\" title=\\\"polybook\\\"/></head><body>\\n\" \n(let redirect (fn (target) (string \"Location: \" target \"\\r\\n\\r\\n\"))\n\n; chop up to the first instance of the char given\n(let token\n  (fn (self sep s n)\n    (if (eq n (size s)) \n\t(list s \"\")\n      (let ch (sub s n)\n\t (if (eq ch sep)\n\t     (list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1))))\n\t   (self self sep s (+ n 1))))))\n\n; same, but last instance                     \n(let rtoken\n  (fn (self sep s n)\n      (if (eq n (- 0 1)) \n\t  (list \"\" s)\n\t(let ch (sub s n)\n\t     (if (eq ch sep)\n\t\t (list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1))))\n\t       (self self sep s (- n 1))))))\n\n(let htmlescape \n   (fn (s)\n     (let hrec \n       (fn (self st en)\n          (if (eq en (size s)) \n              (list (substr s st (- en st)))\n              (let ch (sub s en)\n               (if (eq ch \"<\")\n                   (cons (substr s st (- en st)) (cons \"&lt;\" (self self (+ en 1) (+ en 1))))\n                   (if (eq ch \">\")\n                       (cons (substr s st (- en st)) (cons \"&gt;\" (self self (+ en 1) (+ en 1))))\n                       (if (eq ch \"&\")\n                           (cons (substr s st (- en st)) (cons \"&amp;\" (self self (+ en 1) (+ en 1))))\n                           (self self st (+ en 1))\n                        )\n                    )\n                ))))\n       (eval (cons string (hrec hrec 0 0)))\n    ))\n\n  ; figure out what we're doing based on the URL\n  ; (toss off the starting / char)\n(let url (car (cdr (token token \"/\" request.url 0)))\n(let action_target (token token \"/\" url 0)\n(let action (car action_target)\n(let fulltarget (car (cdr action_target))\n  \n(let tabs (fn (page)\n\t      (string \"<div class=\\\"tabs\\\">\"\n\t\t      \"<span class=\\\"tab\\\"><a href=\\\"/view/_/\" page \"\\\">view</a></span> \"\n\t\t      \"<span class=\\\"tab\\\"><a href=\\\"/edit/\" page \"\\\">edit</a></span> \"\n\t\t      \"<span class=\\\"tab\\\"><a href=\\\"/history/\" page \"\\\">history</a></span> \"\n\t\t      \"<span class=\\\"tab\\\"><a href=\\\"/run/\" page \"\\\">run</a></span> \"\n\t\t      \"</div>\"))\n\n  (if (eq action \"edit\")\n      ;; need to fetch the source code for this page\n      ;; and put it in the textarea\n      (let oldcontents (handle (head fulltarget) (_ nil))\n        (string stdheader stdpage\n                (tabs fulltarget) \"<p>\"\n               (if oldcontents\n                   (string \"editing \" fulltarget \" ... \")\n                   (string \"creating new page \" fulltarget \" ... \"))\n               \"<br/><b>Do not copy text from other websites without permission. It will be deleted.</b>\"\n               \"<form method=\\\"post\\\" action=\\\"/save/\" fulltarget \"\\\"><textarea rows=35 cols=120 name=\\\"contents\\\">\"\n               (xcase oldcontents\n                   \"\"\n                   (_ _ \"(was list data)\")\n                   (_ \"(was quoted data)\")\n                   (htmlescape oldcontents)\n                   (string \"(was int \" oldcontents \")\")\n                   (_ \"(was symbol)\")\n                   \"(internal data)\")\n               \"</textarea>\\n\"\n               \"<input type=submit value=\\\"save\\\"></form>\"))\n\n    (if (eq action \"save\")\n       ; might need to compile... \n       ; figure out the language based on the extension.\n       (let base_ext (rtoken rtoken \".\" fulltarget (- (size fulltarget) 1)) \n       (let base (car base_ext) \n       (let ext (car (cdr base_ext)) \n       (let dat form.contents \n\n       (if (eq base \"\")\n           ;; if there was no . then ext holds the entire name. in this case\n           ;; just save.\n           (let _ (insert fulltarget dat) \n                 ;; XXX goto revision\n                 (redirect (string \"/view/_/\" fulltarget)))\n\n         ;; otherwise we should compile, saving the source and compiled version\n         ;; (might do this recursively??  eg. prog.b.w)\n         ; get (and run to produce a closure) the compiler, if any\n         (let compile (handle (eval (head (string ext \":compile\"))) (_ nil))\n            ; save source\n            (let _ (insert fulltarget dat) \n             (if compile\n               ;; if compilation fails, let exn propagate and don't overwrite the compiled page\n               ;; but we did already save the source.\n\t       (let exe (compile dat) \n               ; save executable\n               (let _ (insert base exe)\n                    ;; XXX should jump directly to the revision we inserted\n                    (redirect (string \"/view/_/\" fulltarget))\n                    )) ; compiler exists\n              (redirect (string \"/view/_/\" fulltarget)))\n        ))))))) ; action save\n\n       (if (eq action \"history\")\n            (string\n              stdheader stdpage\n              (tabs fulltarget)\n              \"<p>history for \" fulltarget \" ...<hr/><p>\"\n              (string (map (fn (r) (string \"<a href=\\\"/view/\" r \"/\" fulltarget \"\\\">\" \n                                                      r \"</a> \")) (history fulltarget))))\n\n       (if (eq action \"view\")\n            (let rev_target (token token \"/\" fulltarget 0)\n            (let rev (car rev_target)\n            (let target (car (cdr rev_target))\n             (string\n              stdheader stdpage\n              (tabs target)\n              \"<p>viewing \" target (if (eq rev \"_\") \"\" (string \" @ \" rev)) \" ... <hr/><p>\"\n              (handle (string \"<pre>\\n\" (htmlescape (string (if (eq rev \"_\") (head target) (read target (int rev))))) \"</pre>\\n\")\n                      (_\n\t\t       (string \"There is no symbol called <b>\" target \"</b>. \"\n\t\t\t       \"Perhaps you'd like to <a href=\\\"/edit/\" target \"\\\">create it</a>?\")))))))\n\n       ;; like view, but no excess stuff/escaping (good for including CSS, for instance)\n       (if (eq action \"raw\")\n\t    (let rev_target (token token \"/\" fulltarget 0)\n            (let rev (car rev_target)\n            (let target (car (cdr rev_target))\n             (string\n              stdheader (if (eq rev \"_\") (head target) (read target (int rev))) )\n             )))\n\n          ;; XXX protect against run main...? (= infinite loop)\n          ;; (or run main-go)\n       (if (eq action \"run\")\n            (string\n\t     stdheader stdpage\n\t     (tabs fulltarget)\n\t     \"<p>running \" fulltarget \" ... <hr/><p>\"\n\t     (handle (let prog (head fulltarget)\n                          (handle (eval prog) (msg (string \"<b>Runtime error</b>: \" msg))))\n\t\t     (_\n\t\t      (string \"There is no symbol called <b>\" fulltarget \"</b>. \"\n\t\t\t      \"Perhaps you'd like to <a href=\\\"/edit/\" fulltarget \"\\\">create it</a>?\"))))\n\t \n\t ;; XXX probably should go to main page?\n\t (string stdheader \"unknown action!\")))\n\n       )))) ; action case analysis\n\n))))))))))))"
!117=M498:4/0)\nd491,486:X
!110=M494:11/0))))))\n\nd493,492:d490,489:d485,478:M476:6/stringM474:5/(consM472:5/(evalM471:15/               M470:11/1))))))))\nM468:1/nd467,466:d464,463:d460,455:M451:46/                                              M450:7/ch)))\nM449:54/                                                      M448:11/\"&amp;\"\nM447:56/                                                        d446,433:M425:51/                                                   M424:10/\"&gt;\"\nM423:53/                                                     d422,391:M383:48/                                                M382:10/\"&lt;\"\nM381:50/                                                  d380,349:M341:46/                                              M340:7/(cons\ni340,2:44/                                            4/n)\nM331:38/                                      M330:5/nil\nM329:40/                                        M328:5/s))\nM326:5/(sizeM324:1/nM322:3/(eqM320:3/(ifi320,2:35/                                   8/args))\nM318:4/(cdrM317:1/ M316:4/(carM314:1/nM312:4/(leti312,2:29/                             7/args)\nM310:4/(carM308:4/selfM306:4/(letM305:23/                       M304:6/args\nM302:7/(lambdaM300:4/hrecM298:4/(letM297:9/         M296:8/hargs)\nM294:4/(cari293,2:1/s1/ M291:4/    M290:7/hargs\nM288:7/(lambdaM287:2/  M286:11/modernize\nM284:3/XXXi283,8:1/;2/  6/PERF\n1/ 1/;2/  12/htmlescape\n1/ X
!108=M1314:7/rev))))d1294,1293:X
!106=M1608:24/analysis\n\n)))))))))))"M26:15/revert.\n\n(letd24,23:X

main.b 10 956/";;                                 -*- lisp -*-\n; This is the initial (bootstrapping) program.\n; its role is to provide a minimal wiki interface\n; that will allow us to develop compilers for\n; better languages, that we can then use to\n; overwrite this program.\n\n(let 'nil '() '\n(let 'car (lambda 'args\n            '(xcase args 'noa '(arg u\n                                   (xcase arg 'error_car_nil '(h u h))))) '\n(let 'cdr (lambda 'args\n            '(xcase args 'nob '(arg u \n                                   (xcase arg 'error_cdr_nil '(u t t))))) '\n;; emergency revert code as soon as possible...\n;; this reverts only the compiled main-go page, not any source code.\n(if (eq request.url \"/emergency-revert\")\n   '(let '_ (insert \"main-go\" (read \"main-go\" (car (cdr (history \"main-go\"))))) '\n       \"OK, reverted\")\n\n   ;; otherwise run the main-go page (nil, car, cdr already defined)\n   '(eval (head \"main-go\"))\n))))"
!6=M238:30/analysis\n\n)))))))))))))))\n"M236:4/casei235,70:6/action1/ 1/;1/ 4/))))7/       16/action!\")))\n\n1/ 9/\"unknown1/ 9/stdheader1/ 8/'(string10/          4/\n\n12/            15/it</a>?\"))))\n1/ 13/\"\\\">create1/ 10/fulltarget1/ 17/href=\\\"/edit/\"1/ 2/<a1/ 2/to1/ 4/like1/ 5/you'd1/ 9/\"Perhaps32/                                4/\"\n1/ 7/\"</b>.1/ 10/fulltarget1/ 5/<b>\"1/ 6/called1/ 6/symbol1/ 2/no1/ 2/is1/ 7/\"There1/ 7/(string24/                        5/'(_\n22/                      9/msg))))\n1/ 2/\"1/ 10/error</b>:1/ 12/\"<b>Runtime1/ 7/(string1/ 5/'(msg1/ 5/prog)1/ M233:1/ M232:8/'(handlei232,2:26/                          13/fulltarget)\nM230:5/(headM228:5/'progM226:5/'(letM224:7/(handlei224,2:14/              12/<hr/><p>\"\nM222:3/...M220:2/\"M218:10/fulltargeti217,30:2/\"1/ 12/\"<p>running14/              13/fulltarget)\n1/ 5/(tabs14/              9/stdpage\n1/ 9/stdheader14/              10/'(string\n12/            10/\"run\")\n1/ 6/action1/ 3/(eq1/ 4/'(if9/         7/loop)\n1/ 8/infinite1/ 2/(=1/ 8/main...?1/ M214:7/againsti213,4:7/protect1/ 3/XXX1/ M211:10/          M210:7/)))\n\ni210,2:13/             3/)\nM208:6/rev)))i208,70:1/ 4/(int1/ 6/target1/ 6/'(read1/ 7/target)1/ 6/'(head1/ 6/\"_\")1/ 3/rev1/ 3/(eq1/ 3/(if1/ 9/stdheader14/              9/(string\n13/             2/\n5/     1/'1/ 12/rev_target))1/ 4/(cdr1/ 4/(car1/ 7/'target1/ 4/(let12/            3/'\n1/ 11/rev_target)1/ 4/(car1/ 4/'rev1/ 4/(let12/            3/'\n1/ 2/0)1/ 10/fulltarget1/ 5/\"/\"1/ 5/token1/ 6/(token1/ 11/'rev_target1/ 5/'(let11/           10/\"raw\")\n1/ 6/action1/ 3/(eq1/ 4/'(ifi207,152:11/instance)\n1/ 3/for1/ 4/CSS,1/ 9/including1/ 3/for1/ 5/(good1/ 14/stuff/escaping1/ 6/excess1/ 2/no1/ 3/but1/ 5/view,1/ 4/like1/ 2/;;7/       20/it</a>?\")))))))\n\n1/ 13/\"\\\">create1/ 6/target1/ 17/href=\\\"/edit/\"1/ 2/<a1/ 2/to1/ 4/like1/ 5/you'd1/ 9/\"Perhaps32/                                4/\"\n1/ 7/\"</b>.1/ 6/target1/ 5/<b>\"1/ 6/called1/ 6/symbol1/ 2/no1/ 2/is1/ 7/\"There1/ 7/(string24/                        5/'(_\n22/                      16/\"</pre>\\n\")\n1/ 7/rev))))1/ 4/(int1/ 6/target1/ 6/'(read1/ 7/target)1/ 6/'(head1/ 6/\"_\")1/ 3/rev1/ 3/(eq1/ 3/(if1/ 11/(htmlescape1/ 12/\"<pre>\\n\"1/ 8/'(string1/ 7/(handle14/              12/<hr/><p>\"\n1/ 3/...1/ 2/\"1/ 5/rev))1/ 2/\"1/ 1/@1/ 2/\"1/ 8/'(string1/ 5/'\"\"1/ 6/\"_\")1/ 3/rev1/ 3/(eq1/ 3/(if1/ 6/target1/ 2/\"1/ 12/\"<p>viewing14/              9/target)\n1/ 5/(tabs14/              9/stdpage\n1/ 9/stdheader14/              9/(string\n13/             2/\n5/     1/'1/ 12/rev_target))1/ 4/(cdr1/ 4/(car1/ 7/'target1/ 4/(let12/            M204:11/rev_target)i203,32:4/(car1/ 4/'rev1/ 4/(let12/            3/'\n1/ 2/0)1/ 10/fulltarget1/ 5/\"/\"1/ 5/token1/ 6/(token1/ 11/'rev_target1/ 5/'(let11/           11/\"view\")\n1/ 6/action1/ 3/(eq1/ 4/'(if7/       18/fulltarget))))\n\n1/ M200:4/\"))i199,4:6/\"</a>1/ 5/args)1/ i198,2:54/                                                      2/\nM196:9/\"\\\">\"M194:10/fulltargetM192:5/\"/\"i191,108:5/args)1/ 4/(car1/ 17/href=\\\"/view/\"1/ 4/\"<a1/ 8/'(string1/ 5/'args1/ 7/(lambda1/ 3/map1/ 4/(map1/ 7/(string14/              15/...<hr/><p>\"\n1/ 2/\"1/ 10/fulltarget1/ 2/\"1/ 3/for1/ 12/\"<p>history14/              13/fulltarget)\n1/ 5/(tabs14/              9/stdpage\n1/ 9/stdheader14/              10/'(string\n12/            14/\"history\")\n1/ 6/action1/ 3/(eq1/ 4/'(if7/       8/save\n\n1/ 6/action1/ 1/;1/ 7/)))))))8/        15/fulltarget)))\n1/ 12/\"/view/_/\"1/ 7/(string1/ 10/'(redirect14/              8/exists\n1/ 8/compiler1/ 1/;1/ 2/))20/                    14/fulltarget))\n1/ 12/\"/view/_/\"1/ 7/(string1/ 9/(redirect20/                    10/inserted\n1/ 2/we1/ 8/revision1/ 3/the1/ 2/to1/ 8/directly1/ 4/jump1/ 6/should1/ 3/XXX1/ 2/;;20/                    3/'\n1/ 4/exe)1/ 4/base1/ i187,68:4/(let15/               12/executable\n1/ 4/save1/ 1/;15/               3/'\n1/ 7/msg))))1/ 2/\"1/ 7/because1/ 6/failed1/ 2/\"52/                                                    12/fulltarget\n1/ 2/\"1/ 2/of1/ 13/\"compilation52/                                                    9/(string\n51/                                                   8/'abort\n51/                                                   7/(list\n50/                                                  8/aborts\n1/ 4/that1/ 7/program1/ 1/a1/ 6/return1/ 1/;50/                                                  4/we\n1/ 4/then1/ 6/fails,1/ 11/compilation1/ 2/if1/ 1/;50/                                                  7/'(msg\n1/ 4/dat)1/ 9/'(compile1/ 7/(handle1/ 4/'exe1/ M185:15/               M184:9/compile\nM182:3/(ifi182,2:13/             3/'\nM180:4/dat)M178:10/fulltargetM176:7/(insertM174:2/'_M172:4/(leti172,2:12/            8/source\nM170:4/saveM168:1/;i168,2:12/            3/'\ni167,60:5/nil))1/ 3/'(_1/ 15/\":compile\")))1/ 3/ext1/ 7/(string1/ 5/(head1/ 6/'(eval1/ 7/(handle1/ 8/'compile1/ 5/'(let9/         5/any\n1/ 2/if1/ 9/compiler,1/ 3/the1/ 8/closure)1/ 1/a1/ 7/produce1/ 2/to1/ 3/run1/ 4/(and1/ 3/get1/ 1/;9/         11/prog.b.w)\n1/ 3/eg.2/  13/recursively??1/ 4/this1/ 2/do1/ 6/(might1/ 2/;;9/         9/version\n1/ i165,4:3/and1/ 6/source1/ M162:6/savingM160:8/compile,i159,44:6/should1/ 2/we1/ 9/otherwise1/ 2/;;9/         17/fulltarget)))\n\n1/ 12/\"/view/_/\"1/ 7/(string1/ 9/(redirect17/                 10/revision\n1/ 4/goto1/ 3/XXX1/ 2/;;17/                 3/'\n1/ 4/dat)1/ 10/fulltarget1/ 7/(insert1/ 2/'_1/ 5/'(let11/           7/save.\n1/ 4/just1/ 2/;;11/           6/case\n1/ M156:2/inM154:5/name.M152:6/entireM150:3/thei149,300:5/holds1/ 3/ext1/ 4/then1/ 1/.1/ 2/no1/ 3/was1/ 5/there1/ 2/if1/ 2/;;11/           7/\"\")\n1/ 4/base1/ 3/(eq1/ 3/(if7/       5/'\n\n1/ 13/form.contents1/ 4/'dat1/ 4/(let7/       3/'\n1/ 10/base_ext))1/ 4/(cdr1/ 4/(car1/ 4/'ext1/ 4/(let7/       3/'\n1/ 9/base_ext)1/ 4/(car1/ 5/'base1/ 4/(let7/       3/'\n1/ 3/1))1/ 11/fulltarget)1/ 5/(size1/ 2/(-1/ 10/fulltarget1/ 5/\".\"1/ 6/rtoken1/ 7/(rtoken1/ 9/'base_ext1/ 5/'(let6/      12/extension.\n1/ 3/the1/ 2/on1/ 5/based1/ 8/language1/ 3/the1/ 3/out1/ 6/figure1/ 1/;7/       2/\n1/ 10/compile...1/ 2/to1/ 4/need1/ 5/might1/ 1/;7/       11/\"save\")\n1/ 6/action1/ 3/(eq1/ 4/'(if4/    34/value=\\\"save\\\"></form>\"))\n\n1/ 11/type=submit1/ 8/\"<input15/               20/\"</textarea>\\n\"\n15/               10/data)\")\n1/ 12/'\"(internal19/                   12/symbol)\")\n1/ 6/\"(was1/ 3/'(_19/                   8/\")\")\n1/ 11/oldcontents1/ 2/\"1/ 3/int1/ 6/\"(was1/ 8/'(string19/                   14/oldcontents)\n1/ 12/'(htmlescape19/                   10/data)\")\n1/ 6/quoted1/ 6/\"(was1/ 3/'(_19/                   10/data)\")\n1/ 4/list1/ 6/\"(was1/ 1/_1/ 3/'(_19/                   7/'\"\"\n19/                   13/oldcontents\n1/ 6/(xcase15/               26/name=\\\"contents\\\">\"\n1/ 8/cols=1201/ 7/rows=351/ 16/\"\\\"><textarea1/ 10/fulltarget1/ 19/action=\\\"/save/\"1/ 19/method=\\\"post\\\"1/ 7/\"<form15/               16/deleted.</b>\"\n1/ 2/be1/ 4/will1/ 2/It1/ 11/permission.1/ 7/without1/ 8/websites1/ 5/other1/ 4/from1/ 4/text1/ 4/copy1/ 3/not1/ 12/\"<br/><b>Do15/               6/\"))\n1/ 3/...1/ 2/\"1/ 10/fulltarget1/ 2/\"1/ 4/page1/ 3/new1/ 10/\"creating1/ 8/'(string19/                   5/\")\n1/ 3/...1/ 2/\"1/ 10/fulltarget1/ 2/\"1/ 9/\"editing1/ 8/'(string19/                   13/oldcontents\n1/ 3/(if15/               9/\"<p>\"\n1/ 11/fulltarget)1/ 5/(tabs16/                9/stdpage\n1/ 9/stdheader1/ 7/(string8/        3/'\n1/ 5/nil))1/ 3/'(_1/ 11/fulltarget)1/ 6/'(head1/ 7/(handle1/ 12/'oldcontents1/ 5/'(let6/      10/textarea\n1/ 3/the1/ 2/in1/ 2/it1/ 3/put1/ 3/and1/ 2/;;6/      6/page\n1/ 4/this1/ 3/for1/ M146:6/sourceM144:3/theM142:5/fetchi141,716:2/to1/ 4/need1/ 2/;;6/      11/\"edit\")\n1/ 6/action1/ 3/(eq1/ 3/(if2/  5/'\n\n1/ 13/\"</div>\")))27/                           4/\"\n1/ 21/\"\\\">run</a></span>1/ 4/page1/ 16/href=\\\"/run/\"1/ 20/class=\\\"tab\\\"><a1/ 7/\"<span27/                           4/\"\n1/ 25/\"\\\">history</a></span>1/ 4/page1/ 20/href=\\\"/history/\"1/ 20/class=\\\"tab\\\"><a1/ 7/\"<span27/                           4/\"\n1/ 22/\"\\\">edit</a></span>1/ 4/page1/ 17/href=\\\"/edit/\"1/ 20/class=\\\"tab\\\"><a1/ 7/\"<span27/                           4/\"\n1/ 22/\"\\\">view</a></span>1/ 4/page1/ 19/href=\\\"/view/_/\"1/ 20/class=\\\"tab\\\"><a1/ 7/\"<span27/                           23/class=\\\"tabs\\\">\"\n1/ 6/\"<div1/ 7/(string19/                   6/tabs\n1/ 4/make1/ 3/XXX1/ 1/;19/                   3/'\n1/ 5/args)1/ 4/(car1/ 5/'page1/ 5/'(let13/             7/'args\n1/ 7/(lambda1/ 5/'tabs1/ 6/\n(let2/  3/'\n1/ 15/action_target))1/ 4/(cdr1/ 4/(car1/ 11/'fulltarget1/ 7/'\n(let1/ 14/action_target)1/ 4/(car1/ 7/'action1/ 7/'\n(let1/ 2/0)1/ 3/url1/ 5/\"/\"1/ 5/token1/ 6/(token1/ 14/'action_target1/ 7/'\n(let1/ 4/0)))1/ 11/request.url1/ 5/\"/\"1/ 5/token1/ 6/(token1/ 4/(cdr1/ 4/(car1/ 4/'url1/ 11/char)\n(let1/ 1//1/ 8/starting1/ 3/the1/ 3/off1/ 5/(toss1/ 1/;2/  5/URL\n1/ 3/the1/ 2/on1/ 5/based1/ 5/doing1/ 5/we're1/ 4/what1/ 3/out1/ 6/figure1/ 1/;2/  5/'\n\n1/ 7/0))))))1/ 4/hrec1/ 5/(hrec1/ 6/string1/ 5/(cons1/ 6/'(eval15/               11/1))))))))\n1/ 1/n1/ 2/(+1/ 4/self1/ 5/(self46/                                              8/'ch)))\n54/                                                      12/'\"&amp;\"\n56/                                                        8/\"&\")\n1/ 2/ch1/ 3/(eq1/ 4/'(if51/                                                   11/'\"&gt;\"\n53/                                                     8/\">\")\n1/ 2/ch1/ 3/(eq1/ 4/'(if48/                                                11/'\"&lt;\"\n50/                                                  8/\"<\")\n1/ 2/ch1/ 3/(eq1/ 3/(if46/                                              8/'(cons\n44/                                            4/n)\n1/ 1/s1/ 4/(sub1/ 3/'ch1/ 5/'(let38/                                      6/'nil\n40/                                        5/s))\n1/ 5/(size1/ 1/n1/ 3/(eq1/ 4/'(if35/                                   8/args))\n1/ 4/(cdr1/ 4/(car1/ 2/'n1/ 5/'(let29/                             7/args)\n1/ 4/(car1/ 5/'self1/ 5/'(let23/                       7/'args\n1/ 7/(lambda1/ 5/'hrec1/ 5/'(let9/         8/hargs)\n1/ 4/(car1/ 2/'s1/ 5/'(let4/    8/'hargs\n1/ 7/(lambda2/  6/PERF\n1/ 1/;2/  13/'htmlescape\n1/ 9/'\n\n(let1/ 7/)))))))37/                                     6/1)))\n1/ 1/n1/ 2/(-1/ 1/s1/ 3/sep1/ 4/self1/ 6/'(self42/                                          7/1))))\n1/ 1/n1/ 2/(+1/ 2/s)1/ 5/(size1/ 2/(-1/ 2/1)1/ 1/n1/ 2/(+1/ 1/s1/ 7/(substr1/ 2/n)1/ 1/01/ 1/s1/ 7/(substr1/ 6/'(list42/                                          6/sep)\n1/ 2/ch1/ 3/(eq1/ 4/'(if37/                                     4/n)\n1/ 1/s1/ 4/(sub1/ 3/'ch1/ 5/'(let31/                               4/s)\n1/ 4/\"\"1/ 6/'(list1/ 3/1))1/ 1/01/ 2/(-1/ 1/n1/ 3/(eq1/ 4/'(if28/                            10/args))))\n1/ 4/(cdr1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'n1/ 5/'(let22/                      9/args)))\n1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'s1/ 5/'(let16/                8/args))\n1/ 4/(cdr1/ 4/(car1/ 4/'sep1/ 5/'(let10/          7/args)\n1/ 4/(car1/ 5/'self1/ 5/'(let4/    7/'args\n1/ 7/(lambda2/  9/'rtoken\n1/ 6/\n(let21/                     8/instance1/ 4/last1/ 3/but1/ 5/same,1/ 6/'\n\n;1/ 7/)))))))37/                                     6/1)))\n1/ 1/n1/ 2/(+1/ 1/s1/ 3/sep1/ 4/self1/ 6/'(self42/                                          7/1))))\n1/ 1/n1/ 2/(+1/ 2/s)1/ 5/(size1/ 2/(-1/ 2/1)1/ 1/n1/ 2/(+1/ 1/s1/ 7/(substr1/ 2/n)1/ 1/01/ 1/s1/ 7/(substr1/ 6/'(list42/                                          6/sep)\n1/ 2/ch1/ 3/(eq1/ 4/'(if37/                                     4/n)\n1/ 1/s1/ 4/(sub1/ 3/'ch1/ 5/'(let31/                               7/\"\")\n1/ 1/s1/ 6/'(list1/ 3/s))1/ 5/(size1/ 1/n1/ 3/(eq1/ 4/'(if28/                            10/args))))\n1/ 4/(cdr1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'n1/ 5/'(let22/                      9/args)))\n1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'s1/ 5/'(let16/                8/args))\n1/ 4/(cdr1/ 4/(car1/ 4/'sep1/ 5/'(let10/          7/args)\n1/ 4/(car1/ 5/'self1/ 5/'(let4/    7/'args\n1/ 7/(lambda2/  8/'token\n1/ 11/given\n(let1/ 4/char1/ 3/the1/ 2/of1/ 8/instance1/ 5/first1/ 3/the1/ 2/to1/ 2/up1/ 4/chop1/ 6/'\n\n;1/ 9/'nil)))))25/                         6/l)))\n1/ 4/(cdr1/ 1/f1/ 4/self1/ 5/(self1/ 3/l))1/ 4/(car1/ 2/(f1/ 6/'(cons27/                           3/l\n1/ 4/'(if22/                      9/args)))\n1/ 4/(cdr1/ 4/(cdr1/ 4/(car1/ 2/'l1/ 5/'(let16/                8/args))\n1/ 4/(cdr1/ 4/(car1/ 2/'f1/ 5/'(let10/          7/args)\n1/ 4/(car1/ 5/'self1/ 5/'(let4/    7/'args\n1/ 7/(lambda2/  2/\n1/ 4/'map1/ 11/'\n\n\n(let1/ 18/\"\\r\\n\\r\\n\"))1/ 7/target)1/ 4/(car1/ 2/\"1/ 11/\"Location:1/ 8/'(string1/ 7/'target1/ 7/(lambda1/ 9/'redirect1/ 7/'\n(let1/ 42/title=\\\"polybook\\\"/></head><body>\\n\"1/ 32/href=\\\"/raw/_/polybook.css\\\"1/ 21/type=\\\"text/css\\\"1/ 14/rel=stylesheet1/ 19/\"<html><head><link1/ 8/'stdpage1/ 7/'\n(let1/ 27/charset=utf-8\\r\\n\\r\\n\"1/ 10/text/html;1/ 15/\"Content-Type:1/ 10/'stdheader1/ 7/'\n(let1/ X
!3=M708:10/char\n(letX

polybook.css 116 542/"       .tabs { border-bottom : 1px solid #000000 ; padding-left : 8px ; }\n       .tab { font : 12px Verdana,Arial,Helvetica ; padding : 2px 4px 1px 4px ; margin-left : 2px ; margin-right : 6px ; border-top : 1px solid #333333 ; border-left : 1px solid #111111 ; border-right : 1px solid #000000 ; background: #FFFFFF ;}\n\n       A:link { color: #4444DD }\n       A:visited { color: #9999FF }\n       A:active { color: #DDDD44 }\n\n       BODY { font : 12px Verdana,Arial,Helvetica ; }\n       P { font : 12px Verdana,Arial,Helvetica ; }\n"
!115=M68:3/7pxd60,53:d22,15:X
!114=M42:3/0pxX
!113=M76:7/#000000M64:7/#000000M52:3/4pxM42:4/20pxX
!112=M42:3/2pxX
!5=M96:5/}\n\nd94,91:M44:3/2pxM42:3/4pxM28:4/11pxX

test 102 660/(let 'car (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(l fnarg_ (xcase l '(abort "car nil") '(h _ h))))) '(let 'cdr (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(l fnarg_ (xcase l '(abort "cdr nil") '(_ t t))))) '(let 'map (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(self fnarg_ (xcase fnarg_ 'noarg '(f fnarg_ (xcase fnarg_ 'noarg '(l fnarg_ (xcase l ''() '(h t (cons (f h) (self self f t))))))))))) '(let 'map (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(f fnarg_ (xcase fnarg_ 'noarg '(l fnarg_ (map map f l)))))) '(xcase (list 70 3) 'no-nil '(h t (let 'plus (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(x fnarg_ (xcase fnarg_ 'noarg '(y fnarg_ (+ x y)))))) '(plus h (car t)))))))))
!98=M220:6/300)))M218:3/200M216:3/100d214,169:M166:6/'(tcard164,33:M24:5/"tcarM2:5/'tcarX
!94=M28:2/(hM22:6/(abortX
!92=M42:10/t)))))))))M40:4/(carM38:1/hi37,46:6/'(plus1/ 7/y))))))1/ 1/x1/ 2/(+1/ 6/fnarg_1/ 3/'(y1/ 6/'noarg1/ 6/fnarg_1/ 6/(xcase1/ 6/fnarg_1/ 3/'(x1/ 6/'noarg1/ 6/fnarg_1/ 7/'(xcase1/ 7/'fnarg_1/ 7/(lambda1/ 5/'plus1/ 4/(let1/ 1/t1/ 3/'(h1/ 7/'no-nil1/ 2/3)1/ 2/701/ M34:7/'(xcasei33,132:7/l))))))1/ 1/f1/ 3/map1/ 4/(map1/ 6/fnarg_1/ 3/'(l1/ 6/'noarg1/ 6/fnarg_1/ 6/(xcase1/ 6/fnarg_1/ 3/'(f1/ 6/'noarg1/ 6/fnarg_1/ 7/'(xcase1/ 7/'fnarg_1/ 7/(lambda1/ 4/'map1/ 5/'(let1/ 12/t)))))))))))1/ 1/f1/ 4/self1/ 5/(self1/ 2/h)1/ 2/(f1/ 5/(cons1/ 1/t1/ 2/(h1/ 3/nil1/ 1/l1/ 6/(xcase1/ 6/fnarg_1/ 3/'(l1/ 6/'noarg1/ 6/fnarg_1/ 6/(xcase1/ 6/fnarg_1/ 3/'(f1/ 6/'noarg1/ 6/fnarg_1/ 6/(xcase1/ 6/fnarg_1/ 6/'(self1/ 6/'noarg1/ 6/fnarg_1/ 7/'(xcase1/ 7/'fnarg_1/ 7/(lambda1/ 4/'map1/ 5/'(let1/ 6/t)))))1/ 1/t1/ 2/(_1/ 5/nil")1/ 4/"cdr1/ 6/(abort1/ 1/l1/ 6/(xcase1/ 6/fnarg_1/ 3/'(l1/ 6/'noarg1/ 6/fnarg_1/ 7/'(xcase1/ 7/'fnarg_1/ 7/(lambda1/ 4/'cdr1/ 5/'(let1/ M24:4/"carM2:4/'carX
!73=M220:5/3))))d218,217:M178:1/_M172:3/70)d170,169:d166,149:d147,0:X
!71=M50:5/t))))M10:1/tM4:2/3)i3,2:2/701/ X
!62=M52:3/2))M50:2/40d13,0:X
!60=M38:9/z))))))))M36:1/yM34:1/xM32:2/(+M30:6/fnarg_M28:3/'(zi27,2:6/'noarg1/ i25,4:6/(xcase1/ 6/fnarg_1/ d3,0:X
!55=M40:6/lambdad39,0:X
!52=M0:12/"Failure!"))i0,10:1/ 9/'(reverse1/ 7/world!"1/ 8/'"Hello,1/ 1/x1/ 3/(ifX
!47=X
!45=M10:1/0d9,0:X

test.b 54 8/"lambda"

test.w 101 383/";; just a test -- this can't run due to undefined symbols!\n\n; (let tcar (fn (l) (xcase l (abort \"tcar nil\") (h _ h)))\n;   (tcar (list 100 200 300))\n; )\n\n\n(include \"stdlib\"\n (xcase (list 70 3)\n    no-nil\n    (h t (let plus (fn (x y) (+ x y))\n          (plus h (car t)))))\n)\n\n; (fn (x y z) (+ x y z))\n\n; (if x\n;   \"Hello, world!\"\n;   (reverse \"Failure!\"))\n"
!97=M98:15/t)))))\n;)\n\n;M90:6/y))\n;M70:9/no-nil\n;M68:5/3)\n;M60:13/\"stdlib\"\n;M58:23/300))\n)\n\n\n;(included56,55:M47:2/  M46:6/h)))\nM24:16/symbols!\n\n(letd22,21:X
!93=X
!91=M94:14/t)))))\n)\n\n;M86:5/y))\nM66:8/no-nil\nM64:4/3)\nM56:12/\"stdlib\"\nM54:20/symbols!\n\n(included52,21:X
!82=X
!72=M62:10/3))))\n\n;d60,59:M55:9/         M38:1/_M35:3/   M33:3/   M32:5/70)\nd30,29:M26:18/symbols!\n\n(xcased24,21:X
!70=M54:10/t))))\n\n;M32:1/tM26:4/3)\ni25,2:2/701/ X
!69=M51:10/          M32:3/'(hM30:9/'no-nil\nX
!66=X
!65=M56:9/t)))\n\n;X
!61=M56:8/2))\n\n;M54:2/40M51:2/  M36:16/symbols!\n\n(letd34,21:X
!59=M44:15/symbols!\n\n(fnd42,21:X
!56=X
!53=X
!51=M44:10/world!\"\nM40:3/x\nM36:12/symbols!\n\nd34,21:X
!46=X
!44=M30:11/world!\"\n;M26:4/x\n;M22:15/first\n\n0\n\n;i21,10:4/test1/ 7/simpler1/ 1/a1/ 7/perhaps1/ 14/symbols!\n\n;;1/ X
!41=X
!38=X
!37=X
!34=X
!31=X
!28=X
!25=X
!24=M41:2/  M40:10/world!\"\nM37:2/  M36:3/x\nM34:15/symbols!\n\n(ifd32,21:M0:5/"\n;;X

w%3Acompile 105 2467/(let 'nil '() '(let 'car (lambda 'args '(xcase args 'noa '(arg u (xcase arg 'werr_car_nil '(h u h))))) '(let 'cdr (lambda 'args '(xcase args 'nob '(arg u (xcase arg 'werr_cdr_nil '(u t t))))) '(lambda 'args '(let 'prog (parse (car args)) '(let 'map (lambda 'args '(let 'self (car args) '(let 'f (car (cdr args)) '(let 'l (car (cdr (cdr args))) '(if l '(cons (f (car l)) (self self f (cdr l))) 'nil))))) '(let 'nth (lambda 'args '(let 'self (car args) '(let 'n (car (cdr args)) '(let 'l (car (cdr (cdr args))) '(if (eq n 0) '(car l) '(nth nth (- n 1) (cdr l))))))) '(let 'translate (lambda 'args '(let 'self (car args) '(let 'exp (car (cdr args)) '(xcase exp 'exp '(h t (xcase h 'no 'no 'no 'no 'no '(theprim (if (eq theprim "defs") '(map map (lambda 'd_args '(let 'd_arg (car d_args) '(list (car d_arg) (self self (car (cdr d_arg)))))) t) '(if (eq theprim "include") '(let 'lib (head (string "w:" (car t))) '(let 'bod (self self (car (cdr t))) '(let 'bindlib (lambda 'bl_args '(let 'bl_self (car bl_args) '(let 'l (car (cdr bl_args)) '(xcase l 'bod '(thedef rest (list (parse "let") (quote (car thedef)) (car (cdr thedef)) (quote (bl_self bl_self rest)))))))) '(bindlib bindlib lib)))) '(if (eq theprim "lambda") '(cons h (cons (quote (self self (car t))) (cons (quote (self self (car (cdr t)))) nil))) '(if (eq theprim "if") '(list h (self self (car t)) (quote (self self (car (cdr t)))) (quote (self self (car (cdr (cdr t)))))) '(if (eq theprim "handle") '(list h (quote (self self (car t))) (quote (self self (car (cdr t))))) '(if (eq theprim "let") '(list h (quote (car t)) (self self (car (cdr t))) (quote (self self (car (cdr (cdr t)))))) '(if (eq theprim "fn") '(let 'argname "fnarg_" '(let 'genargs (lambda 'ga_args '(let 'ga_self (car ga_args) '(let 'l (car (cdr ga_args)) '(let 'bod (car (cdr (cdr ga_args))) '(xcase l '(self self bod) '(thisarg rest (list (parse "xcase") (parse argname) (quote (parse "noarg")) (quote (list thisarg (parse argname) (ga_self ga_self rest bod)))))))))) '(list (parse "lambda") (quote (parse argname)) (quote (genargs genargs (car t) (car (cdr t))))))) '(if (eq theprim "xcase") '(xcase t '(abort "no args to xcase?") '(ob cases (cons h (cons (self self ob) (map map (lambda 'args '(quote (self self (car args)))) cases))))) '(cons h (map map (lambda 'args '(self self (car args))) t))))))))))))) '(q (abort "quote not allowed in W")) 'exp 'exp '(s (if (eq s "nil") '(quote nil) 'exp)))))) '(translate translate prog)))))))))
!96=M772:13/t))))))))))))d522,489:X
!88=M592:4/'bodd590,587:X
!85=M274:4/(letX
!81=M734:12/t)))))))))))d300,259:X
!68=M692:11/t))))))))))d362,259:X
!64=M566:4/t)))M536:6/'(consd534,517:X
!58=i549,12:5/t))))1/ 1/61/ 4/(nth1/ 4/self1/ 5/(self1/ 6/(quote1/ M546:1/5M544:4/(nthM538:6/(quoteM536:4/t)))M534:1/4M532:4/(nthM530:4/selfM528:5/(selfi527,8:6/(quote1/ 4/t)))1/ 1/31/ 4/(nth1/ M522:6/(quotei521,30:4/t)))1/ 1/21/ 4/(nth1/ 4/self1/ 5/(self1/ 6/(quote1/ 4/t)))1/ 1/11/ 4/(nth1/ 4/self1/ 5/(self1/ 6/(quote1/ 3/ob)1/ 4/self1/ 5/(self1/ M518:6/'(listX
!50=M468:8/thisarg)i467,2:6/(parse1/ X
!43=M622:10/t)))))))))d510,385:X
!40=M536:11/100))))))))d534,531:M150:4/(letM78:7/"uhhh")M76:6/(abortM74:2/'_d72,71:X
!36=M76:3/999d74,73:X
!33=M58:14/'error_cdr_nilM28:14/'error_car_nilX
!30=M528:12/prog))))))))M74:6/args))M72:4/(cari71,4:6/(parse1/ 5/'prog1/ X
!27=M532:13/prog)))))))))i531,4:9/translate1/ 11/'(translate1/ X
!23=d78,65:M0:5/'(leti0,14:1/ 6/args))1/ 4/(car1/ 6/(parse1/ 5/'prog1/ 5/'(let1/ 5/'args1/ 7/(lambdaX

w%3Acompile.b 104 8521/";                           -*- lisp -*-\n; compiler from W to B, written in B\n\n; this \"compiler\" is mostly just desugaring: the\n; B language supports most of the features we\n; need. (and they both use the same abstract syntax).\n\n; features to implement:\n; progn (not needed yet)\n; let auto-quoting    (DONE)\n; if auto-quoting     (DONE)\n; lambda auto-quoting (DONE)\n; implement nil       (DONE)\n; xcase auto-quoting  (DONE)\n; fn construct        (DONE)\n; include construct   (DONE)\n; handle auto-quoting (DONE)\n\n; actually I guess we should completely eliminate quote?\n; if we see quote in the source program we pretty much\n; don't have any idea if what's under that will ever be\n; evaluated, so we don't know how we're supposed to translate\n; it.\n; better to think of W as being a call-by-name ML-like\n; language.\n\n(let 'nil '() '\n(let 'car (lambda 'args\n            '(xcase args 'noa '(arg u\n                                   (xcase arg 'werr_car_nil '(h u h))))) '\n(let 'cdr (lambda 'args\n            '(xcase args 'nob '(arg u \n                                   (xcase arg 'werr_cdr_nil '(u t t))))) '\n\n(lambda 'args '\n(let 'prog (parse (car args)) '\n; (let '_ 999 '\n\n(let 'map \n  (lambda 'args\n    '(let 'self (car args)\n          '(let 'f (car (cdr args))\n                '(let 'l (car (cdr (cdr args)))\n                      '(if l\n                           '(cons (f (car l)) (self self f (cdr l)))\n                         'nil))))) '\n\n;; (let 'map (lambda 'args (map (cons map args))) '\n\n(let 'nth\n  (lambda 'args\n   '(let 'self (car args) '\n      (let 'n (car (cdr args)) '\n        (let 'l (car (cdr (cdr args))) '\n          (if (eq n 0)\n              '(car l)\n            '(nth nth (- n 1) (cdr l))))))) '\n\n;;(let 'nth (lambda 'args (nth (cons nth args))) '\n\n(let 'translate\n  (lambda 'args '\n    (let 'self (car args) '\n      (let 'exp (car (cdr args)) '\n           ; what kind of expression is it?\n           (xcase exp\n             'exp ; empty list\n             '(h t  ; nonempty list\n                    ; need to case analyze which prim this is\n                    ; in essence \n                 \n                 (xcase h\n                        ; it has to be a symbol, or something's wrong\n                        'no 'no 'no 'no 'no\n                        '(theprim \n                         (if (eq theprim \"defs\") '\n                            ; t: list of pairs\n                            (map map (lambda 'd_args '\n                                       (let 'd_arg (car d_args) '\n                                         (list (car d_arg) (self self (car (cdr d_arg))))\n                                        )\n                                        ) t) '\n                         (if (eq theprim \"include\") '\n                            ; t: \"page\" body\n                            (let 'lib (head (string \"w:\" (car t))) '\n                            (let 'bod (self self (car (cdr t))) '\n                            (let 'bindlib (lambda 'bl_args '\n                                          (let 'bl_self (car bl_args) '\n                                          (let 'l (car (cdr bl_args)) '\n                                          (xcase l\n                                            'bod ;; no more bindings...\n                                            '(thedef rest\n                                               (list (parse \"let\")\n                                                     (quote (car thedef))\n                                                     (car (cdr thedef))\n                                                     (quote (bl_self bl_self rest))\n                                                )\n                                           ))))) '\n                               (bindlib bindlib lib)\n                             ))) '\n\n                         (if (eq theprim \"lambda\") '\n                             ; t: arg body\n                             (cons h\n                                   (cons (quote (self self (car t)))\n                                         (cons (quote (self self (car (cdr t))))\n                                               nil))) '\n                         (if (eq theprim \"if\") '\n                             ; t: cond tbod fbod\n                             (list h (self self (car t))\n                                     (quote (self self (car (cdr t))))\n                                     (quote (self self (car (cdr (cdr t)))))) '\n\n                         (if (eq theprim \"handle\") '\n                             ; t: try catch\n                             (list h (quote (self self (car t)))\n                                     (quote (self self (car (cdr t))))) '\n\n                         (if (eq theprim \"let\") '\n                             ; t: sym value body\n                             (list h (quote (car t))\n                                     (self self (car (cdr t)))\n                                     (quote (self self (car (cdr (cdr t)))))) '\n\n                         ;; (fn (arg1 arg2 ... argn) body)\n                         (if (eq theprim \"fn\") '\n                             ; t args body\n                             ; XXX need gensym\n                             (let 'argname \"fnarg_\" '\n                               (let 'genargs\n                                 (lambda 'ga_args '\n                                   (let 'ga_self (car ga_args) '\n                                   (let 'l (car (cdr ga_args)) '\n                                   (let 'bod (car (cdr (cdr ga_args))) '\n                                   (xcase l\n                                    ; no more args...\n                                    '(self self bod)\n                                    ; one arg ...\n                                    '(thisarg rest\n                                      (list (parse \"xcase\")\n                                         ; argument tail always rebound as the same thing (argname)\n                                         (parse argname)\n                                         ; no more actual args? oops!\n                                         (quote (parse \"noarg\")) ;; XXX abort?\n                                         ; otherwise, bind this arg and recurse\n                                         (quote (list thisarg (parse argname) (ga_self ga_self rest bod))))\n                                      )\n                                     ) ; xcase on remaining arguments\n                                    ))) ; lets\n                                  ) '\n\n                                ; XXX could use 'symbol' constructor\n                               (list (parse \"lambda\")\n                                     (quote (parse argname))\n                                     ;; bind args and then exec body...\n                                     (quote (genargs genargs (car t) (car (cdr t))))))) '\n\n                         (if (eq theprim \"xcase\") '\n                             ; t: ob nb lb qb sb ib yb\n                             (xcase t\n                                  '(abort \"no args to xcase?\")\n                                  '(ob cases\n                                    (cons h (cons (self self ob)\n                                      ;; quotes all arguments; allows any number of them\n                                      (map map (lambda 'args '(quote (self self (car args)))) cases))))) '\n\n                           ;; otherwise, assume it is eager...\n                           (cons h\n                                 (map map (lambda 'args '(self self (car args))) t))\n                         )))))))))) ; case analysis of prim\n                 ) ; nonempty list\n\n              '(q (abort \"quote not allowed in W\"))\n\n              'exp ; string\n              'exp ; int\n              '(s \n                ; some symbols we'll macro-expand\n                (if (eq s \"nil\") '\n                    (quote nil) '\n\n                  ; the rest we'll leave alone...\n                  ; could fail on prims that we macro-expand\n                  ; (let, if, lambda, xcase)\n                  ; because those cannot be used in a higher-order\n                  ; way now..\n                  exp))\n               ))))\n\n  ;; then translate it.\n  '(translate translate prog)\n  ;; 100\n\n)))))\n)))"
!103=M976:5/t))\nX
!95=M1470:9/)))))))))M990:2/\nM989:35/                                   d988,955:d952,943:d131,126:X
!87=M1108:6/'bod\nd1107,1104:X
!84=M650:9/'d_args\nd648,647:X
!80=M1414:8/))))))))d682,621:X
!79=M750:4/))))X
!78=M1362:9/)))))))\nd1361,1352:X
!67=d762,621:d125,120:X
!63=M1166:4/t)))d1117,1100:X
!57=i1149,6:1/)37/                                     4/yb\n1/ 1/;1/ M1146:1/6M1144:4/(nthM1138:6/(quotei1138,2:37/                                     4/ib\nM1136:1/;M1134:4/t)))M1132:1/5M1130:4/(nthM1129:1/ M1128:4/selfM1126:5/(selfM1124:6/(quotei1124,2:37/                                     4/sb\nM1122:1/;M1120:4/t)))M1118:1/4i1117,64:4/(nth1/ 4/self1/ 5/(self1/ 6/(quote37/                                     4/qb\n1/ 1/;1/ 4/t)))1/ 1/31/ 4/(nth1/ 4/self1/ 5/(self1/ 6/(quote37/                                     4/lb\n1/ 1/;1/ 4/t)))1/ 1/21/ 4/(nth1/ 4/self1/ 5/(self1/ 6/(quote37/                                     4/nb\n1/ 1/;1/ 4/t)))1/ 1/11/ 4/(nth1/ 4/self1/ 5/(self1/ 6/(quote37/                                     9/present\n1/ 2/be1/ 2/to1/ 5/cases1/ M1114:7/requirei1113,4:9/shouldn't1/ 3/XXX1/ M1111:35/                                   d1104,1103:M1100:5/(listd119,114:X
!49=M972:8/thisarg)i971,2:6/(parse1/ X
!48=M1406:20/100\n\n)))))\n)))\n"M1387:7/       M1386:9/exp))\n\tM1385:2/  M1384:11/now..\n\t\tM1379:2/  M1378:18/higher-order\n\t\tM1361:2/  M1360:12/xcase)\n\t\tM1351:2/  M1350:18/macro-expand\n\t\tM1335:2/  M1334:14/alone...\n\t\tM1323:2/  M1322:9/'\n\n\t\tM1317:4/    M1316:7/'\n\t\tM1308:21/macro-expand\n\t\t(ifd1307,1306:M1298:7/\n\t\t;d1297,1296:M1293:6/      M1292:7/int\n\tM1287:6/      M1286:10/string\n\tM1281:6/      M1280:11/W\"))\n\n\tM1267:6/      M1266:10/list\n\n\tM1259:1/ M1258:12/))))))\n\t\tM1257:1/ M1256:11/t))\n\t\t\tM1239:1/ M1238:11/h\n\t\t\t\tM1235:3/   M1234:16/eager...\n\t\t\tM1223:3/   M1222:11/'\n\n\t\t\tM1219:5/     M1218:12/yb\n\t\t\t\tM1203:5/     M1202:12/ib\n\t\t\t\tM1187:5/     M1186:12/sb\n\t\t\t\tM1171:5/     M1170:12/qb\n\t\t\t\tM1155:5/     M1154:12/lb\n\t\t\t\tM1139:5/     M1138:12/nb\n\t\t\t\tM1123:5/     M1122:17/present\n\t\t\t\tM1105:3/   M1104:13/ob)\n\t\t\t\tM1095:5/     M1094:10/yb\n\t\t\tM1077:5/     M1076:9/'\n\t\t\td1067,1066:M1064:12/\n\n\n\t\t\tM1062:5/HERE!M1060:7/EDITINGM1058:7/STOPPEDM1057:39/                                       M1056:9/args...\nd1054,1039:M1035:34/                                  M1034:10/argname)\nd1031,1030:M763:5/     M762:14/t)))\n\t\t\t\tM753:5/     M752:13/t))\n\t\t\t\tM743:5/     M742:12/body\n\t\t\tM733:5/     M732:9/'\n\t\t\tM723:1/ M722:8/\n\t\t\tM721:3/   M720:11/'\n\t\t\t\tM705:5/     M704:15/t))))\n\t\t\t\tM693:5/     M692:13/t))\n\t\t\t\tM681:5/     M680:12/fbod\n\t\t\tM671:5/     M670:9/'\n\t\t\tM661:1/ M660:9/'\n\t\t\tM657:7/       M656:17/t))))\n\t\t\t\t\tM643:1/ M642:16/t)))\n\t\t\t\t\tM631:3/   M630:11/h\n\t\t\t\tM627:5/     M626:12/body\n\t\t\tM619:5/     M618:9/'\n\t\t\tM609:1/ M608:8/\n\t\t\tM606:20/'no\n\t\t\t'(theprimd605,604:M596:16/wrong\n\t\t\t'nod595,594:M576:10/h\n\t\t\t;d575,574:M571:1/ M570:6/\n\t\tM569:1/ M568:6/\n\t\tM561:12/            M560:6/is\n\tM543:12/            M542:8/list\n\tM533:5/     M532:8/list\n\tM525:5/     M524:7/exp\n\tM521:3/   M520:7/it?\n\tM507:3/   M506:5/'\n\tM445:4/    M444:6/l)\n\tM441:6/      M440:6/0)\n\tM433:2/  M432:5/'\n\tM420:9/'\n\t(letd419,418:X
!42=M1038:11/'\n\n\t\t\td1036,769:M22:6/W\n\n;X
!39=M1105:3/   d1104,1103:i1098,2:1/ 1/;M398:4/(letM397:4/    M306:9/\"uhhh\")M304:6/(abortM302:2/'_M300:7/'\n(letM290:4/(leti289,2:4/'\n;1/ X
!35=M308:3/999d306,305:X
!32=M278:14/'error_cdr_nilM246:14/'error_car_nilX
!29=M1106:21/prog\n\n)))))\n)))\n"d306,301:M292:7/'\n(letd290,289:X
!26=M1098:22/prog)\n\n)))))\n)))\n"d1097,1096:d1091,1090:X
!22=d298,285:M218:9/'\n\n(leti217,14:6/args))1/ 4/(car1/ 6/(parse1/ 5/'prog1/ 7/'\n(let1/ 5/'args1/ 20/language.\n\n(lambda1/ X

w%3Astdlib 100 479/((car (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(l fnarg_ (xcase l '(abort "car nil") '(h _ h)))))) (cdr (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(l fnarg_ (xcase l '(abort "cdr nil") '(_ t t)))))) (map (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(self fnarg_ (xcase fnarg_ 'noarg '(f fnarg_ (xcase fnarg_ 'noarg '(l fnarg_ (xcase l ''() '(h t (cons (f h) (self self f t)))))))))))) (map (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(f fnarg_ (xcase fnarg_ 'noarg '(l fnarg_ (map map f l))))))))
!90=M106:2/(hM104:3/nilM58:2/(_M52:6/(abortM26:2/(hM20:6/(abortX
!77=M0:4/(cari0,2:1/ 5/(listX

w%3Astdlib.w 99 363/";; standard library for W.\n;; It is a list of symbols and the expressions that they define.\n\n(defs\n\n(car (fn (l) (xcase l (abort \"car nil\") (h _ h))))\n(cdr (fn (l) (xcase l (abort \"cdr nil\") (_ t t))))\n\n; Should provide generic Y combinator\n(map (fn (self f l) (xcase l nil (h t (cons (f h) (self self f t))))))\n(map (fn (f l) (map map f l)))\n\n)"
!89=X
!86=X
!83=M32:20/define.\n\n(\n\n(carX
!76=M32:24/define.\n\n(list\n\n(carX
!75=M32:18/define.\n\n(\n(carX
!74=M72:9/t)))\n\n;M52:10/h)))\n(cdrX

