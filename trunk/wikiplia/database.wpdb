WPDB
62
b%3Acompile 2 51/(##CLOSURE## () "s" (parse (xcase s 'no '(h _ h))))

b%3Acompile.b 1 115/";; b \"compiler\" is trivial -- it's just the built-in XESP parser\n(lambda 's '(parse (xcase s 'no '(h _ h))))\n"

main 11 358/(let 'nil '() '(let 'car (lambda 'args '(xcase args 'noa '(arg u (xcase arg 'error_car_nil '(h u h))))) '(let 'cdr (lambda 'args '(xcase args 'nob '(arg u (xcase arg 'error_cdr_nil '(u t t))))) '(if (eq request.url "/emergency-revert") '(let '_ (insert "main-go" (read "main-go" (car (cdr (history "main-go"))))) '"OK, reverted") '(eval (head "main-go"))))))
!7=M102:30/action!"))))))))))))))))))))))M100:8/"unknownI99:9/stdheaderI99:1/ I99:8/'(stringI99:1/ I99:12/it</a>?"))))I99:1/ I99:10/"\">createI99:1/ I99:10/fulltargetI99:1/ I99:14/href=\"/edit/"I99:1/ I99:2/<aI99:1/ I99:2/toI99:1/ I99:4/likeI99:1/ I99:5/you'dI99:1/ I99:8/"PerhapsI99:1/ I99:1/"I99:1/ I99:6/"</b>.I99:1/ I99:10/fulltargetI99:1/ I99:4/<b>"I99:1/ I99:6/calledI99:1/ I99:6/symbolI99:1/ I99:2/noI99:1/ I99:2/isI99:1/ I99:6/"ThereI99:1/ I99:7/(stringI99:1/ I99:3/'(_I99:1/ I99:7/msg))))I99:1/ I99:1/"I99:1/ I99:10/error</b>:I99:1/ I99:11/"<b>RuntimeI99:1/ I99:7/(stringI99:1/ I99:5/'(msgI99:1/ I99:5/prog)I99:1/ M96:8/'(handleM94:11/fulltarget)M92:5/(headI91:5/'progI91:1/ I91:5/'(letI91:1/ I91:7/(handleI91:1/ I91:9/<hr/><p>"I91:1/ I91:3/...I91:1/ I91:1/"I91:1/ I91:10/fulltargetI91:1/ I91:1/"I91:1/ I91:11/"<p>runningI91:1/ I91:11/fulltarget)I91:1/ I91:5/(tabsI91:1/ I91:7/stdpageI91:1/ I91:9/stdheaderI91:1/ I91:8/'(stringI91:1/ I91:6/"run")I91:1/ I91:6/actionI91:1/ I91:3/(eqI91:1/ I91:4/'(ifI91:1/ I91:10/rev)))))))I91:1/ I91:4/(intI91:1/ I91:6/targetI91:1/ I91:6/'(readI91:1/ I91:7/target)I91:1/ I91:6/'(headI91:1/ I91:4/"_")I91:1/ I91:3/revI91:1/ I91:3/(eqI91:1/ I91:3/(ifI91:1/ I91:9/stdheaderI91:1/ I91:8/'(stringI91:1/ I91:12/rev_target))I91:1/ I91:4/(cdrI91:1/ I91:4/(carI91:1/ I91:7/'targetI91:1/ I91:5/'(letI91:1/ I91:11/rev_target)I91:1/ I91:4/(carI91:1/ I91:4/'revI91:1/ I91:5/'(letI91:1/ I91:2/0)I91:1/ I91:10/fulltargetI91:1/ I91:3/"/"I91:1/ I91:5/tokenI91:1/ I91:6/(tokenI91:1/ I91:11/'rev_targetI91:1/ I91:5/'(letI91:1/ I91:6/"raw")I91:1/ I91:6/actionI91:1/ I91:3/(eqI91:1/ I91:4/'(ifI91:1/ I91:15/it</a>?")))))))I91:1/ I91:10/"\">createI91:1/ I91:6/targetI91:1/ I91:14/href=\"/edit/"I91:1/ I91:2/<aI91:1/ I91:2/toI91:1/ I91:4/likeI91:1/ I91:5/you'dI91:1/ I91:8/"PerhapsI91:1/ I91:1/"I91:1/ I91:6/"</b>.I91:1/ I91:6/targetI91:1/ I91:4/<b>"I91:1/ I91:6/calledI91:1/ I91:6/symbolI91:1/ I91:2/noI91:1/ I91:2/isI91:1/ I91:6/"ThereI91:1/ I91:7/(stringI91:1/ I91:3/'(_I91:1/ I91:11/"</pre>\n")I91:1/ I91:7/rev))))I91:1/ I91:4/(intI91:1/ I91:6/targetI91:1/ I91:6/'(readI91:1/ I91:7/target)I91:1/ I91:6/'(headI91:1/ I91:4/"_")I91:1/ I91:3/revI91:1/ I91:3/(eqI91:1/ I91:3/(ifI91:1/ I91:11/(htmlescapeI91:1/ I91:9/"<pre>\n"I91:1/ I91:8/'(stringI91:1/ I91:7/(handleI91:1/ I91:9/<hr/><p>"I91:1/ I91:3/...I91:1/ I91:1/"I91:1/ I91:5/rev))I91:1/ I91:1/"I91:1/ I91:1/@I91:1/ I91:1/"I91:1/ I91:8/'(stringI91:1/ I91:3/'""I91:1/ I91:4/"_")I91:1/ I91:3/revI91:1/ I91:3/(eqI91:1/ I91:3/(ifI91:1/ I91:6/targetI91:1/ I91:1/"I91:1/ I91:11/"<p>viewingI91:1/ I91:7/target)I91:1/ I91:5/(tabsI91:1/ I91:7/stdpageI91:1/ I91:9/stdheaderI91:1/ I91:8/'(stringI91:1/ I91:12/rev_target))I91:1/ I91:4/(cdrI91:1/ I91:4/(carI91:1/ I91:7/'targetI91:1/ I91:5/'(letI91:1/ I91:11/rev_target)I91:1/ I91:4/(carI91:1/ I91:4/'revI91:1/ I91:5/'(letI91:1/ I91:2/0)I91:1/ I91:10/fulltargetI91:1/ I91:3/"/"I91:1/ I91:5/tokenI91:1/ I91:6/(tokenI91:1/ I91:11/'rev_targetI91:1/ I91:5/'(letI91:1/ I91:7/"view")I91:1/ I91:6/actionI91:1/ I91:3/(eqI91:1/ I91:4/'(ifI91:1/ I91:14/fulltarget))))I91:1/ M88:3/"))I87:5/"</a>I87:1/ I87:5/args)I87:1/ M84:5/"\">"M82:10/fulltargetM80:3/"/"I79:5/args)I79:1/ I79:4/(carI79:1/ I79:14/href=\"/view/"I79:1/ I79:3/"<aI79:1/ I79:8/'(stringI79:1/ I79:5/'argsI79:1/ I79:7/(lambdaI79:1/ I79:3/mapI79:1/ I79:4/(mapI79:1/ I79:7/(stringI79:1/ I79:12/...<hr/><p>"I79:1/ I79:1/"I79:1/ I79:10/fulltargetI79:1/ I79:1/"I79:1/ I79:3/forI79:1/ I79:11/"<p>historyI79:1/ I79:11/fulltarget)I79:1/ I79:5/(tabsI79:1/ I79:7/stdpageI79:1/ I79:9/stdheaderI79:1/ I79:8/'(stringI79:1/ I79:10/"history")I79:1/ I79:6/actionI79:1/ I79:3/(eqI79:1/ I79:4/'(ifI79:1/ I79:20/fulltarget))))))))))I79:1/ I79:10/"/view/_/"I79:1/ I79:7/(stringI79:1/ I79:10/'(redirectI79:1/ I79:14/fulltarget))))I79:1/ I79:10/"/view/_/"I79:1/ I79:7/(stringI79:1/ I79:10/'(redirectI79:1/ I79:4/exe)I79:1/ I79:4/baseI79:1/ M72:7/msg))))I71:1/"I71:1/ I71:7/becauseI71:1/ I71:6/failedI71:1/ I71:1/"I71:1/ I71:10/fulltargetI71:1/ I71:1/"I71:1/ I71:2/ofI71:1/ I71:12/"compilationI71:1/ I71:7/(stringI71:1/ I71:6/'abortI71:1/ I71:5/(listI71:1/ I71:5/'(msgI71:1/ I71:4/dat)I71:1/ I71:9/'(compileI71:1/ I71:7/(handleI71:1/ I71:4/'exeI71:1/ I71:5/'(letI71:1/ I71:7/compileI71:1/ I71:4/'(ifI71:1/ I71:4/dat)I71:1/ I71:10/fulltargetI71:1/ I71:7/(insertI71:1/ I71:2/'_I71:1/ I71:5/'(letI71:1/ I71:5/nil))I71:1/ I71:3/'(_I71:1/ I71:13/":compile")))I71:1/ I71:3/extI71:1/ I71:7/(stringI71:1/ I71:5/(headI71:1/ I71:6/'(evalI71:1/ I71:7/(handleI71:1/ I71:8/'compileI71:1/ I71:5/'(letI71:1/ I71:13/fulltarget)))I71:1/ I71:10/"/view/_/"I71:1/ I71:7/(stringI71:1/ I71:10/'(redirectI71:1/ I71:4/dat)I71:1/ I71:10/fulltargetI71:1/ I71:7/(insertI71:1/ I71:2/'_I71:1/ I71:5/'(letI71:1/ I71:3/"")I71:1/ I71:4/baseI71:1/ I71:3/(eqI71:1/ I71:4/'(ifI71:1/ I71:13/form.contentsI71:1/ I71:4/'datI71:1/ I71:5/'(letI71:1/ I71:10/base_ext))I71:1/ I71:4/(cdrI71:1/ I71:4/(carI71:1/ I71:4/'extI71:1/ I71:5/'(letI71:1/ I71:9/base_ext)I71:1/ I71:4/(carI71:1/ I71:5/'baseI71:1/ I71:5/'(letI71:1/ I71:3/1))I71:1/ I71:11/fulltarget)I71:1/ I71:5/(sizeI71:1/ I71:2/(-I71:1/ I71:10/fulltargetI71:1/ I71:3/"."I71:1/ I71:6/rtokenI71:1/ I71:7/(rtokenI71:1/ I71:9/'base_extI71:1/ I71:5/'(letI71:1/ I71:7/"save")I71:1/ I71:6/actionI71:1/ I71:3/(eqI71:1/ I71:4/'(ifI71:1/ I71:25/value=\"save\"></form>"))I71:1/ I71:11/type=submitI71:1/ I71:7/"<inputI71:1/ I71:15/"</textarea>\n"I71:1/ I71:7/data)")I71:1/ I71:11/'"(internalI71:1/ I71:9/symbol)")I71:1/ I71:5/"(wasI71:1/ I71:3/'(_I71:1/ I71:4/")")I71:1/ I71:11/oldcontentsI71:1/ I71:1/"I71:1/ I71:3/intI71:1/ I71:5/"(wasI71:1/ I71:8/'(stringI71:1/ I71:12/oldcontents)I71:1/ I71:12/'(htmlescapeI71:1/ I71:7/data)")I71:1/ I71:6/quotedI71:1/ I71:5/"(wasI71:1/ I71:3/'(_I71:1/ I71:7/data)")I71:1/ I71:4/listI71:1/ I71:5/"(wasI71:1/ I71:1/_I71:1/ I71:3/'(_I71:1/ I71:3/'""I71:1/ I71:11/oldcontentsI71:1/ I71:6/(xcaseI71:1/ I71:19/name=\"contents\">"I71:1/ I71:8/cols=120I71:1/ I71:7/rows=35I71:1/ I71:13/"\"><textareaI71:1/ I71:10/fulltargetI71:1/ I71:16/action=\"/save/"I71:1/ I71:15/method=\"post\"I71:1/ I71:6/"<formI71:1/ I71:13/deleted.</b>"I71:1/ I71:2/beI71:1/ I71:4/willI71:1/ I71:2/ItI71:1/ I71:11/permission.I71:1/ I71:7/withoutI71:1/ I71:8/websitesI71:1/ I71:5/otherI71:1/ I71:4/fromI71:1/ I71:4/textI71:1/ I71:4/copyI71:1/ I71:3/notI71:1/ I71:11/"<br/><b>DoI71:1/ I71:3/"))I71:1/ I71:3/...I71:1/ I71:1/"I71:1/ I71:10/fulltargetI71:1/ I71:1/"I71:1/ I71:4/pageI71:1/ I71:3/newI71:1/ I71:9/"creatingI71:1/ I71:8/'(stringI71:1/ I71:2/")I71:1/ I71:3/...I71:1/ I71:1/"I71:1/ I71:10/fulltargetI71:1/ I71:1/"I71:1/ I71:8/"editingI71:1/ I71:8/'(stringI71:1/ I71:11/oldcontentsI71:1/ I71:3/(ifI71:1/ I71:5/"<p>"I71:1/ I71:11/fulltarget)I71:1/ I71:5/(tabsI71:1/ I71:7/stdpageI71:1/ I71:9/stdheaderI71:1/ I71:8/'(stringI71:1/ I71:5/nil))I71:1/ I71:3/'(_I71:1/ I71:11/fulltarget)I71:1/ I71:6/'(headI71:1/ I71:7/(handleI71:1/ I71:12/'oldcontentsI71:1/ I71:5/'(letI71:1/ I71:7/"edit")I71:1/ I71:6/actionI71:1/ I71:3/(eqI71:1/ I71:4/'(ifI71:1/ I71:11/"</div>")))I71:1/ I71:1/"I71:1/ I71:18/"\">run</a></span>I71:1/ I71:4/pageI71:1/ I71:13/href=\"/run/"I71:1/ I71:16/class=\"tab\"><aI71:1/ I71:6/"<spanI71:1/ I71:1/"I71:1/ I71:22/"\">history</a></span>I71:1/ I71:4/pageI71:1/ I71:17/href=\"/history/"I71:1/ I71:16/class=\"tab\"><aI71:1/ I71:6/"<spanI71:1/ I71:1/"I71:1/ I71:19/"\">edit</a></span>I71:1/ I71:4/pageI71:1/ I71:14/href=\"/edit/"I71:1/ I71:16/class=\"tab\"><aI71:1/ I71:6/"<spanI71:1/ I71:1/"I71:1/ I71:19/"\">view</a></span>I71:1/ I71:4/pageI71:1/ I71:16/href=\"/view/_/"I71:1/ I71:16/class=\"tab\"><aI71:1/ I71:6/"<spanI71:1/ I71:16/class=\"tabs\">"I71:1/ I71:5/"<divI71:1/ I71:8/'(stringI71:1/ I71:5/args)I71:1/ I71:4/(carI71:1/ I71:5/'pageI71:1/ I71:5/'(letI71:1/ I71:5/'argsI71:1/ I71:7/(lambdaI71:1/ I71:5/'tabsI71:1/ I71:5/'(letI71:1/ I71:15/action_target))I71:1/ I71:4/(cdrI71:1/ I71:4/(carI71:1/ I71:11/'fulltargetI71:1/ I71:5/'(letI71:1/ I71:14/action_target)I71:1/ I71:4/(carI71:1/ I71:7/'actionI71:1/ I71:5/'(letI71:1/ I71:2/0)I71:1/ I71:3/urlI71:1/ I71:3/"/"I71:1/ I71:5/tokenI71:1/ I71:6/(tokenI71:1/ I71:14/'action_targetI71:1/ I71:5/'(letI71:1/ I71:4/0)))I71:1/ I69:3/"/"I69:1/ I69:5/tokenI69:1/ I69:6/(tokenI69:1/ I69:4/(cdrI69:1/ I69:4/(carI69:1/ I69:4/'urlI69:1/ I69:5/'(letI69:1/ I69:7/0))))))I69:1/ I69:4/hrecI69:1/ I69:5/(hrecI69:1/ I69:6/stringI69:1/ I69:5/(consI69:1/ I69:6/'(evalI69:1/ I69:9/1))))))))I69:1/ I69:1/nI69:1/ I69:2/(+I69:1/ I69:4/selfI69:1/ I69:5/(selfI69:1/ I69:6/'ch)))I69:1/ I69:8/'"&amp;"I69:1/ I69:4/"&")I69:1/ I69:2/chI69:1/ I65:7/'"&gt;"I65:1/ I65:4/">")I65:1/ I65:2/chI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:7/'"&lt;"I65:1/ I65:4/"<")I65:1/ I65:2/chI65:1/ I65:3/(eqI65:1/ I65:3/(ifI65:1/ I65:6/'(consI65:1/ I65:2/n)I65:1/ I65:1/sI65:1/ I65:4/(subI65:1/ I65:3/'chI65:1/ I65:5/'(letI65:1/ I65:4/'nilI65:1/ I65:3/s))I65:1/ I65:5/(sizeI65:1/ I65:1/nI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:6/args))I65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'nI65:1/ I65:5/'(letI65:1/ I65:5/args)I65:1/ I65:4/(carI65:1/ I65:5/'selfI65:1/ I65:5/'(letI65:1/ I65:5/'argsI65:1/ I65:7/(lambdaI65:1/ I65:5/'hrecI65:1/ I65:5/'(letI65:1/ I65:6/hargs)I65:1/ I65:4/(carI65:1/ I65:2/'sI65:1/ I65:5/'(letI65:1/ I65:6/'hargsI65:1/ I65:7/(lambdaI65:1/ I65:11/'htmlescapeI65:1/ I65:5/'(letI65:1/ I65:11/1))))))))))I65:1/ I65:1/nI65:1/ I65:2/(-I65:1/ I65:1/sI65:1/ I65:3/sepI65:1/ I65:4/selfI65:1/ I65:6/'(selfI65:1/ I65:5/1))))I65:1/ I65:1/nI65:1/ I65:2/(+I65:1/ I65:2/s)I65:1/ I65:5/(sizeI65:1/ I65:2/(-I65:1/ I65:2/1)I65:1/ I65:1/nI65:1/ I65:2/(+I65:1/ I65:1/sI65:1/ I65:7/(substrI65:1/ I65:2/n)I65:1/ I65:1/0I65:1/ I65:1/sI65:1/ I65:7/(substrI65:1/ I65:6/'(listI65:1/ I65:4/sep)I65:1/ I65:2/chI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:2/n)I65:1/ I65:1/sI65:1/ I65:4/(subI65:1/ I65:3/'chI65:1/ I65:5/'(letI65:1/ I65:2/s)I65:1/ I65:2/""I65:1/ I65:6/'(listI65:1/ I65:3/1))I65:1/ I65:1/0I65:1/ I65:2/(-I65:1/ I65:1/nI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:8/args))))I65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'nI65:1/ I65:5/'(letI65:1/ I65:7/args)))I65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'sI65:1/ I65:5/'(letI65:1/ I65:6/args))I65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:4/'sepI65:1/ I65:5/'(letI65:1/ I65:5/args)I65:1/ I65:4/(carI65:1/ I65:5/'selfI65:1/ I65:5/'(letI65:1/ I65:5/'argsI65:1/ I65:7/(lambdaI65:1/ I65:7/'rtokenI65:1/ I65:5/'(letI65:1/ I65:11/1))))))))))I65:1/ I65:1/nI65:1/ I65:2/(+I65:1/ I65:1/sI65:1/ I65:3/sepI65:1/ I65:4/selfI65:1/ I65:6/'(selfI65:1/ I65:5/1))))I65:1/ I65:1/nI65:1/ I65:2/(+I65:1/ I65:2/s)I65:1/ I65:5/(sizeI65:1/ I65:2/(-I65:1/ I65:2/1)I65:1/ I65:1/nI65:1/ I65:2/(+I65:1/ I65:1/sI65:1/ I65:7/(substrI65:1/ I65:2/n)I65:1/ I65:1/0I65:1/ I65:1/sI65:1/ I65:7/(substrI65:1/ I65:6/'(listI65:1/ I65:4/sep)I65:1/ I65:2/chI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:2/n)I65:1/ I65:1/sI65:1/ I65:4/(subI65:1/ I65:3/'chI65:1/ I65:5/'(letI65:1/ I65:3/"")I65:1/ I65:1/sI65:1/ I65:6/'(listI65:1/ I65:3/s))I65:1/ I65:5/(sizeI65:1/ I65:1/nI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:8/args))))I65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'nI65:1/ I65:5/'(letI65:1/ I65:7/args)))I65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'sI65:1/ I65:5/'(letI65:1/ I65:6/args))I65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:4/'sepI65:1/ I65:5/'(letI65:1/ I65:5/args)I65:1/ I65:4/(carI65:1/ I65:5/'selfI65:1/ I65:5/'(letI65:1/ I65:5/'argsI65:1/ I65:7/(lambdaI65:1/ I65:6/'tokenI65:1/ I65:5/'(letI65:1/ I65:9/'nil)))))I65:1/ I65:4/l)))I65:1/ I65:4/(cdrI65:1/ I65:1/fI65:1/ I65:4/selfI65:1/ I65:5/(selfI65:1/ I65:3/l))I65:1/ I65:4/(carI65:1/ I65:2/(fI65:1/ I65:6/'(consI65:1/ I65:1/lI65:1/ I65:4/'(ifI65:1/ I65:7/args)))I65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'lI65:1/ I65:5/'(letI65:1/ I65:6/args))I65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'fI65:1/ I65:5/'(letI65:1/ I65:5/args)I65:1/ I65:4/(carI65:1/ I65:5/'selfI65:1/ I65:5/'(letI65:1/ I65:5/'argsI65:1/ I65:7/(lambdaI65:1/ I65:4/'mapI65:1/ I65:5/'(letI65:1/ I65:12/"\r\n\r\n"))I65:1/ I65:7/target)I65:1/ I65:4/(carI65:1/ I65:1/"I65:1/ I65:10/"Location:I65:1/ I65:8/'(stringI65:1/ I65:7/'targetI65:1/ I65:7/(lambdaI65:1/ I65:9/'redirectI65:1/ I65:5/'(letI65:1/ I65:36/title=\"polybook\"/></head><body>\n"I65:1/ I65:28/href=\"/raw/_/polybook.css\"I65:1/ I65:17/type=\"text/css\"I65:1/ I65:14/rel=stylesheetI65:1/ I65:18/"<html><head><linkI65:1/ I65:8/'stdpageI65:1/ I65:5/'(letI65:1/ I65:22/charset=utf-8\r\n\r\n"I65:1/ I65:10/text/html;I65:1/ I65:14/"Content-Type:I65:1/ I65:10/'stdheaderI65:1/ I65:5/'(letI65:1/ X
!4=X

main-go 21 4541/(let 'stdheader "Content-Type: text/html; charset=utf-8\r\n\r\n" '(let 'stdpage "<html><head><link rel=stylesheet type=\"text/css\" href=\"/raw/_/polybook.css\" title=\"polybook\"/></head><body>\n" '(let 'redirect (lambda 'target '(string "Location: " (car target) "\r\n\r\n")) '(let 'map (lambda 'args '(let 'self (car args) '(let 'f (car (cdr args)) '(let 'l (car (cdr (cdr args))) '(if l '(cons (f (car l)) (self self f (cdr l))) 'nil))))) '(let 'token (lambda 'args '(let 'self (car args) '(let 'sep (car (cdr args)) '(let 's (car (cdr (cdr args))) '(let 'n (car (cdr (cdr (cdr args)))) '(if (eq n (size s)) '(list s "") '(let 'ch (sub s n) '(if (eq ch sep) '(list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1)))) '(self self sep s (+ n 1)))))))))) '(let 'rtoken (lambda 'args '(let 'self (car args) '(let 'sep (car (cdr args)) '(let 's (car (cdr (cdr args))) '(let 'n (car (cdr (cdr (cdr args)))) '(if (eq n (- 0 1)) '(list "" s) '(let 'ch (sub s n) '(if (eq ch sep) '(list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1)))) '(self self sep s (- n 1)))))))))) '(let 'htmlescape (lambda 'hargs '(let 's (car hargs) '(let 'hrec (lambda 'args '(let 'self (car args) '(let 'n (car (cdr args)) '(if (eq n (size s)) 'nil '(let 'ch (sub s n) '(cons (if (eq ch "<") '"&lt;" '(if (eq ch ">") '"&gt;" '(if (eq ch "&") '"&amp;" 'ch))) (self self (+ n 1)))))))) '(eval (cons string (hrec hrec 0)))))) '(let 'url (car (cdr (token token "/" request.url 0))) '(let 'action_target (token token "/" url 0) '(let 'action (car action_target) '(let 'fulltarget (car (cdr action_target)) '(let 'tabs (lambda 'args '(let 'page (car args) '(string "<div class=\"tabs\">" "<span class=\"tab\"><a href=\"/view/_/" page "\">view</a></span> " "<span class=\"tab\"><a href=\"/edit/" page "\">edit</a></span> " "<span class=\"tab\"><a href=\"/history/" page "\">history</a></span> " "<span class=\"tab\"><a href=\"/run/" page "\">run</a></span> " "</div>"))) '(if (eq action "edit") '(let 'oldcontents (handle '(head fulltarget) '(_ nil)) '(string stdheader stdpage (tabs fulltarget) "<p>" (if oldcontents '(string "editing " fulltarget " ... ") '(string "creating new page " fulltarget " ... ")) "<br/><b>Do not copy text from other websites without permission. It will be deleted.</b>" "<form method=\"post\" action=\"/save/" fulltarget "\"><textarea rows=35 cols=120 name=\"contents\">" (xcase oldcontents '"" '(_ _ "(was list data)") '(_ "(was quoted data)") '(htmlescape oldcontents) '(string "(was int " oldcontents ")") '(_ "(was symbol)") '"(internal data)") "</textarea>\n" "<input type=submit value=\"save\"></form>")) '(if (eq action "save") '(let 'base_ext (rtoken rtoken "." fulltarget (- (size fulltarget) 1)) '(let 'base (car base_ext) '(let 'ext (car (cdr base_ext)) '(let 'dat form.contents '(if (eq base "") '(let '_ (insert fulltarget dat) '(redirect (string "/view/_/" fulltarget))) '(let 'compile (handle '(eval (head (string ext ":compile"))) '(_ nil)) '(let '_ (insert fulltarget dat) '(if compile '(let 'exe (compile dat) '(let '_ (insert base exe) '(redirect (string "/view/_/" fulltarget)))) '(redirect (string "/view/_/" fulltarget)))))))))) '(if (eq action "history") '(string stdheader stdpage (tabs fulltarget) "<p>history for " fulltarget " ...<hr/><p>" (string (map map (lambda 'args '(string "<a href=\"/view/" (car args) "/" fulltarget "\">" (car args) "</a> ")) (history fulltarget)))) '(if (eq action "view") '(let 'rev_target (token token "/" fulltarget 0) '(let 'rev (car rev_target) '(let 'target (car (cdr rev_target)) '(string stdheader stdpage (tabs target) "<p>viewing " target (if (eq rev "_") '"" '(string " @ " rev)) " ... <hr/><p>" (handle '(string "<pre>\n" (htmlescape (if (eq rev "_") '(head target) '(read target (int rev)))) "</pre>\n") '(_ (string "There is no symbol called <b>" target "</b>. " "Perhaps you'd like to <a href=\"/edit/" target "\">create it</a>?"))))))) '(if (eq action "raw") '(let 'rev_target (token token "/" fulltarget 0) '(let 'rev (car rev_target) '(let 'target (car (cdr rev_target)) '(string stdheader (if (eq rev "_") '(head target) '(read target (int rev))))))) '(if (eq action "run") '(string stdheader stdpage (tabs fulltarget) "<p>running " fulltarget " ... <hr/><p>" (handle '(let 'prog (head fulltarget) '(handle '(eval prog) '(msg (string "<b>Runtime error</b>: " msg)))) '(_ (string "There is no symbol called <b>" fulltarget "</b>. " "Perhaps you'd like to <a href=\"/edit/" fulltarget "\">create it</a>?")))) '(string stdheader "unknown action!")))))))))))))))))))
!18=X
!16=X
!14=I903:7/msg))))I903:1/ I903:1/"I903:1/ I903:7/becauseI903:1/ I903:6/failedI903:1/ I903:1/"I903:1/ I903:10/fulltargetI903:1/ I903:1/"I903:1/ I903:2/ofI903:1/ I903:12/"compilationI903:1/ I903:7/(stringI903:1/ I903:6/'abortI903:1/ I903:5/(listI903:1/ I903:5/'(msgI903:1/ M900:9/'(compileI899:7/(handleI899:1/ X
!13=M1346:26/analysis\n\n))))))))))))")M1344:4/caseI1343:6/actionI1343:1/ I1343:1/;I1343:1/ I1343:4/))))I1343:7/       I1343:16/action!\")))\n\nI1343:1/ I1343:9/\"unknownI1343:1/ M1339:10/          M1338:4/\n\nI1338:12/            I1338:15/it</a>?\"))))\nM1336:13/\"\\\">createM1332:17/href=\\\"/edit/\"M1322:9/\"PerhapsM1321:32/                                M1320:4/\"\nM1318:7/\"</b>.M1314:5/<b>\"M1304:7/\"ThereM1301:24/                        M1300:5/'(_\nM1299:22/                      M1298:9/msg))))\nM1296:2/\"M1292:12/\"<b>RuntimeM1281:26/                          M1280:13/fulltarget)\nM1271:14/              M1270:12/<hr/><p>\"\nM1266:2/\"M1262:2/\"M1260:12/\"<p>runningM1259:14/              M1258:13/fulltarget)\nM1255:14/              M1254:9/stdpage\nM1251:14/              M1250:10/'(string\nM1249:12/            M1248:10/\"run\")\nI1242:9/         I1242:7/loop)\nM1240:8/infiniteI1239:2/(=I1239:1/ I1239:8/main...?I1239:1/ I1239:3/runI1239:1/ I1239:7/againstI1239:1/ I1239:7/protectI1239:1/ I1239:3/XXXI1239:1/ I1239:2/;;I1239:10/          I1239:7/)))\n\nI1239:13/             I1239:3/)\nI1239:1/ I1239:6/rev)))I1239:1/ M1228:6/\"_\")M1219:14/              M1218:9/(string\nI1218:13/             I1218:2/\nI1218:5/     I1218:1/'M1208:4/(letI1208:12/            I1208:3/'\nM1200:4/(letI1200:12/            I1200:3/'\nM1194:5/\"/\"M1185:11/           M1184:10/\"raw\")\nI1178:7/       I1178:11/instance)\nM1176:3/forM1174:4/CSS,I1173:9/includingI1173:1/ I1173:3/forI1173:1/ I1173:5/(goodI1173:1/ I1173:14/stuff/escapingI1173:1/ I1173:6/excessI1173:1/ I1173:2/noI1173:1/ I1173:3/butI1173:1/ I1173:5/view,I1173:1/ I1173:4/likeI1173:1/ I1173:2/;;I1173:7/       I1173:20/it</a>?\")))))))\n\nI1173:1/ I1173:13/\"\\\">createI1173:1/ M1170:17/href=\\\"/edit/\"M1160:9/\"PerhapsM1159:32/                                M1158:4/\"\nM1156:7/\"</b>.M1152:5/<b>\"M1142:7/\"ThereM1139:24/                        M1138:5/'(_\nM1137:22/                      M1136:16/\"</pre>\\n\")\nM1122:6/\"_\")M1112:12/\"<pre>\\n\"M1107:14/              M1106:12/<hr/><p>\"\nM1102:2/\"M1098:2/\"M1094:2/\"M1090:5/'\"\"M1088:6/\"_\")M1078:2/\"M1076:12/\"<p>viewingM1075:14/              M1074:9/target)\nM1071:14/              M1070:9/stdpage\nM1067:14/              M1066:9/(string\nI1066:13/             I1066:2/\nI1066:5/     I1066:1/'M1056:4/(letI1056:12/            I1056:3/'\nM1048:4/(letI1048:12/            I1048:3/'\nM1042:5/\"/\"M1033:11/           M1032:11/\"view\")\nM1025:7/       M1024:18/fulltarget))))\n\nM1020:4/\"))M1018:6/\"</a>I1014:54/                                                      I1014:2/\nM1012:9/\"\\\">\"M1008:5/\"/\"M1002:17/href=\\\"/view/\"M1000:4/\"<aM987:14/              M986:15/...<hr/><p>\"\nM984:2/\"M980:2/\"M976:12/\"<p>historyM975:14/              M974:13/fulltarget)\nM971:14/              M970:9/stdpage\nM967:14/              M966:10/'(string\nM965:12/            M964:14/\"history\")\nI958:7/       I958:8/save\n\nM956:6/actionM954:1/;I953:7/)))))))I953:8/        I953:15/fulltarget)))\nI953:1/ I953:12/\"/view/_/\"I953:1/ I950:14/              I950:8/exists\nM948:8/compilerM946:1/;I945:2/))I945:20/                    I945:14/fulltarget))\nI945:1/ I945:12/\"/view/_/\"I945:1/ M942:9/(redirectI942:20/                    I942:10/inserted\nI941:2/weI941:1/ I941:8/revisionI941:1/ I941:3/theI941:1/ I941:2/toI941:1/ I941:8/directlyI941:1/ I941:4/jumpI941:1/ I941:6/shouldI941:1/ I941:3/XXXI941:1/ I941:2/;;I941:20/                    I941:3/'\nI941:1/ M932:4/(letI932:15/               I932:12/executable\nI931:4/saveI931:1/ I931:1/;I931:15/               I931:3/'\nI931:1/ M928:2/\"M922:2/\"M921:52/                                                    M920:12/fulltarget\nM918:2/\"M914:13/\"compilationI914:52/                                                    I914:9/(string\nI914:51/                                                   I914:8/'abort\nI914:51/                                                   I914:7/(list\nI914:50/                                                  I914:8/aborts\nM912:4/thatM910:7/programM908:1/aM906:6/returnI905:1/;I905:50/                                                  I905:4/we\nI905:1/ I905:4/thenI905:1/ I905:6/fails,I905:1/ I905:11/compilationI905:1/ I905:2/ifI905:1/ I905:1/;I905:50/                                                  I905:7/'(msg\nI905:1/ M895:15/               M894:9/compile\nM892:3/(ifI892:13/             I892:3/'\nM882:4/(letI882:12/            I882:8/source\nI881:4/saveI881:1/ I881:1/;I881:12/            I881:3/'\nI881:1/ M876:15/\":compile\")))I862:9/         I862:5/any\nM860:2/ifM858:9/compiler,I857:3/theI857:1/ I857:8/closure)I857:1/ I857:1/aI857:1/ I857:7/produceI857:1/ I857:2/toI857:1/ I857:3/runI857:1/ I857:4/(andI857:1/ I857:3/getI857:1/ I857:1/;I857:9/         I857:11/prog.b.w)\nI857:1/ I857:3/eg.I857:2/  I857:13/recursively??I857:1/ I857:4/thisI857:1/ I857:2/doI857:1/ I857:6/(mightI857:1/ I857:2/;;I857:9/         I857:9/version\nI857:1/ I857:8/compiledI857:1/ I857:3/andI857:1/ I857:6/sourceI857:1/ I857:3/theI857:1/ I857:6/savingI857:1/ I857:8/compile,I857:1/ I857:6/shouldI857:1/ I857:2/weI857:1/ I857:9/otherwiseI857:1/ I857:2/;;I857:9/         I857:17/fulltarget)))\n\nI857:1/ I857:12/\"/view/_/\"I857:1/ M854:9/(redirectI854:17/                 I854:10/revision\nI853:4/gotoI853:1/ I853:3/XXXI853:1/ I853:2/;;I853:17/                 I853:3/'\nI853:1/ I844:11/           I844:7/save.\nM842:4/justI841:2/;;I841:11/           I841:6/case\nI841:1/ I841:4/thisI841:1/ I841:2/inI841:1/ I841:5/name.I841:1/ I841:6/entireI841:1/ I841:3/theI841:1/ I841:5/holdsI841:1/ I841:3/extI841:1/ I841:4/thenI841:1/ I841:1/.I841:1/ I841:2/noI841:1/ I841:3/wasI841:1/ I841:5/thereI841:1/ I841:2/ifI841:1/ I841:2/;;I841:11/           I841:7/\"\")\nI841:1/ M836:3/(ifI836:7/       I836:5/'\n\nM830:4/(letI830:7/       I830:3/'\nM820:4/(letI820:7/       I820:3/'\nM812:4/(letI812:7/       I812:3/'\nM800:5/\".\"I792:6/      I792:12/extension.\nM790:3/theI789:2/onI789:1/ I789:5/basedI789:1/ I789:8/languageI789:1/ I789:3/theI789:1/ I789:3/outI789:1/ I789:6/figureI789:1/ I789:1/;I789:7/       I789:2/\nI789:1/ I789:10/compile...I789:1/ I789:2/toI789:1/ I789:4/needI789:1/ I789:5/mightI789:1/ I789:1/;I789:7/       I789:11/\"save\")\nI789:1/ M783:4/    M782:34/value=\\\"save\\\"></form>\"))\n\nM778:8/\"<inputM777:15/               M776:20/\"</textarea>\\n\"\nM775:15/               M774:10/data)\")\nM772:12/'\"(internalM771:19/                   M770:12/symbol)\")\nM768:6/\"(wasM765:19/                   M764:8/\")\")\nM760:2/\"M756:6/\"(wasM753:19/                   M752:14/oldcontents)\nM749:19/                   M748:10/data)\")\nM744:6/\"(wasM741:19/                   M740:10/data)\")\nM736:6/\"(wasM731:19/                   M730:7/'\"\"\nM729:19/                   M728:13/oldcontents\nM725:15/               M724:26/name=\\\"contents\\\">\"\nM718:16/\"\\\"><textareaM714:19/action=\\\"/save/\"M712:19/method=\\\"post\\\"M710:7/\"<formM709:15/               M708:16/deleted.</b>\"\nM684:12/\"<br/><b>DoM683:15/               M682:6/\"))\nM678:2/\"M674:2/\"M668:10/\"creatingM665:19/                   M664:5/\")\nM660:2/\"M656:2/\"M654:9/\"editingM651:19/                   M650:13/oldcontents\nM647:15/               M646:9/\"<p>\"\nM641:16/                M640:9/stdpage\nM636:7/(stringI636:8/        I636:3/'\nI622:6/      I622:10/textarea\nM620:3/theI619:2/inI619:1/ I619:2/itI619:1/ I619:3/putI619:1/ I619:3/andI619:1/ I619:2/;;I619:6/      I619:6/page\nI619:1/ I619:4/thisI619:1/ I619:3/forI619:1/ I619:4/codeI619:1/ I619:6/sourceI619:1/ I619:3/theI619:1/ I619:5/fetchI619:1/ I619:2/toI619:1/ I619:4/needI619:1/ I619:2/;;I619:6/      I619:11/\"edit\")\nI619:1/ M614:3/(ifM613:2/  M612:5/'\n\nM610:13/\"</div>\")))I610:27/                           I610:4/\"\nM608:21/\"\\\">run</a></span>M604:16/href=\\\"/run/\"M602:20/class=\\\"tab\\\"><aM600:7/\"<spanM599:27/                           M598:4/\"\nM596:25/\"\\\">history</a></span>M592:20/href=\\\"/history/\"M590:20/class=\\\"tab\\\"><aM588:7/\"<spanM587:27/                           M586:4/\"\nM584:22/\"\\\">edit</a></span>M580:17/href=\\\"/edit/\"M578:20/class=\\\"tab\\\"><aM576:7/\"<spanM575:27/                           M574:4/\"\nM572:22/\"\\\">view</a></span>M568:19/href=\\\"/view/_/\"M566:20/class=\\\"tab\\\"><aM564:7/\"<spanI564:27/                           I564:23/class=\\\"tabs\\\">\"\nM562:6/\"<divM560:7/(stringI560:19/                   I560:6/tabs\nM558:4/makeI557:3/XXXI557:1/ I557:1/;I557:19/                   I557:3/'\nI557:1/ M549:13/             M548:7/'args\nM542:6/\n(letI542:2/  I542:3/'\nM532:7/'\n(letM524:7/'\n(letM518:5/\"/\"M510:7/'\n(letM504:5/\"/\"M492:11/char)\n(letI491:1//I491:1/ I491:8/startingI491:1/ I491:3/theI491:1/ I491:3/offI491:1/ I491:5/(tossI491:1/ I491:1/;I491:2/  I491:5/URL\nI491:1/ I491:3/theI491:1/ I491:2/onI491:1/ I491:5/basedI491:1/ I491:5/doingI491:1/ I491:5/we'reI491:1/ I491:4/whatI491:1/ I491:3/outI491:1/ I491:6/figureI491:1/ I491:1/;I491:2/  I491:5/'\n\nI491:1/ M479:15/               M478:11/1))))))))\nM469:46/                                              M468:8/'ch)))\nM467:54/                                                      M466:12/'\"&amp;\"\nM465:56/                                                        M464:8/\"&\")\nM457:51/                                                   M456:11/'\"&gt;\"\nM455:53/                                                     M454:8/\">\")\nM447:48/                                                M446:11/'\"&lt;\"\nM445:50/                                                  M444:8/\"<\")\nM437:46/                                              M436:8/'(cons\nM435:44/                                            M434:4/n)\nM425:38/                                      M424:6/'nil\nM423:40/                                        M422:5/s))\nM413:35/                                   M412:8/args))\nM403:29/                             M402:7/args)\nM395:23/                       M394:7/'args\nM387:9/         M386:8/hargs)\nM379:4/    M378:8/'hargs\nI376:2/  I376:6/PERF\nM374:1/;I374:2/  I374:13/'htmlescape\nM372:9/'\n\n(letM370:7/)))))))I370:37/                                     I370:6/1)))\nM357:42/                                          M356:7/1))))\nM325:42/                                          M324:6/sep)\nM317:37/                                     M316:4/n)\nM307:31/                               M306:4/s)\nM304:4/\"\"M289:28/                            M288:10/args))))\nM275:22/                      M274:9/args)))\nM263:16/                M262:8/args))\nM253:10/          M252:7/args)\nM245:4/    M244:7/'args\nI242:2/  I242:9/'rtoken\nM240:6/\n(letI240:21/                     I240:8/instanceM238:4/lastM236:3/butI235:5/same,I235:1/ I235:6/'\n\n;I235:1/ I235:7/)))))))I235:37/                                     I235:6/1)))\nI235:1/ M223:42/                                          M222:7/1))))\nM191:42/                                          M190:6/sep)\nM183:37/                                     M182:4/n)\nM173:31/                               M172:7/\"\")\nM157:28/                            M156:10/args))))\nM143:22/                      M142:9/args)))\nM131:16/                M130:8/args))\nM121:10/          M120:7/args)\nM113:4/    M112:7/'args\nI110:2/  I110:8/'token\nM108:11/given\n(letM106:4/charI105:3/theI105:1/ I105:2/ofI105:1/ I105:8/instanceI105:1/ I105:5/firstI105:1/ I105:3/theI105:1/ I105:2/toI105:1/ I105:2/upI105:1/ I105:4/chopI105:1/ I105:6/'\n\n;I105:1/ M103:25/                         M102:6/l)))\nM85:27/                           M84:3/l\nM81:22/                      M80:9/args)))\nM69:16/                M68:8/args))\nM59:10/          M58:7/args)\nM51:4/    M50:7/'args\nI48:2/  I48:2/\nM44:11/'\n\n\n(letM42:18/\"\\r\\n\\r\\n\"))M36:2/\"M34:11/\"Location:M24:7/'\n(letM22:42/title=\\\"polybook\\\"/></head><body>\\n\"M20:32/href=\\\"/raw/_/polybook.css\\\"M18:21/type=\\\"text/css\\\"M14:19/\"<html><head><linkM10:7/'\n(letM8:27/charset=utf-8\\r\\n\\r\\n\"M4:15/\"Content-Type:M0:13/failure\n(letI0:1/ I0:11/compilationI0:1/ I0:4/testI0:1/ I0:2/;;I0:1/ I0:13/revert.\n))))I0:1/ I0:2/toI0:1/ I0:4/needI0:1/ I0:3/andI0:1/ I0:2/upI0:1/ I0:4/messI0:1/ I0:5/mightI0:1/ I0:2/weI0:1/ I0:8/anythingI0:1/ I0:4/doesI0:1/ I0:4/pageI0:1/ I0:7/main-goI0:1/ I0:2/;;I0:1/ I0:6/parse:I0:1/ I0:7/becauseI0:1/ I0:6/failedI0:1/ I0:9/main-go.bI0:1/ I0:2/ofI0:1/ I0:12/"compilationI0:1/ I0:6/(abortX
!9=M1818:27/action!")))))))))))))))))))M1816:8/"unknownD1814:D1813:D1812:D1811:D1810:D1809:D1808:D1807:D1806:D1805:M1801:1/ M1800:12/it</a>?"))))D1799:D1798:M1796:10/"\">createM1792:14/href=\"/edit/"M1782:8/"PerhapsM1781:1/ M1780:1/"M1778:6/"</b>.M1774:4/<b>"M1764:6/"ThereM1761:1/ M1760:3/'(_M1759:1/ M1758:7/msg))))M1756:1/"M1752:11/"<b>RuntimeM1741:1/ M1740:11/fulltarget)M1731:1/ M1730:9/<hr/><p>"M1726:1/"M1722:1/"M1720:11/"<p>runningM1719:1/ M1718:11/fulltarget)M1715:1/ M1714:7/stdpageM1711:1/ M1710:8/'(stringM1709:1/ M1708:6/"run")D1701:D1700:M1698:10/rev)))))))D1696:D1695:D1694:D1693:D1692:D1691:D1690:D1689:D1688:D1687:D1686:D1685:D1684:D1683:D1682:D1681:D1680:D1679:D1678:D1677:M1666:4/"_")M1657:1/ M1656:8/'(stringD1655:D1654:D1653:D1652:M1642:5/'(letD1641:D1640:M1632:5/'(letD1631:D1630:M1624:3/"/"M1615:1/ M1614:6/"raw")D1607:D1606:M1604:15/it</a>?")))))))M1602:10/"\">createD1600:D1599:D1598:D1597:D1596:D1595:D1594:D1593:D1592:D1591:D1590:D1589:D1588:D1587:D1586:D1585:D1584:D1583:D1582:D1581:D1580:D1579:D1578:D1577:M1574:14/href=\"/edit/"M1564:8/"PerhapsM1563:1/ M1562:1/"M1560:6/"</b>.M1556:4/<b>"M1546:6/"ThereM1543:1/ M1542:3/'(_M1541:1/ M1540:11/"</pre>\n")M1526:4/"_")M1516:9/"<pre>\n"M1511:1/ M1510:9/<hr/><p>"M1506:1/"M1502:1/"M1498:1/"M1494:3/'""M1492:4/"_")M1482:1/"M1480:11/"<p>viewingM1479:1/ M1478:7/target)M1475:1/ M1474:7/stdpageM1471:1/ M1470:8/'(stringD1469:D1468:D1467:D1466:M1456:5/'(letD1455:D1454:M1446:5/'(letD1445:D1444:M1438:3/"/"M1429:1/ M1428:7/"view")M1421:1/ M1420:14/fulltarget))))M1416:3/"))M1414:5/"</a>D1409:D1408:M1406:5/"\">"M1402:3/"/"M1396:14/href=\"/view/"M1394:3/"<aM1381:1/ M1380:12/...<hr/><p>"M1378:1/"M1374:1/"M1370:11/"<p>historyM1369:1/ M1368:11/fulltarget)M1365:1/ M1364:7/stdpageM1361:1/ M1360:8/'(stringM1359:1/ M1358:10/"history")D1351:D1350:M1348:20/fulltarget))))))))))M1346:10/"/view/_/"D1344:D1343:D1342:D1341:D1340:D1339:D1335:D1334:M1332:14/fulltarget))))M1330:10/"/view/_/"D1328:D1327:D1326:D1325:D1324:D1323:M1320:10/'(redirectD1319:D1318:D1316:D1315:D1314:D1313:D1312:D1311:D1310:D1309:D1308:D1307:D1306:D1305:D1304:D1303:D1302:D1301:D1300:D1299:D1298:D1297:M1288:5/'(letD1287:D1286:D1284:D1283:D1282:D1281:D1280:D1279:M1276:1/"M1270:1/"M1269:1/ M1268:10/fulltargetM1266:1/"M1262:12/"compilationD1261:D1260:D1259:D1258:D1257:D1256:D1255:D1254:M1252:7/(stringM1250:6/'abortM1248:5/(listM1246:5/'(msgD1244:D1243:D1242:D1241:D1240:D1239:D1238:D1237:D1236:D1235:D1234:D1233:D1232:D1231:D1230:D1229:M1219:1/ M1218:7/compileM1216:4/'(ifD1215:D1214:M1204:5/'(letD1203:D1202:D1200:D1199:D1198:D1197:D1196:D1195:M1190:13/":compile")))D1175:D1174:M1172:13/fulltarget)))M1170:10/"/view/_/"D1168:D1167:D1166:D1165:D1164:D1163:D1162:D1161:D1160:D1159:D1158:D1157:D1156:D1155:D1154:D1153:D1152:D1151:D1150:D1149:D1148:D1147:D1146:D1145:D1144:D1143:D1142:D1141:D1140:D1139:D1138:D1137:D1136:D1135:D1134:D1133:D1132:D1131:D1130:D1129:D1128:D1127:D1126:D1125:D1124:D1123:D1122:D1121:D1120:D1119:D1118:D1117:D1116:D1115:D1114:D1113:D1112:D1111:M1108:10/'(redirectD1107:D1106:D1104:D1103:D1102:D1101:D1100:D1099:D1098:D1097:D1087:D1086:M1084:3/"")D1082:D1081:D1080:D1079:D1078:D1077:D1076:D1075:D1074:D1073:D1072:D1071:D1070:D1069:D1068:D1067:D1066:D1065:D1064:D1063:D1062:D1061:D1060:D1059:D1058:D1057:D1056:D1055:D1054:D1053:D1052:D1051:D1050:D1049:M1044:4/'(ifD1043:D1042:M1036:5/'(letD1035:D1034:M1024:5/'(letD1023:D1022:M1014:5/'(letD1013:D1012:M1000:3/"."D991:D990:M988:7/"save")D986:D985:D984:D983:D982:D981:D980:D979:D978:D977:D976:D975:D974:D973:D972:D971:D970:D969:D968:D967:D966:D965:D964:D963:D962:D961:D960:D959:M953:1/ M952:25/value=\"save\"></form>"))M948:7/"<inputM947:1/ M946:15/"</textarea>\n"M945:1/ M944:7/data)")M942:11/'"(internalM941:1/ M940:9/symbol)")M938:5/"(wasM935:1/ M934:4/")")M930:1/"M926:5/"(wasM923:1/ M922:12/oldcontents)M919:1/ M918:7/data)")M914:5/"(wasM911:1/ M910:7/data)")M906:5/"(wasM901:1/ M900:3/'""M899:1/ M898:11/oldcontentsM895:1/ M894:19/name=\"contents\">"M888:13/"\"><textareaM884:16/action=\"/save/"M882:15/method=\"post\"M880:6/"<formM879:1/ M878:13/deleted.</b>"M854:11/"<br/><b>DoM853:1/ M852:3/"))M848:1/"M844:1/"M838:9/"creatingM835:1/ M834:2/")M830:1/"M826:1/"M824:8/"editingM821:1/ M820:11/oldcontentsM817:1/ M816:5/"<p>"M811:1/ M810:7/stdpageM806:8/'(stringD805:D804:D789:D788:M786:7/"edit")D784:D783:D782:D781:D780:D779:D778:D777:D776:D775:D774:D773:D772:D771:D770:D769:D768:D767:D766:D765:D764:D763:D762:D761:D760:D759:D758:D757:D756:D755:D754:D753:M748:4/'(ifM747:1/ M746:11/"</div>")))M744:1/"D743:D742:M740:18/"\">run</a></span>M736:13/href=\"/run/"M734:16/class=\"tab\"><aM732:6/"<spanM731:1/ M730:1/"M728:22/"\">history</a></span>M724:17/href=\"/history/"M722:16/class=\"tab\"><aM720:6/"<spanM719:1/ M718:1/"M716:19/"\">edit</a></span>M712:14/href=\"/edit/"M710:16/class=\"tab\"><aM708:6/"<spanM707:1/ M706:1/"M704:19/"\">view</a></span>M700:16/href=\"/view/_/"M698:16/class=\"tab\"><aM696:6/"<spanD695:D694:M692:16/class=\"tabs\">"M690:5/"<divD689:D688:M686:8/'(stringD684:D683:D682:D681:D680:D679:M671:1/ M670:5/'argsM664:5/'(letD663:D662:M652:5/'(letM644:5/'(letM638:3/"/"M630:5/'(letM624:3/"/"M612:5/'(letD610:D609:D608:D607:D606:D605:D604:D603:D602:D601:D600:D599:D598:D597:D596:D595:D594:D593:D592:D591:D590:D589:D588:D587:D586:D585:D584:D583:D582:D581:D580:D579:D578:D577:M565:1/ M564:9/1))))))))M555:1/ M554:6/'ch)))M553:1/ M552:8/'"&amp;"M551:1/ M550:4/"&")M543:1/ M542:7/'"&gt;"M541:1/ M540:4/">")M533:1/ M532:7/'"&lt;"M531:1/ M530:4/"<")M523:1/ M522:6/'(consM521:1/ M520:2/n)M511:1/ M510:4/'nilM509:1/ M508:3/s))M499:1/ M498:6/args))M489:1/ M488:5/args)M481:1/ M480:5/'argsM473:1/ M472:6/hargs)M465:1/ M464:6/'hargsD461:D460:M458:11/'htmlescapeD457:D456:M454:5/'(letM452:11/1))))))))))D451:D450:M437:1/ M436:5/1))))M405:1/ M404:4/sep)M397:1/ M396:2/n)M387:1/ M386:2/s)M384:2/""M369:1/ M368:8/args))))M355:1/ M354:7/args)))M343:1/ M342:6/args))M333:1/ M332:5/args)M325:1/ M324:5/'argsD321:D320:M318:7/'rtokenD317:D316:M314:5/'(letM312:11/1))))))))))D310:D309:D308:D307:D306:D305:D304:D303:M291:1/ M290:5/1))))M259:1/ M258:4/sep)M251:1/ M250:2/n)M241:1/ M240:3/"")M225:1/ M224:8/args))))M211:1/ M210:7/args)))M199:1/ M198:6/args))M189:1/ M188:5/args)M181:1/ M180:5/'argsD177:D176:M174:6/'tokenM172:5/'(letD170:D169:D168:D167:D166:D165:D164:D163:D162:D161:D160:D159:D158:D157:D156:D155:D154:D153:M151:1/ M150:4/l)))M133:1/ M132:1/lM129:1/ M128:7/args)))M117:1/ M116:6/args))M107:1/ M106:5/args)M99:1/ M98:5/'argsD95:D94:M90:5/'(letM88:12/"\r\n\r\n"))M82:1/"M80:10/"Location:M70:5/'(letM68:36/title=\"polybook\"/></head><body>\n"M66:28/href=\"/raw/_/polybook.css\"M64:17/type=\"text/css\"M60:18/"<html><head><linkM56:5/'(letM54:22/charset=utf-8\r\n\r\n"M50:14/"Content-Type:M46:4/(letD45:D44:D43:D42:D41:D40:D39:D38:D37:D36:D35:D34:D33:D32:D31:D30:D29:D28:D27:D26:D25:D24:D23:D22:D21:D20:D19:D18:D17:D16:D15:D14:D13:D12:D11:D10:D9:D8:D7:D6:D5:D4:D3:D2:D1:D0:X

main-go.b 20 8944/";; main-go page does anything we might mess up and need to revert.\n\n(let 'stdheader \"Content-Type: text/html; charset=utf-8\\r\\n\\r\\n\" '\n(let 'stdpage \"<html><head><link rel=stylesheet type=\\\"text/css\\\" href=\\\"/raw/_/polybook.css\\\" title=\\\"polybook\\\"/></head><body>\\n\" '\n(let 'redirect (lambda 'target '(string \"Location: \" (car target) \"\\r\\n\\r\\n\")) '\n\n\n(let 'map \n  (lambda 'args\n    '(let 'self (car args)\n          '(let 'f (car (cdr args))\n                '(let 'l (car (cdr (cdr args)))\n                      '(if l\n                           '(cons (f (car l)) (self self f (cdr l)))\n                         'nil))))) '\n\n; chop up to the first instance of the char given\n(let 'token\n  (lambda 'args\n    '(let 'self (car args)\n          '(let 'sep (car (cdr args))\n                '(let 's (car (cdr (cdr args)))\n                      '(let 'n (car (cdr (cdr (cdr args))))\n                            '(if (eq n (size s)) '(list s \"\")\n                               '(let 'ch (sub s n)\n                                     '(if (eq ch sep)\n                                          '(list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1))))\n                                          '(self self sep s (+ n 1)))\n                                     ))))))) '\n\n; same, but last instance                     \n(let 'rtoken\n  (lambda 'args\n    '(let 'self (car args)\n          '(let 'sep (car (cdr args))\n                '(let 's (car (cdr (cdr args)))\n                      '(let 'n (car (cdr (cdr (cdr args))))\n                            '(if (eq n (- 0 1)) '(list \"\" s)\n                               '(let 'ch (sub s n)\n                                     '(if (eq ch sep)\n                                          '(list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1))))\n                                          '(self self sep s (- n 1)))\n                                     ))))))) '\n\n(let 'htmlescape\n  ; PERF\n  (lambda 'hargs\n    '(let 's (car hargs)\n         '(let 'hrec (lambda 'args\n                       '(let 'self (car args)\n                             '(let 'n (car (cdr args))\n                                   '(if (eq n (size s))\n                                        'nil\n                                      '(let 'ch (sub s n)\n                                            '(cons\n                                              (if (eq ch \"<\")\n                                                  '\"&lt;\"\n                                                '(if (eq ch \">\")\n                                                     '\"&gt;\"\n                                                   '(if (eq ch \"&\")\n                                                        '\"&amp;\"\n                                                      'ch)))\n                                              (self self (+ n 1))))))))\n               '(eval (cons string (hrec hrec 0)))))) '\n\n  ; figure out what we're doing based on the URL\n  ; (toss off the starting / char)\n(let 'url (car (cdr (token token \"/\" request.url 0))) '\n(let 'action_target (token token \"/\" url 0) '\n(let 'action (car action_target) '\n(let 'fulltarget (car (cdr action_target)) '\n  \n(let 'tabs (lambda 'args\n             '(let 'page (car args) '\n                   ; XXX make tabs\n                   (string \"<div class=\\\"tabs\\\">\"\n                           \"<span class=\\\"tab\\\"><a href=\\\"/view/_/\" page \"\\\">view</a></span> \"\n                           \"<span class=\\\"tab\\\"><a href=\\\"/edit/\" page \"\\\">edit</a></span> \"\n                           \"<span class=\\\"tab\\\"><a href=\\\"/history/\" page \"\\\">history</a></span> \"\n                           \"<span class=\\\"tab\\\"><a href=\\\"/run/\" page \"\\\">run</a></span> \"\n                           \"</div>\"))) '\n\n  (if (eq action \"edit\")\n      ;; need to fetch the source code for this page\n      ;; and put it in the textarea\n      '(let 'oldcontents (handle '(head fulltarget) '(_ nil)) '\n        (string stdheader stdpage\n                (tabs fulltarget) \"<p>\"\n               (if oldcontents\n                   '(string \"editing \" fulltarget \" ... \")\n                   '(string \"creating new page \" fulltarget \" ... \"))\n               \"<br/><b>Do not copy text from other websites without permission. It will be deleted.</b>\"\n               \"<form method=\\\"post\\\" action=\\\"/save/\" fulltarget \"\\\"><textarea rows=35 cols=120 name=\\\"contents\\\">\"\n               (xcase oldcontents\n                   '\"\"\n                   '(_ _ \"(was list data)\")\n                   '(_ \"(was quoted data)\")\n                   '(htmlescape oldcontents)\n                   '(string \"(was int \" oldcontents \")\")\n                   '(_ \"(was symbol)\")\n                   '\"(internal data)\")\n               \"</textarea>\\n\"\n               \"<input type=submit value=\\\"save\\\"></form>\"))\n\n    '(if (eq action \"save\")\n       ; might need to compile... \n       ; figure out the language based on the extension.\n      '(let 'base_ext (rtoken rtoken \".\" fulltarget (- (size fulltarget) 1)) '\n       (let 'base (car base_ext) '\n       (let 'ext (car (cdr base_ext)) '\n       (let 'dat form.contents '\n\n       (if (eq base \"\")\n           ;; if there was no . then ext holds the entire name. in this case\n           ;; just save.\n           '(let '_ (insert fulltarget dat) '\n                 ;; XXX goto revision\n                 (redirect (string \"/view/_/\" fulltarget)))\n\n         ;; otherwise we should compile, saving the source and compiled version\n         ;; (might do this recursively??  eg. prog.b.w)\n         ; get (and run to produce a closure) the compiler, if any\n         '(let 'compile (handle '(eval (head (string ext \":compile\"))) '(_ nil)) '\n            ; save source\n            (let '_ (insert fulltarget dat) '\n             (if compile\n               ;; if compilation fails, let exn propagate and don't overwrite the compiled page\n               ;; but we did already save the source.\n               '(let 'exe (compile dat) '\n               ; save executable\n                (let '_ (insert base exe) '\n                    ;; XXX should jump directly to the revision we inserted\n                    (redirect (string \"/view/_/\" fulltarget))\n                    )) ; compiler exists\n              '(redirect (string \"/view/_/\" fulltarget)))\n        ))))))) ; action save\n\n       '(if (eq action \"history\")\n            '(string\n              stdheader stdpage\n              (tabs fulltarget)\n              \"<p>history for \" fulltarget \" ...<hr/><p>\"\n              (string (map map (lambda 'args '(string \"<a href=\\\"/view/\" (car args) \"/\" fulltarget \"\\\">\" \n                                                      (car args) \"</a> \")) (history fulltarget))))\n\n       '(if (eq action \"view\")\n           '(let 'rev_target (token token \"/\" fulltarget 0) '\n            (let 'rev (car rev_target) '\n            (let 'target (car (cdr rev_target)) '     \n             (string\n              stdheader stdpage\n              (tabs target)\n              \"<p>viewing \" target (if (eq rev \"_\") '\"\" '(string \" @ \" rev)) \" ... <hr/><p>\"\n              (handle '(string \"<pre>\\n\" (htmlescape (if (eq rev \"_\") '(head target) '(read target (int rev)))) \"</pre>\\n\")\n                      '(_\n                        (string \"There is no symbol called <b>\" target \"</b>. \"\n                                \"Perhaps you'd like to <a href=\\\"/edit/\" target \"\\\">create it</a>?\")))))))\n\n       ;; like view, but no excess stuff/escaping (good for including CSS, for instance)\n       '(if (eq action \"raw\")\n           '(let 'rev_target (token token \"/\" fulltarget 0) '\n            (let 'rev (car rev_target) '\n            (let 'target (car (cdr rev_target)) '     \n             (string\n              stdheader (if (eq rev \"_\") '(head target) '(read target (int rev))) )\n             )))\n\n          ;; XXX protect against run main...? (= infinite loop)\n          ;; (or run main-go)\n         '(if (eq action \"run\")\n            '(string\n              stdheader stdpage\n              (tabs fulltarget)\n              \"<p>running \" fulltarget \" ... <hr/><p>\"\n              (handle '(let 'prog (head fulltarget)\n                          '(handle '(eval prog) '(msg (string \"<b>Runtime error</b>: \" msg))))\n                      '(_\n                        (string \"There is no symbol called <b>\" fulltarget \"</b>. \"\n                                \"Perhaps you'd like to <a href=\\\"/edit/\" fulltarget \"\\\">create it</a>?\"))))\n            \n\n          '(string stdheader \"unknown action!\")))\n\n       )))) ; action case analysis\n\n))))))))))))"
!19=M1238:12/preserved)\nI1237:4/dataI1237:1/ I1237:4/withI1237:1/ I1237:4/pageI1237:1/ I1237:4/editI1237:1/ M1234:2/toM1232:4/themM1230:4/sendI1229:5/maybeI1229:1/ I1229:5/couldI1229:1/ M1226:6/thoughM1225:2/  M1222:10/manually\nM1220:6/buttonM1218:4/backM1216:3/useI1215:3/canI1215:1/ I1215:5/(userI1215:1/ I1215:2/;;I1215:15/               I1215:10/anything\nI1215:1/ I1215:4/saveI1215:1/ M24:11/again\n(letI23:5/errorI23:1/ I23:4/testI23:1/ I23:2/;;I23:1/ I23:11/revert.\n))I23:1/ X
!17=M32:15/revert.\n\n(letD30:D29:D28:D27:D26:D25:D24:D23:X
!15=D1698:D1697:D1696:D1695:D1694:D1693:D1692:D1691:X
!12=M1277:15/               M1268:7/msg))))M1266:2/\"M1264:7/becauseM1262:6/failedD1261:D1260:M1258:2/\"M1257:52/                                                    M1256:12/fulltarget\nM1254:2/\"M1252:2/ofM1250:13/\"compilationM1249:52/                                                    M1248:9/(string\nM1247:51/                                                   M1246:8/'abort\nM1245:51/                                                   M1244:7/(list\nM1243:50/                                                  M1242:8/aborts\nM1240:4/thatM1238:7/programM1236:1/aD1235:D1234:D1233:D1232:M1230:6/returnM1228:1/;M1227:50/                                                  M1226:4/we\nM1224:4/thenM1222:6/fails,M1220:11/compilationD1219:D1218:M1216:2/ifM1214:1/;M1213:50/                                                  M1212:7/'(msg\nM1210:4/dat)M1208:9/'(compileM1206:7/(handleM1204:4/'exeM1202:5/'(letD1201:D1200:D1199:D1198:M24:13/failure\n(letI23:11/compilationI23:1/ I23:4/testI23:1/ I23:2/;;I23:1/ I23:13/revert.\n))))I23:1/ X
!8=M32:15/revert.\n\n(letD30:D29:D28:D27:D26:D25:D24:D23:M0:5/"\n;;X

main.b 10 956/";;                                 -*- lisp -*-\n; This is the initial (bootstrapping) program.\n; its role is to provide a minimal wiki interface\n; that will allow us to develop compilers for\n; better languages, that we can then use to\n; overwrite this program.\n\n(let 'nil '() '\n(let 'car (lambda 'args\n            '(xcase args 'noa '(arg u\n                                   (xcase arg 'error_car_nil '(h u h))))) '\n(let 'cdr (lambda 'args\n            '(xcase args 'nob '(arg u \n                                   (xcase arg 'error_cdr_nil '(u t t))))) '\n;; emergency revert code as soon as possible...\n;; this reverts only the compiled main-go page, not any source code.\n(if (eq request.url \"/emergency-revert\")\n   '(let '_ (insert \"main-go\" (read \"main-go\" (car (cdr (history \"main-go\"))))) '\n       \"OK, reverted\")\n\n   ;; otherwise run the main-go page (nil, car, cdr already defined)\n   '(eval (head \"main-go\"))\n))))"
!6=M238:30/analysis\n\n)))))))))))))))\n"M236:4/caseI235:6/actionI235:1/ I235:1/;I235:1/ I235:4/))))I235:7/       I235:16/action!\")))\n\nI235:1/ I235:9/\"unknownI235:1/ I235:9/stdheaderI235:1/ I235:8/'(stringI235:10/          I235:4/\n\nI235:12/            I235:15/it</a>?\"))))\nI235:1/ I235:13/\"\\\">createI235:1/ I235:10/fulltargetI235:1/ I235:17/href=\\\"/edit/\"I235:1/ I235:2/<aI235:1/ I235:2/toI235:1/ I235:4/likeI235:1/ I235:5/you'dI235:1/ I235:9/\"PerhapsI235:32/                                I235:4/\"\nI235:1/ I235:7/\"</b>.I235:1/ I235:10/fulltargetI235:1/ I235:5/<b>\"I235:1/ I235:6/calledI235:1/ I235:6/symbolI235:1/ I235:2/noI235:1/ I235:2/isI235:1/ I235:7/\"ThereI235:1/ I235:7/(stringI235:24/                        I235:5/'(_\nI235:22/                      I235:9/msg))))\nI235:1/ I235:2/\"I235:1/ I235:10/error</b>:I235:1/ I235:12/\"<b>RuntimeI235:1/ I235:7/(stringI235:1/ I235:5/'(msgI235:1/ I235:5/prog)I235:1/ M233:1/ M232:8/'(handleI232:26/                          I232:13/fulltarget)\nM230:5/(headM228:5/'progM226:5/'(letM224:7/(handleI224:14/              I224:12/<hr/><p>\"\nM222:3/...M220:2/\"M218:10/fulltargetI217:2/\"I217:1/ I217:12/\"<p>runningI217:14/              I217:13/fulltarget)\nI217:1/ I217:5/(tabsI217:14/              I217:9/stdpage\nI217:1/ I217:9/stdheaderI217:14/              I217:10/'(string\nI217:12/            I217:10/\"run\")\nI217:1/ I217:6/actionI217:1/ I217:3/(eqI217:1/ I217:4/'(ifI217:9/         I217:7/loop)\nI217:1/ I217:8/infiniteI217:1/ I217:2/(=I217:1/ I217:8/main...?I217:1/ M214:7/againstI213:7/protectI213:1/ I213:3/XXXI213:1/ M211:10/          M210:7/)))\n\nI210:13/             I210:3/)\nM208:6/rev)))I208:1/ I208:4/(intI208:1/ I208:6/targetI208:1/ I208:6/'(readI208:1/ I208:7/target)I208:1/ I208:6/'(headI208:1/ I208:6/\"_\")I208:1/ I208:3/revI208:1/ I208:3/(eqI208:1/ I208:3/(ifI208:1/ I208:9/stdheaderI208:14/              I208:9/(string\nI208:13/             I208:2/\nI208:5/     I208:1/'I208:1/ I208:12/rev_target))I208:1/ I208:4/(cdrI208:1/ I208:4/(carI208:1/ I208:7/'targetI208:1/ I208:4/(letI208:12/            I208:3/'\nI208:1/ I208:11/rev_target)I208:1/ I208:4/(carI208:1/ I208:4/'revI208:1/ I208:4/(letI208:12/            I208:3/'\nI208:1/ I208:2/0)I208:1/ I208:10/fulltargetI208:1/ I208:5/\"/\"I208:1/ I208:5/tokenI208:1/ I208:6/(tokenI208:1/ I208:11/'rev_targetI208:1/ I208:5/'(letI208:11/           I208:10/\"raw\")\nI208:1/ I208:6/actionI208:1/ I208:3/(eqI208:1/ I208:4/'(ifI207:11/instance)\nI207:1/ I207:3/forI207:1/ I207:4/CSS,I207:1/ I207:9/includingI207:1/ I207:3/forI207:1/ I207:5/(goodI207:1/ I207:14/stuff/escapingI207:1/ I207:6/excessI207:1/ I207:2/noI207:1/ I207:3/butI207:1/ I207:5/view,I207:1/ I207:4/likeI207:1/ I207:2/;;I207:7/       I207:20/it</a>?\")))))))\n\nI207:1/ I207:13/\"\\\">createI207:1/ I207:6/targetI207:1/ I207:17/href=\\\"/edit/\"I207:1/ I207:2/<aI207:1/ I207:2/toI207:1/ I207:4/likeI207:1/ I207:5/you'dI207:1/ I207:9/\"PerhapsI207:32/                                I207:4/\"\nI207:1/ I207:7/\"</b>.I207:1/ I207:6/targetI207:1/ I207:5/<b>\"I207:1/ I207:6/calledI207:1/ I207:6/symbolI207:1/ I207:2/noI207:1/ I207:2/isI207:1/ I207:7/\"ThereI207:1/ I207:7/(stringI207:24/                        I207:5/'(_\nI207:22/                      I207:16/\"</pre>\\n\")\nI207:1/ I207:7/rev))))I207:1/ I207:4/(intI207:1/ I207:6/targetI207:1/ I207:6/'(readI207:1/ I207:7/target)I207:1/ I207:6/'(headI207:1/ I207:6/\"_\")I207:1/ I207:3/revI207:1/ I207:3/(eqI207:1/ I207:3/(ifI207:1/ I207:11/(htmlescapeI207:1/ I207:12/\"<pre>\\n\"I207:1/ I207:8/'(stringI207:1/ I207:7/(handleI207:14/              I207:12/<hr/><p>\"\nI207:1/ I207:3/...I207:1/ I207:2/\"I207:1/ I207:5/rev))I207:1/ I207:2/\"I207:1/ I207:1/@I207:1/ I207:2/\"I207:1/ I207:8/'(stringI207:1/ I207:5/'\"\"I207:1/ I207:6/\"_\")I207:1/ I207:3/revI207:1/ I207:3/(eqI207:1/ I207:3/(ifI207:1/ I207:6/targetI207:1/ I207:2/\"I207:1/ I207:12/\"<p>viewingI207:14/              I207:9/target)\nI207:1/ I207:5/(tabsI207:14/              I207:9/stdpage\nI207:1/ I207:9/stdheaderI207:14/              I207:9/(string\nI207:13/             I207:2/\nI207:5/     I207:1/'I207:1/ I207:12/rev_target))I207:1/ I207:4/(cdrI207:1/ I207:4/(carI207:1/ I207:7/'targetI207:1/ I207:4/(letI207:12/            M204:11/rev_target)I203:4/(carI203:1/ I203:4/'revI203:1/ I203:4/(letI203:12/            I203:3/'\nI203:1/ I203:2/0)I203:1/ I203:10/fulltargetI203:1/ I203:5/\"/\"I203:1/ I203:5/tokenI203:1/ I203:6/(tokenI203:1/ I203:11/'rev_targetI203:1/ I203:5/'(letI203:11/           I203:11/\"view\")\nI203:1/ I203:6/actionI203:1/ I203:3/(eqI203:1/ I203:4/'(ifI203:7/       I203:18/fulltarget))))\n\nI203:1/ M200:4/\"))I199:6/\"</a>I199:1/ I199:5/args)I199:1/ I198:54/                                                      I198:2/\nM196:9/\"\\\">\"M194:10/fulltargetM192:5/\"/\"I191:5/args)I191:1/ I191:4/(carI191:1/ I191:17/href=\\\"/view/\"I191:1/ I191:4/\"<aI191:1/ I191:8/'(stringI191:1/ I191:5/'argsI191:1/ I191:7/(lambdaI191:1/ I191:3/mapI191:1/ I191:4/(mapI191:1/ I191:7/(stringI191:14/              I191:15/...<hr/><p>\"\nI191:1/ I191:2/\"I191:1/ I191:10/fulltargetI191:1/ I191:2/\"I191:1/ I191:3/forI191:1/ I191:12/\"<p>historyI191:14/              I191:13/fulltarget)\nI191:1/ I191:5/(tabsI191:14/              I191:9/stdpage\nI191:1/ I191:9/stdheaderI191:14/              I191:10/'(string\nI191:12/            I191:14/\"history\")\nI191:1/ I191:6/actionI191:1/ I191:3/(eqI191:1/ I191:4/'(ifI191:7/       I191:8/save\n\nI191:1/ I191:6/actionI191:1/ I191:1/;I191:1/ I191:7/)))))))I191:8/        I191:15/fulltarget)))\nI191:1/ I191:12/\"/view/_/\"I191:1/ I191:7/(stringI191:1/ I191:10/'(redirectI191:14/              I191:8/exists\nI191:1/ I191:8/compilerI191:1/ I191:1/;I191:1/ I191:2/))I191:20/                    I191:14/fulltarget))\nI191:1/ I191:12/\"/view/_/\"I191:1/ I191:7/(stringI191:1/ I191:9/(redirectI191:20/                    I191:10/inserted\nI191:1/ I191:2/weI191:1/ I191:8/revisionI191:1/ I191:3/theI191:1/ I191:2/toI191:1/ I191:8/directlyI191:1/ I191:4/jumpI191:1/ I191:6/shouldI191:1/ I191:3/XXXI191:1/ I191:2/;;I191:20/                    I191:3/'\nI191:1/ I191:4/exe)I191:1/ I191:4/baseI191:1/ I187:4/(letI187:15/               I187:12/executable\nI187:1/ I187:4/saveI187:1/ I187:1/;I187:15/               I187:3/'\nI187:1/ I187:7/msg))))I187:1/ I187:2/\"I187:1/ I187:7/becauseI187:1/ I187:6/failedI187:1/ I187:2/\"I187:52/                                                    I187:12/fulltarget\nI187:1/ I187:2/\"I187:1/ I187:2/ofI187:1/ I187:13/\"compilationI187:52/                                                    I187:9/(string\nI187:51/                                                   I187:8/'abort\nI187:51/                                                   I187:7/(list\nI187:50/                                                  I187:8/aborts\nI187:1/ I187:4/thatI187:1/ I187:7/programI187:1/ I187:1/aI187:1/ I187:6/returnI187:1/ I187:1/;I187:50/                                                  I187:4/we\nI187:1/ I187:4/thenI187:1/ I187:6/fails,I187:1/ I187:11/compilationI187:1/ I187:2/ifI187:1/ I187:1/;I187:50/                                                  I187:7/'(msg\nI187:1/ I187:4/dat)I187:1/ I187:9/'(compileI187:1/ I187:7/(handleI187:1/ I187:4/'exeI187:1/ M185:15/               M184:9/compile\nM182:3/(ifI182:13/             I182:3/'\nM180:4/dat)M178:10/fulltargetM176:7/(insertM174:2/'_M172:4/(letI172:12/            I172:8/source\nM170:4/saveM168:1/;I168:12/            I168:3/'\nI167:5/nil))I167:1/ I167:3/'(_I167:1/ I167:15/\":compile\")))I167:1/ I167:3/extI167:1/ I167:7/(stringI167:1/ I167:5/(headI167:1/ I167:6/'(evalI167:1/ I167:7/(handleI167:1/ I167:8/'compileI167:1/ I167:5/'(letI167:9/         I167:5/any\nI167:1/ I167:2/ifI167:1/ I167:9/compiler,I167:1/ I167:3/theI167:1/ I167:8/closure)I167:1/ I167:1/aI167:1/ I167:7/produceI167:1/ I167:2/toI167:1/ I167:3/runI167:1/ I167:4/(andI167:1/ I167:3/getI167:1/ I167:1/;I167:9/         I167:11/prog.b.w)\nI167:1/ I167:3/eg.I167:2/  I167:13/recursively??I167:1/ I167:4/thisI167:1/ I167:2/doI167:1/ I167:6/(mightI167:1/ I167:2/;;I167:9/         I167:9/version\nI167:1/ I165:3/andI165:1/ I165:6/sourceI165:1/ M162:6/savingM160:8/compile,I159:6/shouldI159:1/ I159:2/weI159:1/ I159:9/otherwiseI159:1/ I159:2/;;I159:9/         I159:17/fulltarget)))\n\nI159:1/ I159:12/\"/view/_/\"I159:1/ I159:7/(stringI159:1/ I159:9/(redirectI159:17/                 I159:10/revision\nI159:1/ I159:4/gotoI159:1/ I159:3/XXXI159:1/ I159:2/;;I159:17/                 I159:3/'\nI159:1/ I159:4/dat)I159:1/ I159:10/fulltargetI159:1/ I159:7/(insertI159:1/ I159:2/'_I159:1/ I159:5/'(letI159:11/           I159:7/save.\nI159:1/ I159:4/justI159:1/ I159:2/;;I159:11/           I159:6/case\nI159:1/ M156:2/inM154:5/name.M152:6/entireM150:3/theI149:5/holdsI149:1/ I149:3/extI149:1/ I149:4/thenI149:1/ I149:1/.I149:1/ I149:2/noI149:1/ I149:3/wasI149:1/ I149:5/thereI149:1/ I149:2/ifI149:1/ I149:2/;;I149:11/           I149:7/\"\")\nI149:1/ I149:4/baseI149:1/ I149:3/(eqI149:1/ I149:3/(ifI149:7/       I149:5/'\n\nI149:1/ I149:13/form.contentsI149:1/ I149:4/'datI149:1/ I149:4/(letI149:7/       I149:3/'\nI149:1/ I149:10/base_ext))I149:1/ I149:4/(cdrI149:1/ I149:4/(carI149:1/ I149:4/'extI149:1/ I149:4/(letI149:7/       I149:3/'\nI149:1/ I149:9/base_ext)I149:1/ I149:4/(carI149:1/ I149:5/'baseI149:1/ I149:4/(letI149:7/       I149:3/'\nI149:1/ I149:3/1))I149:1/ I149:11/fulltarget)I149:1/ I149:5/(sizeI149:1/ I149:2/(-I149:1/ I149:10/fulltargetI149:1/ I149:5/\".\"I149:1/ I149:6/rtokenI149:1/ I149:7/(rtokenI149:1/ I149:9/'base_extI149:1/ I149:5/'(letI149:6/      I149:12/extension.\nI149:1/ I149:3/theI149:1/ I149:2/onI149:1/ I149:5/basedI149:1/ I149:8/languageI149:1/ I149:3/theI149:1/ I149:3/outI149:1/ I149:6/figureI149:1/ I149:1/;I149:7/       I149:2/\nI149:1/ I149:10/compile...I149:1/ I149:2/toI149:1/ I149:4/needI149:1/ I149:5/mightI149:1/ I149:1/;I149:7/       I149:11/\"save\")\nI149:1/ I149:6/actionI149:1/ I149:3/(eqI149:1/ I149:4/'(ifI149:4/    I149:34/value=\\\"save\\\"></form>\"))\n\nI149:1/ I149:11/type=submitI149:1/ I149:8/\"<inputI149:15/               I149:20/\"</textarea>\\n\"\nI149:15/               I149:10/data)\")\nI149:1/ I149:12/'\"(internalI149:19/                   I149:12/symbol)\")\nI149:1/ I149:6/\"(wasI149:1/ I149:3/'(_I149:19/                   I149:8/\")\")\nI149:1/ I149:11/oldcontentsI149:1/ I149:2/\"I149:1/ I149:3/intI149:1/ I149:6/\"(wasI149:1/ I149:8/'(stringI149:19/                   I149:14/oldcontents)\nI149:1/ I149:12/'(htmlescapeI149:19/                   I149:10/data)\")\nI149:1/ I149:6/quotedI149:1/ I149:6/\"(wasI149:1/ I149:3/'(_I149:19/                   I149:10/data)\")\nI149:1/ I149:4/listI149:1/ I149:6/\"(wasI149:1/ I149:1/_I149:1/ I149:3/'(_I149:19/                   I149:7/'\"\"\nI149:19/                   I149:13/oldcontents\nI149:1/ I149:6/(xcaseI149:15/               I149:26/name=\\\"contents\\\">\"\nI149:1/ I149:8/cols=120I149:1/ I149:7/rows=35I149:1/ I149:16/\"\\\"><textareaI149:1/ I149:10/fulltargetI149:1/ I149:19/action=\\\"/save/\"I149:1/ I149:19/method=\\\"post\\\"I149:1/ I149:7/\"<formI149:15/               I149:16/deleted.</b>\"\nI149:1/ I149:2/beI149:1/ I149:4/willI149:1/ I149:2/ItI149:1/ I149:11/permission.I149:1/ I149:7/withoutI149:1/ I149:8/websitesI149:1/ I149:5/otherI149:1/ I149:4/fromI149:1/ I149:4/textI149:1/ I149:4/copyI149:1/ I149:3/notI149:1/ I149:12/\"<br/><b>DoI149:15/               I149:6/\"))\nI149:1/ I149:3/...I149:1/ I149:2/\"I149:1/ I149:10/fulltargetI149:1/ I149:2/\"I149:1/ I149:4/pageI149:1/ I149:3/newI149:1/ I149:10/\"creatingI149:1/ I149:8/'(stringI149:19/                   I149:5/\")\nI149:1/ I149:3/...I149:1/ I149:2/\"I149:1/ I149:10/fulltargetI149:1/ I149:2/\"I149:1/ I149:9/\"editingI149:1/ I149:8/'(stringI149:19/                   I149:13/oldcontents\nI149:1/ I149:3/(ifI149:15/               I149:9/\"<p>\"\nI149:1/ I149:11/fulltarget)I149:1/ I149:5/(tabsI149:16/                I149:9/stdpage\nI149:1/ I149:9/stdheaderI149:1/ I149:7/(stringI149:8/        I149:3/'\nI149:1/ I149:5/nil))I149:1/ I149:3/'(_I149:1/ I149:11/fulltarget)I149:1/ I149:6/'(headI149:1/ I149:7/(handleI149:1/ I149:12/'oldcontentsI149:1/ I149:5/'(letI149:6/      I149:10/textarea\nI149:1/ I149:3/theI149:1/ I149:2/inI149:1/ I149:2/itI149:1/ I149:3/putI149:1/ I149:3/andI149:1/ I149:2/;;I149:6/      I149:6/page\nI149:1/ I149:4/thisI149:1/ I149:3/forI149:1/ M146:6/sourceM144:3/theM142:5/fetchI141:2/toI141:1/ I141:4/needI141:1/ I141:2/;;I141:6/      I141:11/\"edit\")\nI141:1/ I141:6/actionI141:1/ I141:3/(eqI141:1/ I141:3/(ifI141:2/  I141:5/'\n\nI141:1/ I141:13/\"</div>\")))I141:27/                           I141:4/\"\nI141:1/ I141:21/\"\\\">run</a></span>I141:1/ I141:4/pageI141:1/ I141:16/href=\\\"/run/\"I141:1/ I141:20/class=\\\"tab\\\"><aI141:1/ I141:7/\"<spanI141:27/                           I141:4/\"\nI141:1/ I141:25/\"\\\">history</a></span>I141:1/ I141:4/pageI141:1/ I141:20/href=\\\"/history/\"I141:1/ I141:20/class=\\\"tab\\\"><aI141:1/ I141:7/\"<spanI141:27/                           I141:4/\"\nI141:1/ I141:22/\"\\\">edit</a></span>I141:1/ I141:4/pageI141:1/ I141:17/href=\\\"/edit/\"I141:1/ I141:20/class=\\\"tab\\\"><aI141:1/ I141:7/\"<spanI141:27/                           I141:4/\"\nI141:1/ I141:22/\"\\\">view</a></span>I141:1/ I141:4/pageI141:1/ I141:19/href=\\\"/view/_/\"I141:1/ I141:20/class=\\\"tab\\\"><aI141:1/ I141:7/\"<spanI141:27/                           I141:23/class=\\\"tabs\\\">\"\nI141:1/ I141:6/\"<divI141:1/ I141:7/(stringI141:19/                   I141:6/tabs\nI141:1/ I141:4/makeI141:1/ I141:3/XXXI141:1/ I141:1/;I141:19/                   I141:3/'\nI141:1/ I141:5/args)I141:1/ I141:4/(carI141:1/ I141:5/'pageI141:1/ I141:5/'(letI141:13/             I141:7/'args\nI141:1/ I141:7/(lambdaI141:1/ I141:5/'tabsI141:1/ I141:6/\n(letI141:2/  I141:3/'\nI141:1/ I141:15/action_target))I141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:11/'fulltargetI141:1/ I141:7/'\n(letI141:1/ I141:14/action_target)I141:1/ I141:4/(carI141:1/ I141:7/'actionI141:1/ I141:7/'\n(letI141:1/ I141:2/0)I141:1/ I141:3/urlI141:1/ I141:5/\"/\"I141:1/ I141:5/tokenI141:1/ I141:6/(tokenI141:1/ I141:14/'action_targetI141:1/ I141:7/'\n(letI141:1/ I141:4/0)))I141:1/ I141:11/request.urlI141:1/ I141:5/\"/\"I141:1/ I141:5/tokenI141:1/ I141:6/(tokenI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:4/'urlI141:1/ I141:11/char)\n(letI141:1/ I141:1//I141:1/ I141:8/startingI141:1/ I141:3/theI141:1/ I141:3/offI141:1/ I141:5/(tossI141:1/ I141:1/;I141:2/  I141:5/URL\nI141:1/ I141:3/theI141:1/ I141:2/onI141:1/ I141:5/basedI141:1/ I141:5/doingI141:1/ I141:5/we'reI141:1/ I141:4/whatI141:1/ I141:3/outI141:1/ I141:6/figureI141:1/ I141:1/;I141:2/  I141:5/'\n\nI141:1/ I141:7/0))))))I141:1/ I141:4/hrecI141:1/ I141:5/(hrecI141:1/ I141:6/stringI141:1/ I141:5/(consI141:1/ I141:6/'(evalI141:15/               I141:11/1))))))))\nI141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:4/selfI141:1/ I141:5/(selfI141:46/                                              I141:8/'ch)))\nI141:54/                                                      I141:12/'\"&amp;\"\nI141:56/                                                        I141:8/\"&\")\nI141:1/ I141:2/chI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:51/                                                   I141:11/'\"&gt;\"\nI141:53/                                                     I141:8/\">\")\nI141:1/ I141:2/chI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:48/                                                I141:11/'\"&lt;\"\nI141:50/                                                  I141:8/\"<\")\nI141:1/ I141:2/chI141:1/ I141:3/(eqI141:1/ I141:3/(ifI141:46/                                              I141:8/'(cons\nI141:44/                                            I141:4/n)\nI141:1/ I141:1/sI141:1/ I141:4/(subI141:1/ I141:3/'chI141:1/ I141:5/'(letI141:38/                                      I141:6/'nil\nI141:40/                                        I141:5/s))\nI141:1/ I141:5/(sizeI141:1/ I141:1/nI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:35/                                   I141:8/args))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'nI141:1/ I141:5/'(letI141:29/                             I141:7/args)\nI141:1/ I141:4/(carI141:1/ I141:5/'selfI141:1/ I141:5/'(letI141:23/                       I141:7/'args\nI141:1/ I141:7/(lambdaI141:1/ I141:5/'hrecI141:1/ I141:5/'(letI141:9/         I141:8/hargs)\nI141:1/ I141:4/(carI141:1/ I141:2/'sI141:1/ I141:5/'(letI141:4/    I141:8/'hargs\nI141:1/ I141:7/(lambdaI141:2/  I141:6/PERF\nI141:1/ I141:1/;I141:2/  I141:13/'htmlescape\nI141:1/ I141:9/'\n\n(letI141:1/ I141:7/)))))))I141:37/                                     I141:6/1)))\nI141:1/ I141:1/nI141:1/ I141:2/(-I141:1/ I141:1/sI141:1/ I141:3/sepI141:1/ I141:4/selfI141:1/ I141:6/'(selfI141:42/                                          I141:7/1))))\nI141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:2/s)I141:1/ I141:5/(sizeI141:1/ I141:2/(-I141:1/ I141:2/1)I141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:1/sI141:1/ I141:7/(substrI141:1/ I141:2/n)I141:1/ I141:1/0I141:1/ I141:1/sI141:1/ I141:7/(substrI141:1/ I141:6/'(listI141:42/                                          I141:6/sep)\nI141:1/ I141:2/chI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:37/                                     I141:4/n)\nI141:1/ I141:1/sI141:1/ I141:4/(subI141:1/ I141:3/'chI141:1/ I141:5/'(letI141:31/                               I141:4/s)\nI141:1/ I141:4/\"\"I141:1/ I141:6/'(listI141:1/ I141:3/1))I141:1/ I141:1/0I141:1/ I141:2/(-I141:1/ I141:1/nI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:28/                            I141:10/args))))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'nI141:1/ I141:5/'(letI141:22/                      I141:9/args)))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'sI141:1/ I141:5/'(letI141:16/                I141:8/args))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:4/'sepI141:1/ I141:5/'(letI141:10/          I141:7/args)\nI141:1/ I141:4/(carI141:1/ I141:5/'selfI141:1/ I141:5/'(letI141:4/    I141:7/'args\nI141:1/ I141:7/(lambdaI141:2/  I141:9/'rtoken\nI141:1/ I141:6/\n(letI141:21/                     I141:8/instanceI141:1/ I141:4/lastI141:1/ I141:3/butI141:1/ I141:5/same,I141:1/ I141:6/'\n\n;I141:1/ I141:7/)))))))I141:37/                                     I141:6/1)))\nI141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:1/sI141:1/ I141:3/sepI141:1/ I141:4/selfI141:1/ I141:6/'(selfI141:42/                                          I141:7/1))))\nI141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:2/s)I141:1/ I141:5/(sizeI141:1/ I141:2/(-I141:1/ I141:2/1)I141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:1/sI141:1/ I141:7/(substrI141:1/ I141:2/n)I141:1/ I141:1/0I141:1/ I141:1/sI141:1/ I141:7/(substrI141:1/ I141:6/'(listI141:42/                                          I141:6/sep)\nI141:1/ I141:2/chI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:37/                                     I141:4/n)\nI141:1/ I141:1/sI141:1/ I141:4/(subI141:1/ I141:3/'chI141:1/ I141:5/'(letI141:31/                               I141:7/\"\")\nI141:1/ I141:1/sI141:1/ I141:6/'(listI141:1/ I141:3/s))I141:1/ I141:5/(sizeI141:1/ I141:1/nI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:28/                            I141:10/args))))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'nI141:1/ I141:5/'(letI141:22/                      I141:9/args)))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'sI141:1/ I141:5/'(letI141:16/                I141:8/args))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:4/'sepI141:1/ I141:5/'(letI141:10/          I141:7/args)\nI141:1/ I141:4/(carI141:1/ I141:5/'selfI141:1/ I141:5/'(letI141:4/    I141:7/'args\nI141:1/ I141:7/(lambdaI141:2/  I141:8/'token\nI141:1/ I141:11/given\n(letI141:1/ I141:4/charI141:1/ I141:3/theI141:1/ I141:2/ofI141:1/ I141:8/instanceI141:1/ I141:5/firstI141:1/ I141:3/theI141:1/ I141:2/toI141:1/ I141:2/upI141:1/ I141:4/chopI141:1/ I141:6/'\n\n;I141:1/ I141:9/'nil)))))I141:25/                         I141:6/l)))\nI141:1/ I141:4/(cdrI141:1/ I141:1/fI141:1/ I141:4/selfI141:1/ I141:5/(selfI141:1/ I141:3/l))I141:1/ I141:4/(carI141:1/ I141:2/(fI141:1/ I141:6/'(consI141:27/                           I141:3/l\nI141:1/ I141:4/'(ifI141:22/                      I141:9/args)))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'lI141:1/ I141:5/'(letI141:16/                I141:8/args))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'fI141:1/ I141:5/'(letI141:10/          I141:7/args)\nI141:1/ I141:4/(carI141:1/ I141:5/'selfI141:1/ I141:5/'(letI141:4/    I141:7/'args\nI141:1/ I141:7/(lambdaI141:2/  I141:2/\nI141:1/ I141:4/'mapI141:1/ I141:11/'\n\n\n(letI141:1/ I141:18/\"\\r\\n\\r\\n\"))I141:1/ I141:7/target)I141:1/ I141:4/(carI141:1/ I141:2/\"I141:1/ I141:11/\"Location:I141:1/ I141:8/'(stringI141:1/ I141:7/'targetI141:1/ I141:7/(lambdaI141:1/ I141:9/'redirectI141:1/ I141:7/'\n(letI141:1/ I141:42/title=\\\"polybook\\\"/></head><body>\\n\"I141:1/ I141:32/href=\\\"/raw/_/polybook.css\\\"I141:1/ I141:21/type=\\\"text/css\\\"I141:1/ I141:14/rel=stylesheetI141:1/ I141:19/\"<html><head><linkI141:1/ I141:8/'stdpageI141:1/ I141:7/'\n(letI141:1/ I141:27/charset=utf-8\\r\\n\\r\\n\"I141:1/ I141:10/text/html;I141:1/ I141:15/\"Content-Type:I141:1/ I141:10/'stdheaderI141:1/ I141:7/'\n(letI141:1/ X
!3=M708:10/char\n(letX

polybook.css 5 480/"       .tabs { border-bottom : 1px solid #000000 ; }\n       .tab { font : 11px Verdana,Arial,Helvetica ; padding : 2px 4px 4px 2px ; margin-right : 4px ; border-top : 1px solid #000000 ; border-left : 1px solid #000000 ; border-right : 1px solid #000000 ; }\n\n       A:link { color: #4444DD }\n       A:visited { color: #9999FF }\n       A:active { color: #DDDD44 }\n\n       BODY { font : 12px Verdana,Arial,Helvetica ; }\n       P { font : 12px Verdana,Arial,Helvetica ; }\n"

test 62 118/(let 'plus (lambda 'fnarg_ '(xcase fnarg_ 'noarg '(x fnarg_ (xcase fnarg_ 'noarg '(y fnarg_ (+ x y)))))) '(plus 40 2))
!60=M38:9/z))))))))M36:1/yM34:1/xM32:2/(+M30:6/fnarg_M28:3/'(zI27:6/'noargI27:1/ I25:6/(xcaseI25:1/ I25:6/fnarg_I25:1/ D3:D2:D1:D0:X
!55=M40:6/lambdaD39:D38:D37:D36:D35:D34:D33:D32:D31:D30:D29:D28:D27:D26:D25:D24:D23:D22:D21:D20:D19:D18:D17:D16:D15:D14:D13:D12:D11:D10:D9:D8:D7:D6:D5:D4:D3:D2:D1:D0:X
!52=M0:12/"Failure!"))I0:1/ I0:9/'(reverseI0:1/ I0:7/world!"I0:1/ I0:8/'"Hello,I0:1/ I0:1/xI0:1/ I0:3/(ifX
!47=X
!45=M10:1/0D9:D8:D7:D6:D5:D4:D3:D2:D1:D0:X

test.b 54 8/"lambda"

test.w 61 201/";; just a test -- this can't run due to undefined symbols!\n\n(let plus (fn (x y) (+ x y))\n  (plus 40 2))\n\n; (fn (x y z) (+ x y z))\n\n; (if x\n;   \"Hello, world!\"\n;   (reverse \"Failure!\"))\n"
!59=M44:15/symbols!\n\n(fnD42:D41:D40:D39:D38:D37:D36:D35:D34:D33:D32:D31:D30:D29:D28:D27:D26:D25:D24:D23:D22:D21:X
!56=X
!53=X
!51=M44:10/world!\"\nM40:3/x\nM36:12/symbols!\n\nD34:D33:D32:D31:D30:D29:D28:D27:D26:D25:D24:D23:D22:D21:X
!46=X
!44=M30:11/world!\"\n;M26:4/x\n;M22:15/first\n\n0\n\n;I21:4/testI21:1/ I21:7/simplerI21:1/ I21:1/aI21:1/ I21:7/perhapsI21:1/ I21:14/symbols!\n\n;;I21:1/ X
!41=X
!38=X
!37=X
!34=X
!31=X
!28=X
!25=X
!24=M41:2/  M40:10/world!\"\nM37:2/  M36:3/x\nM34:15/symbols!\n\n(ifD32:D31:D30:D29:D28:D27:D26:D25:D24:D23:D22:D21:M0:5/"\n;;X

w%3Acompile 58 1933/(let 'nil '() '(let 'car (lambda 'args '(xcase args 'noa '(arg u (xcase arg 'werr_car_nil '(h u h))))) '(let 'cdr (lambda 'args '(xcase args 'nob '(arg u (xcase arg 'werr_cdr_nil '(u t t))))) '(lambda 'args '(let 'prog (parse (car args)) '(let 'map (lambda 'args '(let 'self (car args) '(let 'f (car (cdr args)) '(let 'l (car (cdr (cdr args))) '(if l '(cons (f (car l)) (self self f (cdr l))) 'nil))))) '(let 'nth (lambda 'args '(let 'self (car args) '(let 'n (car (cdr args)) '(let 'l (car (cdr (cdr args))) '(if (eq n 0) '(car l) '(nth nth (- n 1) (cdr l))))))) '(let 'translate (lambda 'args '(let 'self (car args) '(let 'exp (car (cdr args)) '(xcase exp 'exp '(h t (xcase h 'no 'no 'no 'no 'no '(theprim (if (eq theprim "lambda") '(cons h (cons (quote (self self (car t))) (cons (quote (self self (car (cdr t)))) nil))) '(if (eq theprim "if") '(list h (self self (car t)) (quote (self self (car (cdr t)))) (quote (self self (car (cdr (cdr t)))))) '(if (eq theprim "let") '(list h (quote (car t)) (self self (car (cdr t))) (quote (self self (car (cdr (cdr t)))))) '(if (eq theprim "fn") '(let 'argname "fnarg_" '(let 'genargs (lambda 'ga_args '(let 'ga_self (car ga_args) '(let 'l (car (cdr ga_args)) '(let 'bod (car (cdr (cdr ga_args))) '(xcase l 'bod '(thisarg rest (list (parse "xcase") (parse argname) (quote (parse "noarg")) (quote (list thisarg (parse argname) (ga_self ga_self rest bod)))))))))) '(list (parse "lambda") (quote (parse argname)) (quote (genargs genargs (car t) (car (cdr t))))))) '(if (eq theprim "xcase") '(list h (self self ob) (quote (self self (nth 1 t))) (quote (self self (nth 2 t))) (quote (self self (nth 3 t))) (quote (self self (nth 4 t))) (quote (self self (nth 5 t))) (quote (self self (nth 6 t)))) '(cons h (map map (lambda 'args '(self self (car args))) t)))))))))) '(q (abort "quote not allowed in W")) 'exp 'exp '(s (if (eq s "nil") '(quote nil) 'exp)))))) '(translate translate prog)))))))))
!50=M468:8/thisarg)I467:6/(parseI467:1/ X
!43=M622:10/t)))))))))D510:D509:D508:D507:D506:D505:D504:D503:D502:D501:D500:D499:D498:D497:D496:D495:D494:D493:D492:D491:D490:D489:D488:D487:D486:D485:D484:D483:D482:D481:D480:D479:D478:D477:D476:D475:D474:D473:D472:D471:D470:D469:D468:D467:D466:D465:D464:D463:D462:D461:D460:D459:D458:D457:D456:D455:D454:D453:D452:D451:D450:D449:D448:D447:D446:D445:D444:D443:D442:D441:D440:D439:D438:D437:D436:D435:D434:D433:D432:D431:D430:D429:D428:D427:D426:D425:D424:D423:D422:D421:D420:D419:D418:D417:D416:D415:D414:D413:D412:D411:D410:D409:D408:D407:D406:D405:D404:D403:D402:D401:D400:D399:D398:D397:D396:D395:D394:D393:D392:D391:D390:D389:D388:D387:D386:D385:X
!40=M536:11/100))))))))D534:D533:D532:D531:M150:4/(letM78:7/"uhhh")M76:6/(abortM74:2/'_D72:D71:X
!36=M76:3/999D74:D73:X
!33=M58:14/'error_cdr_nilM28:14/'error_car_nilX
!30=M528:12/prog))))))))M74:6/args))M72:4/(carI71:6/(parseI71:1/ I71:5/'progI71:1/ X
!27=M532:13/prog)))))))))I531:9/translateI531:1/ I531:11/'(translateI531:1/ X
!23=D78:D77:D76:D75:D74:D73:D72:D71:D70:D69:D68:D67:D66:D65:M0:5/'(letI0:1/ I0:6/args))I0:1/ I0:4/(carI0:1/ I0:6/(parseI0:1/ I0:5/'progI0:1/ I0:5/'(letI0:1/ I0:5/'argsI0:1/ I0:7/(lambdaX

w%3Acompile.b 57 6845/";                           -*- lisp -*-\n; compiler from W to B, written in B\n\n; this \"compiler\" is mostly just desugaring: the\n; B language supports most of the features we\n; need. (and they both use the same abstract syntax).\n\n; features to implement:\n; progn (not needed yet)\n; let auto-quoting    (DONE)\n; if auto-quoting     (DONE)\n; lambda auto-quoting (DONE)\n; implement nil       (DONE)\n; xcase auto-quoting  (DONE)\n\n; actually I guess we should completely eliminate quote?\n; if we see quote in the source program we pretty much\n; don't have any idea if what's under that will ever be\n; evaluated, so we don't know how we're supposed to translate\n; it.\n; better to think of W as being a call-by-name ML-like\n; language.\n\n(let 'nil '() '\n(let 'car (lambda 'args\n            '(xcase args 'noa '(arg u\n                                   (xcase arg 'werr_car_nil '(h u h))))) '\n(let 'cdr (lambda 'args\n            '(xcase args 'nob '(arg u \n                                   (xcase arg 'werr_cdr_nil '(u t t))))) '\n\n(lambda 'args '\n(let 'prog (parse (car args)) '\n; (let '_ 999 '\n\n(let 'map \n  (lambda 'args\n    '(let 'self (car args)\n          '(let 'f (car (cdr args))\n                '(let 'l (car (cdr (cdr args)))\n                      '(if l\n                           '(cons (f (car l)) (self self f (cdr l)))\n                         'nil))))) '\n\n;; (let 'map (lambda 'args (map (cons map args))) '\n\n(let 'nth\n  (lambda 'args\n   '(let 'self (car args) '\n      (let 'n (car (cdr args)) '\n        (let 'l (car (cdr (cdr args))) '\n          (if (eq n 0)\n              '(car l)\n            '(nth nth (- n 1) (cdr l))))))) '\n\n;;(let 'nth (lambda 'args (nth (cons nth args))) '\n\n(let 'translate\n  (lambda 'args '\n    (let 'self (car args) '\n      (let 'exp (car (cdr args)) '\n           ; what kind of expression is it?\n           (xcase exp\n             'exp ; empty list\n             '(h t  ; nonempty list\n                    ; need to case analyze which prim this is\n                    ; in essence \n                 \n                 (xcase h\n                        ; it has to be a symbol, or something's wrong\n                        'no 'no 'no 'no 'no\n                        '(theprim \n                         (if (eq theprim \"lambda\") '\n                             ; t: arg body\n                             (cons h\n                                   (cons (quote (self self (car t)))\n                                         (cons (quote (self self (car (cdr t))))\n                                               nil))) '\n                         (if (eq theprim \"if\") '\n                             ; t: cond tbod fbod\n                             (list h (self self (car t))\n                                     (quote (self self (car (cdr t))))\n                                     (quote (self self (car (cdr (cdr t)))))) '\n                                   \n                         (if (eq theprim \"let\") '\n                             ; t: sym value body\n                             (list h (quote (car t))\n                                     (self self (car (cdr t)))\n                                     (quote (self self (car (cdr (cdr t)))))) '\n\n                         ;; (fn (arg1 arg2 ... argn) body)\n                         (if (eq theprim \"fn\") '\n                             ; t args body\n                             ; XXX need gensym\n                             (let 'argname \"fnarg_\" '\n                               (let 'genargs\n                                 (lambda 'ga_args '\n                                   (let 'ga_self (car ga_args) '\n                                   (let 'l (car (cdr ga_args)) '\n                                   (let 'bod (car (cdr (cdr ga_args))) '\n                                   (xcase l\n                                    ; no more args...\n                                    'bod\n                                    ; one arg ...\n                                    '(thisarg rest\n                                      (list (parse \"xcase\")\n                                         ; argument tail always rebound as the same thing (argname)\n                                         (parse argname)\n                                         ; no more actual args? oops!\n                                         (quote (parse \"noarg\")) ;; XXX abort?\n                                         ; otherwise, bind this arg and recurse\n                                         (quote (list thisarg (parse argname) (ga_self ga_self rest bod))))\n                                      )\n                                     ) ; xcase on remaining arguments\n                                    ))) ; lets\n                                  ) '\n\n                                ; XXX could use 'symbol' constructor\n                               (list (parse \"lambda\")\n                                     (quote (parse argname))\n                                     ;; bind args and then exec body...\n                                     (quote (genargs genargs (car t) (car (cdr t))))))) '\n\n                         (if (eq theprim \"xcase\") '\n                             ; t: ob nb lb qb sb ib yb\n                             (list h (self self ob)\n                                   ;; XXX shouldn't require all cases to be present\n                                     (quote (self self (nth 1 t))) ; nb\n                                     (quote (self self (nth 2 t))) ; lb\n                                     (quote (self self (nth 3 t))) ; qb\n                                     (quote (self self (nth 4 t))) ; sb\n                                     (quote (self self (nth 5 t))) ; ib\n                                     (quote (self self (nth 6 t))) ; yb\n                                     ) '\n\n                           ;; otherwise, assume it is eager...\n                           (cons h\n                                 (map map (lambda 'args '(self self (car args))) t))\n                         )))))))\n                 ) ; nonempty list\n\n              '(q (abort \"quote not allowed in W\"))\n\n              'exp ; string\n              'exp ; int\n              '(s \n                ; some symbols we'll macro-expand\n                (if (eq s \"nil\") '\n                    (quote nil) '\n\n                  ; the rest we'll leave alone...\n                  ; could fail on prims that we macro-expand\n                  ; (let, if, lambda, xcase)\n                  ; because those cannot be used in a higher-order\n                  ; way now..\n                  exp))\n               ))))\n\n  ;; then translate it.\n  '(translate translate prog)\n  ;; 100\n\n)))))\n)))"
!49=M972:8/thisarg)I971:6/(parseI971:1/ X
!48=M1406:20/100\n\n)))))\n)))\n"M1387:7/       M1386:9/exp))\n\tM1385:2/  M1384:11/now..\n\t\tM1379:2/  M1378:18/higher-order\n\t\tM1361:2/  M1360:12/xcase)\n\t\tM1351:2/  M1350:18/macro-expand\n\t\tM1335:2/  M1334:14/alone...\n\t\tM1323:2/  M1322:9/'\n\n\t\tM1317:4/    M1316:7/'\n\t\tM1308:21/macro-expand\n\t\t(ifD1307:D1306:M1298:7/\n\t\t;D1297:D1296:M1293:6/      M1292:7/int\n\tM1287:6/      M1286:10/string\n\tM1281:6/      M1280:11/W\"))\n\n\tM1267:6/      M1266:10/list\n\n\tM1259:1/ M1258:12/))))))\n\t\tM1257:1/ M1256:11/t))\n\t\t\tM1239:1/ M1238:11/h\n\t\t\t\tM1235:3/   M1234:16/eager...\n\t\t\tM1223:3/   M1222:11/'\n\n\t\t\tM1219:5/     M1218:12/yb\n\t\t\t\tM1203:5/     M1202:12/ib\n\t\t\t\tM1187:5/     M1186:12/sb\n\t\t\t\tM1171:5/     M1170:12/qb\n\t\t\t\tM1155:5/     M1154:12/lb\n\t\t\t\tM1139:5/     M1138:12/nb\n\t\t\t\tM1123:5/     M1122:17/present\n\t\t\t\tM1105:3/   M1104:13/ob)\n\t\t\t\tM1095:5/     M1094:10/yb\n\t\t\tM1077:5/     M1076:9/'\n\t\t\tD1067:D1066:M1064:12/\n\n\n\t\t\tM1062:5/HERE!M1060:7/EDITINGM1058:7/STOPPEDM1057:39/                                       M1056:9/args...\nD1054:D1053:D1052:D1051:D1050:D1049:D1048:D1047:D1046:D1045:D1044:D1043:D1042:D1041:D1040:D1039:M1035:34/                                  M1034:10/argname)\nD1031:D1030:M763:5/     M762:14/t)))\n\t\t\t\tM753:5/     M752:13/t))\n\t\t\t\tM743:5/     M742:12/body\n\t\t\tM733:5/     M732:9/'\n\t\t\tM723:1/ M722:8/\n\t\t\tM721:3/   M720:11/'\n\t\t\t\tM705:5/     M704:15/t))))\n\t\t\t\tM693:5/     M692:13/t))\n\t\t\t\tM681:5/     M680:12/fbod\n\t\t\tM671:5/     M670:9/'\n\t\t\tM661:1/ M660:9/'\n\t\t\tM657:7/       M656:17/t))))\n\t\t\t\t\tM643:1/ M642:16/t)))\n\t\t\t\t\tM631:3/   M630:11/h\n\t\t\t\tM627:5/     M626:12/body\n\t\t\tM619:5/     M618:9/'\n\t\t\tM609:1/ M608:8/\n\t\t\tM606:20/'no\n\t\t\t'(theprimD605:D604:M596:16/wrong\n\t\t\t'noD595:D594:M576:10/h\n\t\t\t;D575:D574:M571:1/ M570:6/\n\t\tM569:1/ M568:6/\n\t\tM561:12/            M560:6/is\n\tM543:12/            M542:8/list\n\tM533:5/     M532:8/list\n\tM525:5/     M524:7/exp\n\tM521:3/   M520:7/it?\n\tM507:3/   M506:5/'\n\tM445:4/    M444:6/l)\n\tM441:6/      M440:6/0)\n\tM433:2/  M432:5/'\n\tM420:9/'\n\t(letD419:D418:X
!42=M1038:11/'\n\n\t\t\tD1036:D1035:D1034:D1033:D1032:D1031:D1030:D1029:D1028:D1027:D1026:D1025:D1024:D1023:D1022:D1021:D1020:D1019:D1018:D1017:D1016:D1015:D1014:D1013:D1012:D1011:D1010:D1009:D1008:D1007:D1006:D1005:D1004:D1003:D1002:D1001:D1000:D999:D998:D997:D996:D995:D994:D993:D992:D991:D990:D989:D988:D987:D986:D985:D984:D983:D982:D981:D980:D979:D978:D977:D976:D975:D974:D973:D972:D971:D970:D969:D968:D967:D966:D965:D964:D963:D962:D961:D960:D959:D958:D957:D956:D955:D954:D953:D952:D951:D950:D949:D948:D947:D946:D945:D944:D943:D942:D941:D940:D939:D938:D937:D936:D935:D934:D933:D932:D931:D930:D929:D928:D927:D926:D925:D924:D923:D922:D921:D920:D919:D918:D917:D916:D915:D914:D913:D912:D911:D910:D909:D908:D907:D906:D905:D904:D903:D902:D901:D900:D899:D898:D897:D896:D895:D894:D893:D892:D891:D890:D889:D888:D887:D886:D885:D884:D883:D882:D881:D880:D879:D878:D877:D876:D875:D874:D873:D872:D871:D870:D869:D868:D867:D866:D865:D864:D863:D862:D861:D860:D859:D858:D857:D856:D855:D854:D853:D852:D851:D850:D849:D848:D847:D846:D845:D844:D843:D842:D841:D840:D839:D838:D837:D836:D835:D834:D833:D832:D831:D830:D829:D828:D827:D826:D825:D824:D823:D822:D821:D820:D819:D818:D817:D816:D815:D814:D813:D812:D811:D810:D809:D808:D807:D806:D805:D804:D803:D802:D801:D800:D799:D798:D797:D796:D795:D794:D793:D792:D791:D790:D789:D788:D787:D786:D785:D784:D783:D782:D781:D780:D779:D778:D777:D776:D775:D774:D773:D772:D771:D770:D769:M22:6/W\n\n;X
!39=M1105:3/   D1104:D1103:I1098:1/ I1098:1/;M398:4/(letM397:4/    M306:9/\"uhhh\")M304:6/(abortM302:2/'_M300:7/'\n(letM290:4/(letI289:4/'\n;I289:1/ X
!35=M308:3/999D306:D305:X
!32=M278:14/'error_cdr_nilM246:14/'error_car_nilX
!29=M1106:21/prog\n\n)))))\n)))\n"D306:D305:D304:D303:D302:D301:M292:7/'\n(letD290:D289:X
!26=M1098:22/prog)\n\n)))))\n)))\n"D1097:D1096:D1091:D1090:X
!22=D298:D297:D296:D295:D294:D293:D292:D291:D290:D289:D288:D287:D286:D285:M218:9/'\n\n(letI217:6/args))I217:1/ I217:4/(carI217:1/ I217:6/(parseI217:1/ I217:5/'progI217:1/ I217:7/'\n(letI217:1/ I217:5/'argsI217:1/ I217:20/language.\n\n(lambdaI217:1/ X

