WPDB
11
b%3Acompile 2 51/(##CLOSURE## () "s" (parse (xcase s 'no '(h _ h))))

b%3Acompile.b 1 115/";; b \"compiler\" is trivial -- it's just the built-in XESP parser\n(lambda 's '(parse (xcase s 'no '(h _ h))))\n"

main 11 358/(let 'nil '() '(let 'car (lambda 'args '(xcase args 'noa '(arg u (xcase arg 'error_car_nil '(h u h))))) '(let 'cdr (lambda 'args '(xcase args 'nob '(arg u (xcase arg 'error_cdr_nil '(u t t))))) '(if (eq request.url "/emergency-revert") '(let '_ (insert "main-go" (read "main-go" (car (cdr (history "main-go"))))) '"OK, reverted") '(eval (head "main-go"))))))
!7=M102:30/action!"))))))))))))))))))))))M100:8/"unknownI99:9/stdheaderI99:1/ I99:8/'(stringI99:1/ I99:12/it</a>?"))))I99:1/ I99:10/"\">createI99:1/ I99:10/fulltargetI99:1/ I99:14/href=\"/edit/"I99:1/ I99:2/<aI99:1/ I99:2/toI99:1/ I99:4/likeI99:1/ I99:5/you'dI99:1/ I99:8/"PerhapsI99:1/ I99:1/"I99:1/ I99:6/"</b>.I99:1/ I99:10/fulltargetI99:1/ I99:4/<b>"I99:1/ I99:6/calledI99:1/ I99:6/symbolI99:1/ I99:2/noI99:1/ I99:2/isI99:1/ I99:6/"ThereI99:1/ I99:7/(stringI99:1/ I99:3/'(_I99:1/ I99:7/msg))))I99:1/ I99:1/"I99:1/ I99:10/error</b>:I99:1/ I99:11/"<b>RuntimeI99:1/ I99:7/(stringI99:1/ I99:5/'(msgI99:1/ I99:5/prog)I99:1/ M96:8/'(handleM94:11/fulltarget)M92:5/(headI91:5/'progI91:1/ I91:5/'(letI91:1/ I91:7/(handleI91:1/ I91:9/<hr/><p>"I91:1/ I91:3/...I91:1/ I91:1/"I91:1/ I91:10/fulltargetI91:1/ I91:1/"I91:1/ I91:11/"<p>runningI91:1/ I91:11/fulltarget)I91:1/ I91:5/(tabsI91:1/ I91:7/stdpageI91:1/ I91:9/stdheaderI91:1/ I91:8/'(stringI91:1/ I91:6/"run")I91:1/ I91:6/actionI91:1/ I91:3/(eqI91:1/ I91:4/'(ifI91:1/ I91:10/rev)))))))I91:1/ I91:4/(intI91:1/ I91:6/targetI91:1/ I91:6/'(readI91:1/ I91:7/target)I91:1/ I91:6/'(headI91:1/ I91:4/"_")I91:1/ I91:3/revI91:1/ I91:3/(eqI91:1/ I91:3/(ifI91:1/ I91:9/stdheaderI91:1/ I91:8/'(stringI91:1/ I91:12/rev_target))I91:1/ I91:4/(cdrI91:1/ I91:4/(carI91:1/ I91:7/'targetI91:1/ I91:5/'(letI91:1/ I91:11/rev_target)I91:1/ I91:4/(carI91:1/ I91:4/'revI91:1/ I91:5/'(letI91:1/ I91:2/0)I91:1/ I91:10/fulltargetI91:1/ I91:3/"/"I91:1/ I91:5/tokenI91:1/ I91:6/(tokenI91:1/ I91:11/'rev_targetI91:1/ I91:5/'(letI91:1/ I91:6/"raw")I91:1/ I91:6/actionI91:1/ I91:3/(eqI91:1/ I91:4/'(ifI91:1/ I91:15/it</a>?")))))))I91:1/ I91:10/"\">createI91:1/ I91:6/targetI91:1/ I91:14/href=\"/edit/"I91:1/ I91:2/<aI91:1/ I91:2/toI91:1/ I91:4/likeI91:1/ I91:5/you'dI91:1/ I91:8/"PerhapsI91:1/ I91:1/"I91:1/ I91:6/"</b>.I91:1/ I91:6/targetI91:1/ I91:4/<b>"I91:1/ I91:6/calledI91:1/ I91:6/symbolI91:1/ I91:2/noI91:1/ I91:2/isI91:1/ I91:6/"ThereI91:1/ I91:7/(stringI91:1/ I91:3/'(_I91:1/ I91:11/"</pre>\n")I91:1/ I91:7/rev))))I91:1/ I91:4/(intI91:1/ I91:6/targetI91:1/ I91:6/'(readI91:1/ I91:7/target)I91:1/ I91:6/'(headI91:1/ I91:4/"_")I91:1/ I91:3/revI91:1/ I91:3/(eqI91:1/ I91:3/(ifI91:1/ I91:11/(htmlescapeI91:1/ I91:9/"<pre>\n"I91:1/ I91:8/'(stringI91:1/ I91:7/(handleI91:1/ I91:9/<hr/><p>"I91:1/ I91:3/...I91:1/ I91:1/"I91:1/ I91:5/rev))I91:1/ I91:1/"I91:1/ I91:1/@I91:1/ I91:1/"I91:1/ I91:8/'(stringI91:1/ I91:3/'""I91:1/ I91:4/"_")I91:1/ I91:3/revI91:1/ I91:3/(eqI91:1/ I91:3/(ifI91:1/ I91:6/targetI91:1/ I91:1/"I91:1/ I91:11/"<p>viewingI91:1/ I91:7/target)I91:1/ I91:5/(tabsI91:1/ I91:7/stdpageI91:1/ I91:9/stdheaderI91:1/ I91:8/'(stringI91:1/ I91:12/rev_target))I91:1/ I91:4/(cdrI91:1/ I91:4/(carI91:1/ I91:7/'targetI91:1/ I91:5/'(letI91:1/ I91:11/rev_target)I91:1/ I91:4/(carI91:1/ I91:4/'revI91:1/ I91:5/'(letI91:1/ I91:2/0)I91:1/ I91:10/fulltargetI91:1/ I91:3/"/"I91:1/ I91:5/tokenI91:1/ I91:6/(tokenI91:1/ I91:11/'rev_targetI91:1/ I91:5/'(letI91:1/ I91:7/"view")I91:1/ I91:6/actionI91:1/ I91:3/(eqI91:1/ I91:4/'(ifI91:1/ I91:14/fulltarget))))I91:1/ M88:3/"))I87:5/"</a>I87:1/ I87:5/args)I87:1/ M84:5/"\">"M82:10/fulltargetM80:3/"/"I79:5/args)I79:1/ I79:4/(carI79:1/ I79:14/href=\"/view/"I79:1/ I79:3/"<aI79:1/ I79:8/'(stringI79:1/ I79:5/'argsI79:1/ I79:7/(lambdaI79:1/ I79:3/mapI79:1/ I79:4/(mapI79:1/ I79:7/(stringI79:1/ I79:12/...<hr/><p>"I79:1/ I79:1/"I79:1/ I79:10/fulltargetI79:1/ I79:1/"I79:1/ I79:3/forI79:1/ I79:11/"<p>historyI79:1/ I79:11/fulltarget)I79:1/ I79:5/(tabsI79:1/ I79:7/stdpageI79:1/ I79:9/stdheaderI79:1/ I79:8/'(stringI79:1/ I79:10/"history")I79:1/ I79:6/actionI79:1/ I79:3/(eqI79:1/ I79:4/'(ifI79:1/ I79:20/fulltarget))))))))))I79:1/ I79:10/"/view/_/"I79:1/ I79:7/(stringI79:1/ I79:10/'(redirectI79:1/ I79:14/fulltarget))))I79:1/ I79:10/"/view/_/"I79:1/ I79:7/(stringI79:1/ I79:10/'(redirectI79:1/ I79:4/exe)I79:1/ I79:4/baseI79:1/ M72:7/msg))))I71:1/"I71:1/ I71:7/becauseI71:1/ I71:6/failedI71:1/ I71:1/"I71:1/ I71:10/fulltargetI71:1/ I71:1/"I71:1/ I71:2/ofI71:1/ I71:12/"compilationI71:1/ I71:7/(stringI71:1/ I71:6/'abortI71:1/ I71:5/(listI71:1/ I71:5/'(msgI71:1/ I71:4/dat)I71:1/ I71:9/'(compileI71:1/ I71:7/(handleI71:1/ I71:4/'exeI71:1/ I71:5/'(letI71:1/ I71:7/compileI71:1/ I71:4/'(ifI71:1/ I71:4/dat)I71:1/ I71:10/fulltargetI71:1/ I71:7/(insertI71:1/ I71:2/'_I71:1/ I71:5/'(letI71:1/ I71:5/nil))I71:1/ I71:3/'(_I71:1/ I71:13/":compile")))I71:1/ I71:3/extI71:1/ I71:7/(stringI71:1/ I71:5/(headI71:1/ I71:6/'(evalI71:1/ I71:7/(handleI71:1/ I71:8/'compileI71:1/ I71:5/'(letI71:1/ I71:13/fulltarget)))I71:1/ I71:10/"/view/_/"I71:1/ I71:7/(stringI71:1/ I71:10/'(redirectI71:1/ I71:4/dat)I71:1/ I71:10/fulltargetI71:1/ I71:7/(insertI71:1/ I71:2/'_I71:1/ I71:5/'(letI71:1/ I71:3/"")I71:1/ I71:4/baseI71:1/ I71:3/(eqI71:1/ I71:4/'(ifI71:1/ I71:13/form.contentsI71:1/ I71:4/'datI71:1/ I71:5/'(letI71:1/ I71:10/base_ext))I71:1/ I71:4/(cdrI71:1/ I71:4/(carI71:1/ I71:4/'extI71:1/ I71:5/'(letI71:1/ I71:9/base_ext)I71:1/ I71:4/(carI71:1/ I71:5/'baseI71:1/ I71:5/'(letI71:1/ I71:3/1))I71:1/ I71:11/fulltarget)I71:1/ I71:5/(sizeI71:1/ I71:2/(-I71:1/ I71:10/fulltargetI71:1/ I71:3/"."I71:1/ I71:6/rtokenI71:1/ I71:7/(rtokenI71:1/ I71:9/'base_extI71:1/ I71:5/'(letI71:1/ I71:7/"save")I71:1/ I71:6/actionI71:1/ I71:3/(eqI71:1/ I71:4/'(ifI71:1/ I71:25/value=\"save\"></form>"))I71:1/ I71:11/type=submitI71:1/ I71:7/"<inputI71:1/ I71:15/"</textarea>\n"I71:1/ I71:7/data)")I71:1/ I71:11/'"(internalI71:1/ I71:9/symbol)")I71:1/ I71:5/"(wasI71:1/ I71:3/'(_I71:1/ I71:4/")")I71:1/ I71:11/oldcontentsI71:1/ I71:1/"I71:1/ I71:3/intI71:1/ I71:5/"(wasI71:1/ I71:8/'(stringI71:1/ I71:12/oldcontents)I71:1/ I71:12/'(htmlescapeI71:1/ I71:7/data)")I71:1/ I71:6/quotedI71:1/ I71:5/"(wasI71:1/ I71:3/'(_I71:1/ I71:7/data)")I71:1/ I71:4/listI71:1/ I71:5/"(wasI71:1/ I71:1/_I71:1/ I71:3/'(_I71:1/ I71:3/'""I71:1/ I71:11/oldcontentsI71:1/ I71:6/(xcaseI71:1/ I71:19/name=\"contents\">"I71:1/ I71:8/cols=120I71:1/ I71:7/rows=35I71:1/ I71:13/"\"><textareaI71:1/ I71:10/fulltargetI71:1/ I71:16/action=\"/save/"I71:1/ I71:15/method=\"post\"I71:1/ I71:6/"<formI71:1/ I71:13/deleted.</b>"I71:1/ I71:2/beI71:1/ I71:4/willI71:1/ I71:2/ItI71:1/ I71:11/permission.I71:1/ I71:7/withoutI71:1/ I71:8/websitesI71:1/ I71:5/otherI71:1/ I71:4/fromI71:1/ I71:4/textI71:1/ I71:4/copyI71:1/ I71:3/notI71:1/ I71:11/"<br/><b>DoI71:1/ I71:3/"))I71:1/ I71:3/...I71:1/ I71:1/"I71:1/ I71:10/fulltargetI71:1/ I71:1/"I71:1/ I71:4/pageI71:1/ I71:3/newI71:1/ I71:9/"creatingI71:1/ I71:8/'(stringI71:1/ I71:2/")I71:1/ I71:3/...I71:1/ I71:1/"I71:1/ I71:10/fulltargetI71:1/ I71:1/"I71:1/ I71:8/"editingI71:1/ I71:8/'(stringI71:1/ I71:11/oldcontentsI71:1/ I71:3/(ifI71:1/ I71:5/"<p>"I71:1/ I71:11/fulltarget)I71:1/ I71:5/(tabsI71:1/ I71:7/stdpageI71:1/ I71:9/stdheaderI71:1/ I71:8/'(stringI71:1/ I71:5/nil))I71:1/ I71:3/'(_I71:1/ I71:11/fulltarget)I71:1/ I71:6/'(headI71:1/ I71:7/(handleI71:1/ I71:12/'oldcontentsI71:1/ I71:5/'(letI71:1/ I71:7/"edit")I71:1/ I71:6/actionI71:1/ I71:3/(eqI71:1/ I71:4/'(ifI71:1/ I71:11/"</div>")))I71:1/ I71:1/"I71:1/ I71:18/"\">run</a></span>I71:1/ I71:4/pageI71:1/ I71:13/href=\"/run/"I71:1/ I71:16/class=\"tab\"><aI71:1/ I71:6/"<spanI71:1/ I71:1/"I71:1/ I71:22/"\">history</a></span>I71:1/ I71:4/pageI71:1/ I71:17/href=\"/history/"I71:1/ I71:16/class=\"tab\"><aI71:1/ I71:6/"<spanI71:1/ I71:1/"I71:1/ I71:19/"\">edit</a></span>I71:1/ I71:4/pageI71:1/ I71:14/href=\"/edit/"I71:1/ I71:16/class=\"tab\"><aI71:1/ I71:6/"<spanI71:1/ I71:1/"I71:1/ I71:19/"\">view</a></span>I71:1/ I71:4/pageI71:1/ I71:16/href=\"/view/_/"I71:1/ I71:16/class=\"tab\"><aI71:1/ I71:6/"<spanI71:1/ I71:16/class=\"tabs\">"I71:1/ I71:5/"<divI71:1/ I71:8/'(stringI71:1/ I71:5/args)I71:1/ I71:4/(carI71:1/ I71:5/'pageI71:1/ I71:5/'(letI71:1/ I71:5/'argsI71:1/ I71:7/(lambdaI71:1/ I71:5/'tabsI71:1/ I71:5/'(letI71:1/ I71:15/action_target))I71:1/ I71:4/(cdrI71:1/ I71:4/(carI71:1/ I71:11/'fulltargetI71:1/ I71:5/'(letI71:1/ I71:14/action_target)I71:1/ I71:4/(carI71:1/ I71:7/'actionI71:1/ I71:5/'(letI71:1/ I71:2/0)I71:1/ I71:3/urlI71:1/ I71:3/"/"I71:1/ I71:5/tokenI71:1/ I71:6/(tokenI71:1/ I71:14/'action_targetI71:1/ I71:5/'(letI71:1/ I71:4/0)))I71:1/ I69:3/"/"I69:1/ I69:5/tokenI69:1/ I69:6/(tokenI69:1/ I69:4/(cdrI69:1/ I69:4/(carI69:1/ I69:4/'urlI69:1/ I69:5/'(letI69:1/ I69:7/0))))))I69:1/ I69:4/hrecI69:1/ I69:5/(hrecI69:1/ I69:6/stringI69:1/ I69:5/(consI69:1/ I69:6/'(evalI69:1/ I69:9/1))))))))I69:1/ I69:1/nI69:1/ I69:2/(+I69:1/ I69:4/selfI69:1/ I69:5/(selfI69:1/ I69:6/'ch)))I69:1/ I69:8/'"&amp;"I69:1/ I69:4/"&")I69:1/ I69:2/chI69:1/ I65:7/'"&gt;"I65:1/ I65:4/">")I65:1/ I65:2/chI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:7/'"&lt;"I65:1/ I65:4/"<")I65:1/ I65:2/chI65:1/ I65:3/(eqI65:1/ I65:3/(ifI65:1/ I65:6/'(consI65:1/ I65:2/n)I65:1/ I65:1/sI65:1/ I65:4/(subI65:1/ I65:3/'chI65:1/ I65:5/'(letI65:1/ I65:4/'nilI65:1/ I65:3/s))I65:1/ I65:5/(sizeI65:1/ I65:1/nI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:6/args))I65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'nI65:1/ I65:5/'(letI65:1/ I65:5/args)I65:1/ I65:4/(carI65:1/ I65:5/'selfI65:1/ I65:5/'(letI65:1/ I65:5/'argsI65:1/ I65:7/(lambdaI65:1/ I65:5/'hrecI65:1/ I65:5/'(letI65:1/ I65:6/hargs)I65:1/ I65:4/(carI65:1/ I65:2/'sI65:1/ I65:5/'(letI65:1/ I65:6/'hargsI65:1/ I65:7/(lambdaI65:1/ I65:11/'htmlescapeI65:1/ I65:5/'(letI65:1/ I65:11/1))))))))))I65:1/ I65:1/nI65:1/ I65:2/(-I65:1/ I65:1/sI65:1/ I65:3/sepI65:1/ I65:4/selfI65:1/ I65:6/'(selfI65:1/ I65:5/1))))I65:1/ I65:1/nI65:1/ I65:2/(+I65:1/ I65:2/s)I65:1/ I65:5/(sizeI65:1/ I65:2/(-I65:1/ I65:2/1)I65:1/ I65:1/nI65:1/ I65:2/(+I65:1/ I65:1/sI65:1/ I65:7/(substrI65:1/ I65:2/n)I65:1/ I65:1/0I65:1/ I65:1/sI65:1/ I65:7/(substrI65:1/ I65:6/'(listI65:1/ I65:4/sep)I65:1/ I65:2/chI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:2/n)I65:1/ I65:1/sI65:1/ I65:4/(subI65:1/ I65:3/'chI65:1/ I65:5/'(letI65:1/ I65:2/s)I65:1/ I65:2/""I65:1/ I65:6/'(listI65:1/ I65:3/1))I65:1/ I65:1/0I65:1/ I65:2/(-I65:1/ I65:1/nI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:8/args))))I65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'nI65:1/ I65:5/'(letI65:1/ I65:7/args)))I65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'sI65:1/ I65:5/'(letI65:1/ I65:6/args))I65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:4/'sepI65:1/ I65:5/'(letI65:1/ I65:5/args)I65:1/ I65:4/(carI65:1/ I65:5/'selfI65:1/ I65:5/'(letI65:1/ I65:5/'argsI65:1/ I65:7/(lambdaI65:1/ I65:7/'rtokenI65:1/ I65:5/'(letI65:1/ I65:11/1))))))))))I65:1/ I65:1/nI65:1/ I65:2/(+I65:1/ I65:1/sI65:1/ I65:3/sepI65:1/ I65:4/selfI65:1/ I65:6/'(selfI65:1/ I65:5/1))))I65:1/ I65:1/nI65:1/ I65:2/(+I65:1/ I65:2/s)I65:1/ I65:5/(sizeI65:1/ I65:2/(-I65:1/ I65:2/1)I65:1/ I65:1/nI65:1/ I65:2/(+I65:1/ I65:1/sI65:1/ I65:7/(substrI65:1/ I65:2/n)I65:1/ I65:1/0I65:1/ I65:1/sI65:1/ I65:7/(substrI65:1/ I65:6/'(listI65:1/ I65:4/sep)I65:1/ I65:2/chI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:2/n)I65:1/ I65:1/sI65:1/ I65:4/(subI65:1/ I65:3/'chI65:1/ I65:5/'(letI65:1/ I65:3/"")I65:1/ I65:1/sI65:1/ I65:6/'(listI65:1/ I65:3/s))I65:1/ I65:5/(sizeI65:1/ I65:1/nI65:1/ I65:3/(eqI65:1/ I65:4/'(ifI65:1/ I65:8/args))))I65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'nI65:1/ I65:5/'(letI65:1/ I65:7/args)))I65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'sI65:1/ I65:5/'(letI65:1/ I65:6/args))I65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:4/'sepI65:1/ I65:5/'(letI65:1/ I65:5/args)I65:1/ I65:4/(carI65:1/ I65:5/'selfI65:1/ I65:5/'(letI65:1/ I65:5/'argsI65:1/ I65:7/(lambdaI65:1/ I65:6/'tokenI65:1/ I65:5/'(letI65:1/ I65:9/'nil)))))I65:1/ I65:4/l)))I65:1/ I65:4/(cdrI65:1/ I65:1/fI65:1/ I65:4/selfI65:1/ I65:5/(selfI65:1/ I65:3/l))I65:1/ I65:4/(carI65:1/ I65:2/(fI65:1/ I65:6/'(consI65:1/ I65:1/lI65:1/ I65:4/'(ifI65:1/ I65:7/args)))I65:1/ I65:4/(cdrI65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'lI65:1/ I65:5/'(letI65:1/ I65:6/args))I65:1/ I65:4/(cdrI65:1/ I65:4/(carI65:1/ I65:2/'fI65:1/ I65:5/'(letI65:1/ I65:5/args)I65:1/ I65:4/(carI65:1/ I65:5/'selfI65:1/ I65:5/'(letI65:1/ I65:5/'argsI65:1/ I65:7/(lambdaI65:1/ I65:4/'mapI65:1/ I65:5/'(letI65:1/ I65:12/"\r\n\r\n"))I65:1/ I65:7/target)I65:1/ I65:4/(carI65:1/ I65:1/"I65:1/ I65:10/"Location:I65:1/ I65:8/'(stringI65:1/ I65:7/'targetI65:1/ I65:7/(lambdaI65:1/ I65:9/'redirectI65:1/ I65:5/'(letI65:1/ I65:36/title=\"polybook\"/></head><body>\n"I65:1/ I65:28/href=\"/raw/_/polybook.css\"I65:1/ I65:17/type=\"text/css\"I65:1/ I65:14/rel=stylesheetI65:1/ I65:18/"<html><head><linkI65:1/ I65:8/'stdpageI65:1/ I65:5/'(letI65:1/ I65:22/charset=utf-8\r\n\r\n"I65:1/ I65:10/text/html;I65:1/ I65:14/"Content-Type:I65:1/ I65:10/'stdheaderI65:1/ I65:5/'(letI65:1/ X
!4=X

main-go 9 4633/(let 'stdheader "Content-Type: text/html; charset=utf-8\r\n\r\n" '(let 'stdpage "<html><head><link rel=stylesheet type=\"text/css\" href=\"/raw/_/polybook.css\" title=\"polybook\"/></head><body>\n" '(let 'redirect (lambda 'target '(string "Location: " (car target) "\r\n\r\n")) '(let 'map (lambda 'args '(let 'self (car args) '(let 'f (car (cdr args)) '(let 'l (car (cdr (cdr args))) '(if l '(cons (f (car l)) (self self f (cdr l))) 'nil))))) '(let 'token (lambda 'args '(let 'self (car args) '(let 'sep (car (cdr args)) '(let 's (car (cdr (cdr args))) '(let 'n (car (cdr (cdr (cdr args)))) '(if (eq n (size s)) '(list s "") '(let 'ch (sub s n) '(if (eq ch sep) '(list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1)))) '(self self sep s (+ n 1)))))))))) '(let 'rtoken (lambda 'args '(let 'self (car args) '(let 'sep (car (cdr args)) '(let 's (car (cdr (cdr args))) '(let 'n (car (cdr (cdr (cdr args)))) '(if (eq n (- 0 1)) '(list "" s) '(let 'ch (sub s n) '(if (eq ch sep) '(list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1)))) '(self self sep s (- n 1)))))))))) '(let 'htmlescape (lambda 'hargs '(let 's (car hargs) '(let 'hrec (lambda 'args '(let 'self (car args) '(let 'n (car (cdr args)) '(if (eq n (size s)) 'nil '(let 'ch (sub s n) '(cons (if (eq ch "<") '"&lt;" '(if (eq ch ">") '"&gt;" '(if (eq ch "&") '"&amp;" 'ch))) (self self (+ n 1)))))))) '(eval (cons string (hrec hrec 0)))))) '(let 'url (car (cdr (token token "/" request.url 0))) '(let 'action_target (token token "/" url 0) '(let 'action (car action_target) '(let 'fulltarget (car (cdr action_target)) '(let 'tabs (lambda 'args '(let 'page (car args) '(string "<div class=\"tabs\">" "<span class=\"tab\"><a href=\"/view/_/" page "\">view</a></span> " "<span class=\"tab\"><a href=\"/edit/" page "\">edit</a></span> " "<span class=\"tab\"><a href=\"/history/" page "\">history</a></span> " "<span class=\"tab\"><a href=\"/run/" page "\">run</a></span> " "</div>"))) '(if (eq action "edit") '(let 'oldcontents (handle '(head fulltarget) '(_ nil)) '(string stdheader stdpage (tabs fulltarget) "<p>" (if oldcontents '(string "editing " fulltarget " ... ") '(string "creating new page " fulltarget " ... ")) "<br/><b>Do not copy text from other websites without permission. It will be deleted.</b>" "<form method=\"post\" action=\"/save/" fulltarget "\"><textarea rows=35 cols=120 name=\"contents\">" (xcase oldcontents '"" '(_ _ "(was list data)") '(_ "(was quoted data)") '(htmlescape oldcontents) '(string "(was int " oldcontents ")") '(_ "(was symbol)") '"(internal data)") "</textarea>\n" "<input type=submit value=\"save\"></form>")) '(if (eq action "save") '(let 'base_ext (rtoken rtoken "." fulltarget (- (size fulltarget) 1)) '(let 'base (car base_ext) '(let 'ext (car (cdr base_ext)) '(let 'dat form.contents '(if (eq base "") '(let '_ (insert fulltarget dat) '(redirect (string "/view/_/" fulltarget))) '(let 'compile (handle '(eval (head (string ext ":compile"))) '(_ nil)) '(let '_ (insert fulltarget dat) '(if compile '(let 'exe (handle '(compile dat) '(msg (list 'abort (string "compilation of " fulltarget " failed because " msg)))) '(let '_ (insert base exe) '(redirect (string "/view/_/" fulltarget)))) '(redirect (string "/view/_/" fulltarget)))))))))) '(if (eq action "history") '(string stdheader stdpage (tabs fulltarget) "<p>history for " fulltarget " ...<hr/><p>" (string (map map (lambda 'args '(string "<a href=\"/view/" (car args) "/" fulltarget "\">" (car args) "</a> ")) (history fulltarget)))) '(if (eq action "view") '(let 'rev_target (token token "/" fulltarget 0) '(let 'rev (car rev_target) '(let 'target (car (cdr rev_target)) '(string stdheader stdpage (tabs target) "<p>viewing " target (if (eq rev "_") '"" '(string " @ " rev)) " ... <hr/><p>" (handle '(string "<pre>\n" (htmlescape (if (eq rev "_") '(head target) '(read target (int rev)))) "</pre>\n") '(_ (string "There is no symbol called <b>" target "</b>. " "Perhaps you'd like to <a href=\"/edit/" target "\">create it</a>?"))))))) '(if (eq action "raw") '(let 'rev_target (token token "/" fulltarget 0) '(let 'rev (car rev_target) '(let 'target (car (cdr rev_target)) '(string stdheader (if (eq rev "_") '(head target) '(read target (int rev))))))) '(if (eq action "run") '(string stdheader stdpage (tabs fulltarget) "<p>running " fulltarget " ... <hr/><p>" (handle '(let 'prog (head fulltarget) '(handle '(eval prog) '(msg (string "<b>Runtime error</b>: " msg)))) '(_ (string "There is no symbol called <b>" fulltarget "</b>. " "Perhaps you'd like to <a href=\"/edit/" fulltarget "\">create it</a>?")))) '(string stdheader "unknown action!")))))))))))))))))))

main-go.b 8 9284/"\n;; main-go page does anything we might mess up and need to revert.\n\n(let 'stdheader \"Content-Type: text/html; charset=utf-8\\r\\n\\r\\n\" '\n(let 'stdpage \"<html><head><link rel=stylesheet type=\\\"text/css\\\" href=\\\"/raw/_/polybook.css\\\" title=\\\"polybook\\\"/></head><body>\\n\" '\n(let 'redirect (lambda 'target '(string \"Location: \" (car target) \"\\r\\n\\r\\n\")) '\n\n\n(let 'map \n  (lambda 'args\n    '(let 'self (car args)\n          '(let 'f (car (cdr args))\n                '(let 'l (car (cdr (cdr args)))\n                      '(if l\n                           '(cons (f (car l)) (self self f (cdr l)))\n                         'nil))))) '\n\n; chop up to the first instance of the char given\n(let 'token\n  (lambda 'args\n    '(let 'self (car args)\n          '(let 'sep (car (cdr args))\n                '(let 's (car (cdr (cdr args)))\n                      '(let 'n (car (cdr (cdr (cdr args))))\n                            '(if (eq n (size s)) '(list s \"\")\n                               '(let 'ch (sub s n)\n                                     '(if (eq ch sep)\n                                          '(list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1))))\n                                          '(self self sep s (+ n 1)))\n                                     ))))))) '\n\n; same, but last instance                     \n(let 'rtoken\n  (lambda 'args\n    '(let 'self (car args)\n          '(let 'sep (car (cdr args))\n                '(let 's (car (cdr (cdr args)))\n                      '(let 'n (car (cdr (cdr (cdr args))))\n                            '(if (eq n (- 0 1)) '(list \"\" s)\n                               '(let 'ch (sub s n)\n                                     '(if (eq ch sep)\n                                          '(list (substr s 0 n) (substr s (+ n 1) (- (size s) (+ n 1))))\n                                          '(self self sep s (- n 1)))\n                                     ))))))) '\n\n(let 'htmlescape\n  ; PERF\n  (lambda 'hargs\n    '(let 's (car hargs)\n         '(let 'hrec (lambda 'args\n                       '(let 'self (car args)\n                             '(let 'n (car (cdr args))\n                                   '(if (eq n (size s))\n                                        'nil\n                                      '(let 'ch (sub s n)\n                                            '(cons\n                                              (if (eq ch \"<\")\n                                                  '\"&lt;\"\n                                                '(if (eq ch \">\")\n                                                     '\"&gt;\"\n                                                   '(if (eq ch \"&\")\n                                                        '\"&amp;\"\n                                                      'ch)))\n                                              (self self (+ n 1))))))))\n               '(eval (cons string (hrec hrec 0)))))) '\n\n  ; figure out what we're doing based on the URL\n  ; (toss off the starting / char)\n(let 'url (car (cdr (token token \"/\" request.url 0))) '\n(let 'action_target (token token \"/\" url 0) '\n(let 'action (car action_target) '\n(let 'fulltarget (car (cdr action_target)) '\n  \n(let 'tabs (lambda 'args\n             '(let 'page (car args) '\n                   ; XXX make tabs\n                   (string \"<div class=\\\"tabs\\\">\"\n                           \"<span class=\\\"tab\\\"><a href=\\\"/view/_/\" page \"\\\">view</a></span> \"\n                           \"<span class=\\\"tab\\\"><a href=\\\"/edit/\" page \"\\\">edit</a></span> \"\n                           \"<span class=\\\"tab\\\"><a href=\\\"/history/\" page \"\\\">history</a></span> \"\n                           \"<span class=\\\"tab\\\"><a href=\\\"/run/\" page \"\\\">run</a></span> \"\n                           \"</div>\"))) '\n\n  (if (eq action \"edit\")\n      ;; need to fetch the source code for this page\n      ;; and put it in the textarea\n      '(let 'oldcontents (handle '(head fulltarget) '(_ nil)) '\n        (string stdheader stdpage\n                (tabs fulltarget) \"<p>\"\n               (if oldcontents\n                   '(string \"editing \" fulltarget \" ... \")\n                   '(string \"creating new page \" fulltarget \" ... \"))\n               \"<br/><b>Do not copy text from other websites without permission. It will be deleted.</b>\"\n               \"<form method=\\\"post\\\" action=\\\"/save/\" fulltarget \"\\\"><textarea rows=35 cols=120 name=\\\"contents\\\">\"\n               (xcase oldcontents\n                   '\"\"\n                   '(_ _ \"(was list data)\")\n                   '(_ \"(was quoted data)\")\n                   '(htmlescape oldcontents)\n                   '(string \"(was int \" oldcontents \")\")\n                   '(_ \"(was symbol)\")\n                   '\"(internal data)\")\n               \"</textarea>\\n\"\n               \"<input type=submit value=\\\"save\\\"></form>\"))\n\n    '(if (eq action \"save\")\n       ; might need to compile... \n       ; figure out the language based on the extension.\n      '(let 'base_ext (rtoken rtoken \".\" fulltarget (- (size fulltarget) 1)) '\n       (let 'base (car base_ext) '\n       (let 'ext (car (cdr base_ext)) '\n       (let 'dat form.contents '\n\n       (if (eq base \"\")\n           ;; if there was no . then ext holds the entire name. in this case\n           ;; just save.\n           '(let '_ (insert fulltarget dat) '\n                 ;; XXX goto revision\n                 (redirect (string \"/view/_/\" fulltarget)))\n\n         ;; otherwise we should compile, saving the source and compiled version\n         ;; (might do this recursively??  eg. prog.b.w)\n         ; get (and run to produce a closure) the compiler, if any\n         '(let 'compile (handle '(eval (head (string ext \":compile\"))) '(_ nil)) '\n            ; save source\n            (let '_ (insert fulltarget dat) '\n             (if compile\n               '(let 'exe (handle '(compile dat) '(msg\n                                                  ; if compilation fails, then we\n                                                  ; return a program that aborts\n                                                  (list\n                                                   'abort\n                                                   (string\n                                                    \"compilation of \" fulltarget\n                                                    \" failed because \" msg)))) '\n               ; save executable\n               (let '_ (insert base exe) '\n                    ;; XXX should jump directly to the revision we inserted\n                    (redirect (string \"/view/_/\" fulltarget))\n                    )) ; compiler exists\n              '(redirect (string \"/view/_/\" fulltarget)))\n        ))))))) ; action save\n\n       '(if (eq action \"history\")\n            '(string\n              stdheader stdpage\n              (tabs fulltarget)\n              \"<p>history for \" fulltarget \" ...<hr/><p>\"\n              (string (map map (lambda 'args '(string \"<a href=\\\"/view/\" (car args) \"/\" fulltarget \"\\\">\" \n                                                      (car args) \"</a> \")) (history fulltarget))))\n\n       '(if (eq action \"view\")\n           '(let 'rev_target (token token \"/\" fulltarget 0) '\n            (let 'rev (car rev_target) '\n            (let 'target (car (cdr rev_target)) '     \n             (string\n              stdheader stdpage\n              (tabs target)\n              \"<p>viewing \" target (if (eq rev \"_\") '\"\" '(string \" @ \" rev)) \" ... <hr/><p>\"\n              (handle '(string \"<pre>\\n\" (htmlescape (if (eq rev \"_\") '(head target) '(read target (int rev)))) \"</pre>\\n\")\n                      '(_\n                        (string \"There is no symbol called <b>\" target \"</b>. \"\n                                \"Perhaps you'd like to <a href=\\\"/edit/\" target \"\\\">create it</a>?\")))))))\n\n       ;; like view, but no excess stuff/escaping (good for including CSS, for instance)\n       '(if (eq action \"raw\")\n           '(let 'rev_target (token token \"/\" fulltarget 0) '\n            (let 'rev (car rev_target) '\n            (let 'target (car (cdr rev_target)) '     \n             (string\n              stdheader (if (eq rev \"_\") '(head target) '(read target (int rev))) )\n             )))\n\n          ;; XXX protect against run main...? (= infinite loop)\n         '(if (eq action \"run\")\n            '(string\n              stdheader stdpage\n              (tabs fulltarget)\n              \"<p>running \" fulltarget \" ... <hr/><p>\"\n              (handle '(let 'prog (head fulltarget)\n                          '(handle '(eval prog) '(msg (string \"<b>Runtime error</b>: \" msg))))\n                      '(_\n                        (string \"There is no symbol called <b>\" fulltarget \"</b>. \"\n                                \"Perhaps you'd like to <a href=\\\"/edit/\" fulltarget \"\\\">create it</a>?\"))))\n            \n\n          '(string stdheader \"unknown action!\")))\n\n       )))) ; action case analysis\n\n))))))))))))"

main.b 10 956/";;                                 -*- lisp -*-\n; This is the initial (bootstrapping) program.\n; its role is to provide a minimal wiki interface\n; that will allow us to develop compilers for\n; better languages, that we can then use to\n; overwrite this program.\n\n(let 'nil '() '\n(let 'car (lambda 'args\n            '(xcase args 'noa '(arg u\n                                   (xcase arg 'error_car_nil '(h u h))))) '\n(let 'cdr (lambda 'args\n            '(xcase args 'nob '(arg u \n                                   (xcase arg 'error_cdr_nil '(u t t))))) '\n;; emergency revert code as soon as possible...\n;; this reverts only the compiled main-go page, not any source code.\n(if (eq request.url \"/emergency-revert\")\n   '(let '_ (insert \"main-go\" (read \"main-go\" (car (cdr (history \"main-go\"))))) '\n       \"OK, reverted\")\n\n   ;; otherwise run the main-go page (nil, car, cdr already defined)\n   '(eval (head \"main-go\"))\n))))"
!6=M238:30/analysis\n\n)))))))))))))))\n"M236:4/caseI235:6/actionI235:1/ I235:1/;I235:1/ I235:4/))))I235:7/       I235:16/action!\")))\n\nI235:1/ I235:9/\"unknownI235:1/ I235:9/stdheaderI235:1/ I235:8/'(stringI235:10/          I235:4/\n\nI235:12/            I235:15/it</a>?\"))))\nI235:1/ I235:13/\"\\\">createI235:1/ I235:10/fulltargetI235:1/ I235:17/href=\\\"/edit/\"I235:1/ I235:2/<aI235:1/ I235:2/toI235:1/ I235:4/likeI235:1/ I235:5/you'dI235:1/ I235:9/\"PerhapsI235:32/                                I235:4/\"\nI235:1/ I235:7/\"</b>.I235:1/ I235:10/fulltargetI235:1/ I235:5/<b>\"I235:1/ I235:6/calledI235:1/ I235:6/symbolI235:1/ I235:2/noI235:1/ I235:2/isI235:1/ I235:7/\"ThereI235:1/ I235:7/(stringI235:24/                        I235:5/'(_\nI235:22/                      I235:9/msg))))\nI235:1/ I235:2/\"I235:1/ I235:10/error</b>:I235:1/ I235:12/\"<b>RuntimeI235:1/ I235:7/(stringI235:1/ I235:5/'(msgI235:1/ I235:5/prog)I235:1/ M233:1/ M232:8/'(handleI232:26/                          I232:13/fulltarget)\nM230:5/(headM228:5/'progM226:5/'(letM224:7/(handleI224:14/              I224:12/<hr/><p>\"\nM222:3/...M220:2/\"M218:10/fulltargetI217:2/\"I217:1/ I217:12/\"<p>runningI217:14/              I217:13/fulltarget)\nI217:1/ I217:5/(tabsI217:14/              I217:9/stdpage\nI217:1/ I217:9/stdheaderI217:14/              I217:10/'(string\nI217:12/            I217:10/\"run\")\nI217:1/ I217:6/actionI217:1/ I217:3/(eqI217:1/ I217:4/'(ifI217:9/         I217:7/loop)\nI217:1/ I217:8/infiniteI217:1/ I217:2/(=I217:1/ I217:8/main...?I217:1/ M214:7/againstI213:7/protectI213:1/ I213:3/XXXI213:1/ M211:10/          M210:7/)))\n\nI210:13/             I210:3/)\nM208:6/rev)))I208:1/ I208:4/(intI208:1/ I208:6/targetI208:1/ I208:6/'(readI208:1/ I208:7/target)I208:1/ I208:6/'(headI208:1/ I208:6/\"_\")I208:1/ I208:3/revI208:1/ I208:3/(eqI208:1/ I208:3/(ifI208:1/ I208:9/stdheaderI208:14/              I208:9/(string\nI208:13/             I208:2/\nI208:5/     I208:1/'I208:1/ I208:12/rev_target))I208:1/ I208:4/(cdrI208:1/ I208:4/(carI208:1/ I208:7/'targetI208:1/ I208:4/(letI208:12/            I208:3/'\nI208:1/ I208:11/rev_target)I208:1/ I208:4/(carI208:1/ I208:4/'revI208:1/ I208:4/(letI208:12/            I208:3/'\nI208:1/ I208:2/0)I208:1/ I208:10/fulltargetI208:1/ I208:5/\"/\"I208:1/ I208:5/tokenI208:1/ I208:6/(tokenI208:1/ I208:11/'rev_targetI208:1/ I208:5/'(letI208:11/           I208:10/\"raw\")\nI208:1/ I208:6/actionI208:1/ I208:3/(eqI208:1/ I208:4/'(ifI207:11/instance)\nI207:1/ I207:3/forI207:1/ I207:4/CSS,I207:1/ I207:9/includingI207:1/ I207:3/forI207:1/ I207:5/(goodI207:1/ I207:14/stuff/escapingI207:1/ I207:6/excessI207:1/ I207:2/noI207:1/ I207:3/butI207:1/ I207:5/view,I207:1/ I207:4/likeI207:1/ I207:2/;;I207:7/       I207:20/it</a>?\")))))))\n\nI207:1/ I207:13/\"\\\">createI207:1/ I207:6/targetI207:1/ I207:17/href=\\\"/edit/\"I207:1/ I207:2/<aI207:1/ I207:2/toI207:1/ I207:4/likeI207:1/ I207:5/you'dI207:1/ I207:9/\"PerhapsI207:32/                                I207:4/\"\nI207:1/ I207:7/\"</b>.I207:1/ I207:6/targetI207:1/ I207:5/<b>\"I207:1/ I207:6/calledI207:1/ I207:6/symbolI207:1/ I207:2/noI207:1/ I207:2/isI207:1/ I207:7/\"ThereI207:1/ I207:7/(stringI207:24/                        I207:5/'(_\nI207:22/                      I207:16/\"</pre>\\n\")\nI207:1/ I207:7/rev))))I207:1/ I207:4/(intI207:1/ I207:6/targetI207:1/ I207:6/'(readI207:1/ I207:7/target)I207:1/ I207:6/'(headI207:1/ I207:6/\"_\")I207:1/ I207:3/revI207:1/ I207:3/(eqI207:1/ I207:3/(ifI207:1/ I207:11/(htmlescapeI207:1/ I207:12/\"<pre>\\n\"I207:1/ I207:8/'(stringI207:1/ I207:7/(handleI207:14/              I207:12/<hr/><p>\"\nI207:1/ I207:3/...I207:1/ I207:2/\"I207:1/ I207:5/rev))I207:1/ I207:2/\"I207:1/ I207:1/@I207:1/ I207:2/\"I207:1/ I207:8/'(stringI207:1/ I207:5/'\"\"I207:1/ I207:6/\"_\")I207:1/ I207:3/revI207:1/ I207:3/(eqI207:1/ I207:3/(ifI207:1/ I207:6/targetI207:1/ I207:2/\"I207:1/ I207:12/\"<p>viewingI207:14/              I207:9/target)\nI207:1/ I207:5/(tabsI207:14/              I207:9/stdpage\nI207:1/ I207:9/stdheaderI207:14/              I207:9/(string\nI207:13/             I207:2/\nI207:5/     I207:1/'I207:1/ I207:12/rev_target))I207:1/ I207:4/(cdrI207:1/ I207:4/(carI207:1/ I207:7/'targetI207:1/ I207:4/(letI207:12/            M204:11/rev_target)I203:4/(carI203:1/ I203:4/'revI203:1/ I203:4/(letI203:12/            I203:3/'\nI203:1/ I203:2/0)I203:1/ I203:10/fulltargetI203:1/ I203:5/\"/\"I203:1/ I203:5/tokenI203:1/ I203:6/(tokenI203:1/ I203:11/'rev_targetI203:1/ I203:5/'(letI203:11/           I203:11/\"view\")\nI203:1/ I203:6/actionI203:1/ I203:3/(eqI203:1/ I203:4/'(ifI203:7/       I203:18/fulltarget))))\n\nI203:1/ M200:4/\"))I199:6/\"</a>I199:1/ I199:5/args)I199:1/ I198:54/                                                      I198:2/\nM196:9/\"\\\">\"M194:10/fulltargetM192:5/\"/\"I191:5/args)I191:1/ I191:4/(carI191:1/ I191:17/href=\\\"/view/\"I191:1/ I191:4/\"<aI191:1/ I191:8/'(stringI191:1/ I191:5/'argsI191:1/ I191:7/(lambdaI191:1/ I191:3/mapI191:1/ I191:4/(mapI191:1/ I191:7/(stringI191:14/              I191:15/...<hr/><p>\"\nI191:1/ I191:2/\"I191:1/ I191:10/fulltargetI191:1/ I191:2/\"I191:1/ I191:3/forI191:1/ I191:12/\"<p>historyI191:14/              I191:13/fulltarget)\nI191:1/ I191:5/(tabsI191:14/              I191:9/stdpage\nI191:1/ I191:9/stdheaderI191:14/              I191:10/'(string\nI191:12/            I191:14/\"history\")\nI191:1/ I191:6/actionI191:1/ I191:3/(eqI191:1/ I191:4/'(ifI191:7/       I191:8/save\n\nI191:1/ I191:6/actionI191:1/ I191:1/;I191:1/ I191:7/)))))))I191:8/        I191:15/fulltarget)))\nI191:1/ I191:12/\"/view/_/\"I191:1/ I191:7/(stringI191:1/ I191:10/'(redirectI191:14/              I191:8/exists\nI191:1/ I191:8/compilerI191:1/ I191:1/;I191:1/ I191:2/))I191:20/                    I191:14/fulltarget))\nI191:1/ I191:12/\"/view/_/\"I191:1/ I191:7/(stringI191:1/ I191:9/(redirectI191:20/                    I191:10/inserted\nI191:1/ I191:2/weI191:1/ I191:8/revisionI191:1/ I191:3/theI191:1/ I191:2/toI191:1/ I191:8/directlyI191:1/ I191:4/jumpI191:1/ I191:6/shouldI191:1/ I191:3/XXXI191:1/ I191:2/;;I191:20/                    I191:3/'\nI191:1/ I191:4/exe)I191:1/ I191:4/baseI191:1/ I187:4/(letI187:15/               I187:12/executable\nI187:1/ I187:4/saveI187:1/ I187:1/;I187:15/               I187:3/'\nI187:1/ I187:7/msg))))I187:1/ I187:2/\"I187:1/ I187:7/becauseI187:1/ I187:6/failedI187:1/ I187:2/\"I187:52/                                                    I187:12/fulltarget\nI187:1/ I187:2/\"I187:1/ I187:2/ofI187:1/ I187:13/\"compilationI187:52/                                                    I187:9/(string\nI187:51/                                                   I187:8/'abort\nI187:51/                                                   I187:7/(list\nI187:50/                                                  I187:8/aborts\nI187:1/ I187:4/thatI187:1/ I187:7/programI187:1/ I187:1/aI187:1/ I187:6/returnI187:1/ I187:1/;I187:50/                                                  I187:4/we\nI187:1/ I187:4/thenI187:1/ I187:6/fails,I187:1/ I187:11/compilationI187:1/ I187:2/ifI187:1/ I187:1/;I187:50/                                                  I187:7/'(msg\nI187:1/ I187:4/dat)I187:1/ I187:9/'(compileI187:1/ I187:7/(handleI187:1/ I187:4/'exeI187:1/ M185:15/               M184:9/compile\nM182:3/(ifI182:13/             I182:3/'\nM180:4/dat)M178:10/fulltargetM176:7/(insertM174:2/'_M172:4/(letI172:12/            I172:8/source\nM170:4/saveM168:1/;I168:12/            I168:3/'\nI167:5/nil))I167:1/ I167:3/'(_I167:1/ I167:15/\":compile\")))I167:1/ I167:3/extI167:1/ I167:7/(stringI167:1/ I167:5/(headI167:1/ I167:6/'(evalI167:1/ I167:7/(handleI167:1/ I167:8/'compileI167:1/ I167:5/'(letI167:9/         I167:5/any\nI167:1/ I167:2/ifI167:1/ I167:9/compiler,I167:1/ I167:3/theI167:1/ I167:8/closure)I167:1/ I167:1/aI167:1/ I167:7/produceI167:1/ I167:2/toI167:1/ I167:3/runI167:1/ I167:4/(andI167:1/ I167:3/getI167:1/ I167:1/;I167:9/         I167:11/prog.b.w)\nI167:1/ I167:3/eg.I167:2/  I167:13/recursively??I167:1/ I167:4/thisI167:1/ I167:2/doI167:1/ I167:6/(mightI167:1/ I167:2/;;I167:9/         I167:9/version\nI167:1/ I165:3/andI165:1/ I165:6/sourceI165:1/ M162:6/savingM160:8/compile,I159:6/shouldI159:1/ I159:2/weI159:1/ I159:9/otherwiseI159:1/ I159:2/;;I159:9/         I159:17/fulltarget)))\n\nI159:1/ I159:12/\"/view/_/\"I159:1/ I159:7/(stringI159:1/ I159:9/(redirectI159:17/                 I159:10/revision\nI159:1/ I159:4/gotoI159:1/ I159:3/XXXI159:1/ I159:2/;;I159:17/                 I159:3/'\nI159:1/ I159:4/dat)I159:1/ I159:10/fulltargetI159:1/ I159:7/(insertI159:1/ I159:2/'_I159:1/ I159:5/'(letI159:11/           I159:7/save.\nI159:1/ I159:4/justI159:1/ I159:2/;;I159:11/           I159:6/case\nI159:1/ M156:2/inM154:5/name.M152:6/entireM150:3/theI149:5/holdsI149:1/ I149:3/extI149:1/ I149:4/thenI149:1/ I149:1/.I149:1/ I149:2/noI149:1/ I149:3/wasI149:1/ I149:5/thereI149:1/ I149:2/ifI149:1/ I149:2/;;I149:11/           I149:7/\"\")\nI149:1/ I149:4/baseI149:1/ I149:3/(eqI149:1/ I149:3/(ifI149:7/       I149:5/'\n\nI149:1/ I149:13/form.contentsI149:1/ I149:4/'datI149:1/ I149:4/(letI149:7/       I149:3/'\nI149:1/ I149:10/base_ext))I149:1/ I149:4/(cdrI149:1/ I149:4/(carI149:1/ I149:4/'extI149:1/ I149:4/(letI149:7/       I149:3/'\nI149:1/ I149:9/base_ext)I149:1/ I149:4/(carI149:1/ I149:5/'baseI149:1/ I149:4/(letI149:7/       I149:3/'\nI149:1/ I149:3/1))I149:1/ I149:11/fulltarget)I149:1/ I149:5/(sizeI149:1/ I149:2/(-I149:1/ I149:10/fulltargetI149:1/ I149:5/\".\"I149:1/ I149:6/rtokenI149:1/ I149:7/(rtokenI149:1/ I149:9/'base_extI149:1/ I149:5/'(letI149:6/      I149:12/extension.\nI149:1/ I149:3/theI149:1/ I149:2/onI149:1/ I149:5/basedI149:1/ I149:8/languageI149:1/ I149:3/theI149:1/ I149:3/outI149:1/ I149:6/figureI149:1/ I149:1/;I149:7/       I149:2/\nI149:1/ I149:10/compile...I149:1/ I149:2/toI149:1/ I149:4/needI149:1/ I149:5/mightI149:1/ I149:1/;I149:7/       I149:11/\"save\")\nI149:1/ I149:6/actionI149:1/ I149:3/(eqI149:1/ I149:4/'(ifI149:4/    I149:34/value=\\\"save\\\"></form>\"))\n\nI149:1/ I149:11/type=submitI149:1/ I149:8/\"<inputI149:15/               I149:20/\"</textarea>\\n\"\nI149:15/               I149:10/data)\")\nI149:1/ I149:12/'\"(internalI149:19/                   I149:12/symbol)\")\nI149:1/ I149:6/\"(wasI149:1/ I149:3/'(_I149:19/                   I149:8/\")\")\nI149:1/ I149:11/oldcontentsI149:1/ I149:2/\"I149:1/ I149:3/intI149:1/ I149:6/\"(wasI149:1/ I149:8/'(stringI149:19/                   I149:14/oldcontents)\nI149:1/ I149:12/'(htmlescapeI149:19/                   I149:10/data)\")\nI149:1/ I149:6/quotedI149:1/ I149:6/\"(wasI149:1/ I149:3/'(_I149:19/                   I149:10/data)\")\nI149:1/ I149:4/listI149:1/ I149:6/\"(wasI149:1/ I149:1/_I149:1/ I149:3/'(_I149:19/                   I149:7/'\"\"\nI149:19/                   I149:13/oldcontents\nI149:1/ I149:6/(xcaseI149:15/               I149:26/name=\\\"contents\\\">\"\nI149:1/ I149:8/cols=120I149:1/ I149:7/rows=35I149:1/ I149:16/\"\\\"><textareaI149:1/ I149:10/fulltargetI149:1/ I149:19/action=\\\"/save/\"I149:1/ I149:19/method=\\\"post\\\"I149:1/ I149:7/\"<formI149:15/               I149:16/deleted.</b>\"\nI149:1/ I149:2/beI149:1/ I149:4/willI149:1/ I149:2/ItI149:1/ I149:11/permission.I149:1/ I149:7/withoutI149:1/ I149:8/websitesI149:1/ I149:5/otherI149:1/ I149:4/fromI149:1/ I149:4/textI149:1/ I149:4/copyI149:1/ I149:3/notI149:1/ I149:12/\"<br/><b>DoI149:15/               I149:6/\"))\nI149:1/ I149:3/...I149:1/ I149:2/\"I149:1/ I149:10/fulltargetI149:1/ I149:2/\"I149:1/ I149:4/pageI149:1/ I149:3/newI149:1/ I149:10/\"creatingI149:1/ I149:8/'(stringI149:19/                   I149:5/\")\nI149:1/ I149:3/...I149:1/ I149:2/\"I149:1/ I149:10/fulltargetI149:1/ I149:2/\"I149:1/ I149:9/\"editingI149:1/ I149:8/'(stringI149:19/                   I149:13/oldcontents\nI149:1/ I149:3/(ifI149:15/               I149:9/\"<p>\"\nI149:1/ I149:11/fulltarget)I149:1/ I149:5/(tabsI149:16/                I149:9/stdpage\nI149:1/ I149:9/stdheaderI149:1/ I149:7/(stringI149:8/        I149:3/'\nI149:1/ I149:5/nil))I149:1/ I149:3/'(_I149:1/ I149:11/fulltarget)I149:1/ I149:6/'(headI149:1/ I149:7/(handleI149:1/ I149:12/'oldcontentsI149:1/ I149:5/'(letI149:6/      I149:10/textarea\nI149:1/ I149:3/theI149:1/ I149:2/inI149:1/ I149:2/itI149:1/ I149:3/putI149:1/ I149:3/andI149:1/ I149:2/;;I149:6/      I149:6/page\nI149:1/ I149:4/thisI149:1/ I149:3/forI149:1/ M146:6/sourceM144:3/theM142:5/fetchI141:2/toI141:1/ I141:4/needI141:1/ I141:2/;;I141:6/      I141:11/\"edit\")\nI141:1/ I141:6/actionI141:1/ I141:3/(eqI141:1/ I141:3/(ifI141:2/  I141:5/'\n\nI141:1/ I141:13/\"</div>\")))I141:27/                           I141:4/\"\nI141:1/ I141:21/\"\\\">run</a></span>I141:1/ I141:4/pageI141:1/ I141:16/href=\\\"/run/\"I141:1/ I141:20/class=\\\"tab\\\"><aI141:1/ I141:7/\"<spanI141:27/                           I141:4/\"\nI141:1/ I141:25/\"\\\">history</a></span>I141:1/ I141:4/pageI141:1/ I141:20/href=\\\"/history/\"I141:1/ I141:20/class=\\\"tab\\\"><aI141:1/ I141:7/\"<spanI141:27/                           I141:4/\"\nI141:1/ I141:22/\"\\\">edit</a></span>I141:1/ I141:4/pageI141:1/ I141:17/href=\\\"/edit/\"I141:1/ I141:20/class=\\\"tab\\\"><aI141:1/ I141:7/\"<spanI141:27/                           I141:4/\"\nI141:1/ I141:22/\"\\\">view</a></span>I141:1/ I141:4/pageI141:1/ I141:19/href=\\\"/view/_/\"I141:1/ I141:20/class=\\\"tab\\\"><aI141:1/ I141:7/\"<spanI141:27/                           I141:23/class=\\\"tabs\\\">\"\nI141:1/ I141:6/\"<divI141:1/ I141:7/(stringI141:19/                   I141:6/tabs\nI141:1/ I141:4/makeI141:1/ I141:3/XXXI141:1/ I141:1/;I141:19/                   I141:3/'\nI141:1/ I141:5/args)I141:1/ I141:4/(carI141:1/ I141:5/'pageI141:1/ I141:5/'(letI141:13/             I141:7/'args\nI141:1/ I141:7/(lambdaI141:1/ I141:5/'tabsI141:1/ I141:6/\n(letI141:2/  I141:3/'\nI141:1/ I141:15/action_target))I141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:11/'fulltargetI141:1/ I141:7/'\n(letI141:1/ I141:14/action_target)I141:1/ I141:4/(carI141:1/ I141:7/'actionI141:1/ I141:7/'\n(letI141:1/ I141:2/0)I141:1/ I141:3/urlI141:1/ I141:5/\"/\"I141:1/ I141:5/tokenI141:1/ I141:6/(tokenI141:1/ I141:14/'action_targetI141:1/ I141:7/'\n(letI141:1/ I141:4/0)))I141:1/ I141:11/request.urlI141:1/ I141:5/\"/\"I141:1/ I141:5/tokenI141:1/ I141:6/(tokenI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:4/'urlI141:1/ I141:11/char)\n(letI141:1/ I141:1//I141:1/ I141:8/startingI141:1/ I141:3/theI141:1/ I141:3/offI141:1/ I141:5/(tossI141:1/ I141:1/;I141:2/  I141:5/URL\nI141:1/ I141:3/theI141:1/ I141:2/onI141:1/ I141:5/basedI141:1/ I141:5/doingI141:1/ I141:5/we'reI141:1/ I141:4/whatI141:1/ I141:3/outI141:1/ I141:6/figureI141:1/ I141:1/;I141:2/  I141:5/'\n\nI141:1/ I141:7/0))))))I141:1/ I141:4/hrecI141:1/ I141:5/(hrecI141:1/ I141:6/stringI141:1/ I141:5/(consI141:1/ I141:6/'(evalI141:15/               I141:11/1))))))))\nI141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:4/selfI141:1/ I141:5/(selfI141:46/                                              I141:8/'ch)))\nI141:54/                                                      I141:12/'\"&amp;\"\nI141:56/                                                        I141:8/\"&\")\nI141:1/ I141:2/chI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:51/                                                   I141:11/'\"&gt;\"\nI141:53/                                                     I141:8/\">\")\nI141:1/ I141:2/chI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:48/                                                I141:11/'\"&lt;\"\nI141:50/                                                  I141:8/\"<\")\nI141:1/ I141:2/chI141:1/ I141:3/(eqI141:1/ I141:3/(ifI141:46/                                              I141:8/'(cons\nI141:44/                                            I141:4/n)\nI141:1/ I141:1/sI141:1/ I141:4/(subI141:1/ I141:3/'chI141:1/ I141:5/'(letI141:38/                                      I141:6/'nil\nI141:40/                                        I141:5/s))\nI141:1/ I141:5/(sizeI141:1/ I141:1/nI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:35/                                   I141:8/args))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'nI141:1/ I141:5/'(letI141:29/                             I141:7/args)\nI141:1/ I141:4/(carI141:1/ I141:5/'selfI141:1/ I141:5/'(letI141:23/                       I141:7/'args\nI141:1/ I141:7/(lambdaI141:1/ I141:5/'hrecI141:1/ I141:5/'(letI141:9/         I141:8/hargs)\nI141:1/ I141:4/(carI141:1/ I141:2/'sI141:1/ I141:5/'(letI141:4/    I141:8/'hargs\nI141:1/ I141:7/(lambdaI141:2/  I141:6/PERF\nI141:1/ I141:1/;I141:2/  I141:13/'htmlescape\nI141:1/ I141:9/'\n\n(letI141:1/ I141:7/)))))))I141:37/                                     I141:6/1)))\nI141:1/ I141:1/nI141:1/ I141:2/(-I141:1/ I141:1/sI141:1/ I141:3/sepI141:1/ I141:4/selfI141:1/ I141:6/'(selfI141:42/                                          I141:7/1))))\nI141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:2/s)I141:1/ I141:5/(sizeI141:1/ I141:2/(-I141:1/ I141:2/1)I141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:1/sI141:1/ I141:7/(substrI141:1/ I141:2/n)I141:1/ I141:1/0I141:1/ I141:1/sI141:1/ I141:7/(substrI141:1/ I141:6/'(listI141:42/                                          I141:6/sep)\nI141:1/ I141:2/chI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:37/                                     I141:4/n)\nI141:1/ I141:1/sI141:1/ I141:4/(subI141:1/ I141:3/'chI141:1/ I141:5/'(letI141:31/                               I141:4/s)\nI141:1/ I141:4/\"\"I141:1/ I141:6/'(listI141:1/ I141:3/1))I141:1/ I141:1/0I141:1/ I141:2/(-I141:1/ I141:1/nI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:28/                            I141:10/args))))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'nI141:1/ I141:5/'(letI141:22/                      I141:9/args)))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'sI141:1/ I141:5/'(letI141:16/                I141:8/args))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:4/'sepI141:1/ I141:5/'(letI141:10/          I141:7/args)\nI141:1/ I141:4/(carI141:1/ I141:5/'selfI141:1/ I141:5/'(letI141:4/    I141:7/'args\nI141:1/ I141:7/(lambdaI141:2/  I141:9/'rtoken\nI141:1/ I141:6/\n(letI141:21/                     I141:8/instanceI141:1/ I141:4/lastI141:1/ I141:3/butI141:1/ I141:5/same,I141:1/ I141:6/'\n\n;I141:1/ I141:7/)))))))I141:37/                                     I141:6/1)))\nI141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:1/sI141:1/ I141:3/sepI141:1/ I141:4/selfI141:1/ I141:6/'(selfI141:42/                                          I141:7/1))))\nI141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:2/s)I141:1/ I141:5/(sizeI141:1/ I141:2/(-I141:1/ I141:2/1)I141:1/ I141:1/nI141:1/ I141:2/(+I141:1/ I141:1/sI141:1/ I141:7/(substrI141:1/ I141:2/n)I141:1/ I141:1/0I141:1/ I141:1/sI141:1/ I141:7/(substrI141:1/ I141:6/'(listI141:42/                                          I141:6/sep)\nI141:1/ I141:2/chI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:37/                                     I141:4/n)\nI141:1/ I141:1/sI141:1/ I141:4/(subI141:1/ I141:3/'chI141:1/ I141:5/'(letI141:31/                               I141:7/\"\")\nI141:1/ I141:1/sI141:1/ I141:6/'(listI141:1/ I141:3/s))I141:1/ I141:5/(sizeI141:1/ I141:1/nI141:1/ I141:3/(eqI141:1/ I141:4/'(ifI141:28/                            I141:10/args))))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'nI141:1/ I141:5/'(letI141:22/                      I141:9/args)))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'sI141:1/ I141:5/'(letI141:16/                I141:8/args))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:4/'sepI141:1/ I141:5/'(letI141:10/          I141:7/args)\nI141:1/ I141:4/(carI141:1/ I141:5/'selfI141:1/ I141:5/'(letI141:4/    I141:7/'args\nI141:1/ I141:7/(lambdaI141:2/  I141:8/'token\nI141:1/ I141:11/given\n(letI141:1/ I141:4/charI141:1/ I141:3/theI141:1/ I141:2/ofI141:1/ I141:8/instanceI141:1/ I141:5/firstI141:1/ I141:3/theI141:1/ I141:2/toI141:1/ I141:2/upI141:1/ I141:4/chopI141:1/ I141:6/'\n\n;I141:1/ I141:9/'nil)))))I141:25/                         I141:6/l)))\nI141:1/ I141:4/(cdrI141:1/ I141:1/fI141:1/ I141:4/selfI141:1/ I141:5/(selfI141:1/ I141:3/l))I141:1/ I141:4/(carI141:1/ I141:2/(fI141:1/ I141:6/'(consI141:27/                           I141:3/l\nI141:1/ I141:4/'(ifI141:22/                      I141:9/args)))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'lI141:1/ I141:5/'(letI141:16/                I141:8/args))\nI141:1/ I141:4/(cdrI141:1/ I141:4/(carI141:1/ I141:2/'fI141:1/ I141:5/'(letI141:10/          I141:7/args)\nI141:1/ I141:4/(carI141:1/ I141:5/'selfI141:1/ I141:5/'(letI141:4/    I141:7/'args\nI141:1/ I141:7/(lambdaI141:2/  I141:2/\nI141:1/ I141:4/'mapI141:1/ I141:11/'\n\n\n(letI141:1/ I141:18/\"\\r\\n\\r\\n\"))I141:1/ I141:7/target)I141:1/ I141:4/(carI141:1/ I141:2/\"I141:1/ I141:11/\"Location:I141:1/ I141:8/'(stringI141:1/ I141:7/'targetI141:1/ I141:7/(lambdaI141:1/ I141:9/'redirectI141:1/ I141:7/'\n(letI141:1/ I141:42/title=\\\"polybook\\\"/></head><body>\\n\"I141:1/ I141:32/href=\\\"/raw/_/polybook.css\\\"I141:1/ I141:21/type=\\\"text/css\\\"I141:1/ I141:14/rel=stylesheetI141:1/ I141:19/\"<html><head><linkI141:1/ I141:8/'stdpageI141:1/ I141:7/'\n(letI141:1/ I141:27/charset=utf-8\\r\\n\\r\\n\"I141:1/ I141:10/text/html;I141:1/ I141:15/\"Content-Type:I141:1/ I141:10/'stdheaderI141:1/ I141:7/'\n(letI141:1/ X
!3=M708:10/char\n(letX

polybook.css 5 480/"       .tabs { border-bottom : 1px solid #000000 ; }\n       .tab { font : 11px Verdana,Arial,Helvetica ; padding : 2px 4px 4px 2px ; margin-right : 4px ; border-top : 1px solid #000000 ; border-left : 1px solid #000000 ; border-right : 1px solid #000000 ; }\n\n       A:link { color: #4444DD }\n       A:visited { color: #9999FF }\n       A:active { color: #DDDD44 }\n\n       BODY { font : 12px Verdana,Arial,Helvetica ; }\n       P { font : 12px Verdana,Arial,Helvetica ; }\n"

